!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}((function(e){function t(t,n){this.element=t,this.$element=e(this.element),this.doc=e(document),this.win=e(window),this.settings=e.extend({},i,n),"object"==typeof this.$element.data("tipso")&&e.extend(this.settings,this.$element.data("tipso"));for(var o=Object.keys(this.$element.data()),r={},c=0;c<o.length;c++){var l=o[c].replace(a,"");if(""!==l)for(var u in r[l=l.charAt(0).toLowerCase()+l.slice(1)]=this.$element.data(o[c]),this.settings)u.toLowerCase()==l&&(this.settings[u]=r[l])}this._defaults=i,this._name=a,this._title=this.$element.attr("title"),this.mode="hide",this.ieFade=!s,this.settings.preferedPosition=this.settings.position,this.init()}function n(t){var n=t.clone();n.css("visibility","hidden"),e("body").append(n);var o=n.outerHeight(),r=n.outerWidth();return n.remove(),{width:r,height:o}}function o(e){e.removeClass("top_right_corner bottom_right_corner top_left_corner bottom_left_corner"),e.find(".tipso_title").removeClass("top_right_corner bottom_right_corner top_left_corner bottom_left_corner")}function r(t){var a,i,s,c=t.tooltip(),l=t.$element,u=t,d=e(window),h=10,p=u.settings.background,f=u.titleContent();switch(void 0!==f&&""!==f&&(p=u.settings.titleBackground),l.parent().outerWidth()>d.outerWidth()&&(d=l.parent()),u.settings.position){case"top-right":i=l.offset().left+l.outerWidth(),a=l.offset().top-n(c).height-h,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),a<d.scrollTop()?(a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({"border-bottom-color":p,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("bottom_right_corner"),c.find(".tipso_title").addClass("bottom_right_corner"),c.find(".tipso_arrow").css({"border-left-color":p}),c.removeClass("top-right top bottom left right"),c.addClass("bottom")):(c.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent ","border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("top_right_corner"),c.find(".tipso_arrow").css({"border-left-color":u.settings.background}),c.removeClass("top bottom left right"),c.addClass("top"));break;case"top-left":i=l.offset().left-n(c).width,a=l.offset().top-n(c).height-h,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),a<d.scrollTop()?(a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({"border-bottom-color":p,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("bottom_left_corner"),c.find(".tipso_title").addClass("bottom_left_corner"),c.find(".tipso_arrow").css({"border-right-color":p}),c.removeClass("top-right top bottom left right"),c.addClass("bottom")):(c.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent ","border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("top_left_corner"),c.find(".tipso_arrow").css({"border-right-color":u.settings.background}),c.removeClass("top bottom left right"),c.addClass("top"));break;case"bottom-right":i=l.offset().left+l.outerWidth(),a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),a+n(c).height>d.scrollTop()+d.outerHeight()?(a=l.offset().top-n(c).height-h,c.find(".tipso_arrow").css({"border-bottom-color":"transparent","border-top-color":u.settings.background,"border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("top_right_corner"),c.find(".tipso_title").addClass("top_left_corner"),c.find(".tipso_arrow").css({"border-left-color":u.settings.background}),c.removeClass("top-right top bottom left right"),c.addClass("top")):(c.find(".tipso_arrow").css({"border-top-color":"transparent","border-bottom-color":p,"border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("bottom_right_corner"),c.find(".tipso_title").addClass("bottom_right_corner"),c.find(".tipso_arrow").css({"border-left-color":p}),c.removeClass("top bottom left right"),c.addClass("bottom"));break;case"bottom-left":i=l.offset().left-n(c).width,a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),a+n(c).height>d.scrollTop()+d.outerHeight()?(a=l.offset().top-n(c).height-h,c.find(".tipso_arrow").css({"border-bottom-color":"transparent","border-top-color":u.settings.background,"border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("top_left_corner"),c.find(".tipso_title").addClass("top_left_corner"),c.find(".tipso_arrow").css({"border-right-color":u.settings.background}),c.removeClass("top-right top bottom left right"),c.addClass("top")):(c.find(".tipso_arrow").css({"border-top-color":"transparent","border-bottom-color":p,"border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.addClass("bottom_left_corner"),c.find(".tipso_title").addClass("bottom_left_corner"),c.find(".tipso_arrow").css({"border-right-color":p}),c.removeClass("top bottom left right"),c.addClass("bottom"));break;case"top":i=l.offset().left+l.outerWidth()/2-n(c).width/2,a=l.offset().top-n(c).height-h,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),a<d.scrollTop()?(a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({"border-bottom-color":p,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass("bottom")):(c.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass("top"));break;case"bottom":i=l.offset().left+l.outerWidth()/2-n(c).width/2,a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),a+n(c).height>d.scrollTop()+d.outerHeight()?(a=l.offset().top-n(c).height-h,c.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass("top")):(c.find(".tipso_arrow").css({"border-bottom-color":p,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass(u.settings.position));break;case"left":i=l.offset().left-n(c).width-h,a=l.offset().top+l.outerHeight()/2-n(c).height/2,c.find(".tipso_arrow").css({marginTop:-u.settings.arrowWidth,marginLeft:""}),i<d.scrollLeft()?(i=l.offset().left+l.outerWidth()+h,c.find(".tipso_arrow").css({"border-right-color":u.settings.background,"border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass("right")):(c.find(".tipso_arrow").css({"border-left-color":u.settings.background,"border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass(u.settings.position));break;case"right":i=l.offset().left+l.outerWidth()+h,a=l.offset().top+l.outerHeight()/2-n(c).height/2,c.find(".tipso_arrow").css({marginTop:-u.settings.arrowWidth,marginLeft:""}),i+h+u.settings.width>d.scrollLeft()+d.outerWidth()?(i=l.offset().left-n(c).width-h,c.find(".tipso_arrow").css({"border-left-color":u.settings.background,"border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass("left")):(c.find(".tipso_arrow").css({"border-right-color":u.settings.background,"border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),c.removeClass("top bottom left right"),c.addClass(u.settings.position))}("top-right"===u.settings.position&&c.find(".tipso_arrow").css({"margin-left":-u.settings.width/2}),"top-left"===u.settings.position)&&c.find(".tipso_arrow").eq(0).css({"margin-left":u.settings.width/2-2*u.settings.arrowWidth});"bottom-right"===u.settings.position&&c.find(".tipso_arrow").eq(0).css({"margin-left":-u.settings.width/2,"margin-top":""});"bottom-left"===u.settings.position&&c.find(".tipso_arrow").eq(0).css({"margin-left":u.settings.width/2-2*u.settings.arrowWidth,"margin-top":""});i<d.scrollLeft()&&("bottom"===u.settings.position||"top"===u.settings.position)&&(c.find(".tipso_arrow").css({marginLeft:i-u.settings.arrowWidth}),i=0),i+u.settings.width>d.outerWidth()&&("bottom"===u.settings.position||"top"===u.settings.position)&&(s=d.outerWidth()-(i+u.settings.width),c.find(".tipso_arrow").css({marginLeft:-s-u.settings.arrowWidth,marginTop:""}),i+=s),i<d.scrollLeft()&&("left"===u.settings.position||"right"===u.settings.position||"top-right"===u.settings.position||"top-left"===u.settings.position||"bottom-right"===u.settings.position||"bottom-left"===u.settings.position)&&(i=l.offset().left+l.outerWidth()/2-n(c).width/2,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),(a=l.offset().top-n(c).height-h)<d.scrollTop()?(a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({"border-bottom-color":p,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),c.removeClass("top bottom left right"),o(c),c.addClass("bottom")):(c.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),c.removeClass("top bottom left right"),o(c),c.addClass("top")),i+u.settings.width>d.outerWidth()&&(s=d.outerWidth()-(i+u.settings.width),c.find(".tipso_arrow").css({marginLeft:-s-u.settings.arrowWidth,marginTop:""}),i+=s),i<d.scrollLeft()&&(c.find(".tipso_arrow").css({marginLeft:i-u.settings.arrowWidth}),i=0)),i+u.settings.width>d.outerWidth()&&("left"===u.settings.position||"right"===u.settings.position||"top-right"===u.settings.position||"top-left"===u.settings.position||"bottom-right"===u.settings.position||"bottom-right"===u.settings.position)&&(i=l.offset().left+l.outerWidth()/2-n(c).width/2,c.find(".tipso_arrow").css({marginLeft:-u.settings.arrowWidth,marginTop:""}),(a=l.offset().top-n(c).height-h)<d.scrollTop()?(a=l.offset().top+l.outerHeight()+h,c.find(".tipso_arrow").css({"border-bottom-color":p,"border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.removeClass("top bottom left right"),c.addClass("bottom")):(c.find(".tipso_arrow").css({"border-top-color":u.settings.background,"border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),o(c),c.removeClass("top bottom left right"),c.addClass("top")),i+u.settings.width>d.outerWidth()&&(s=d.outerWidth()-(i+u.settings.width),c.find(".tipso_arrow").css({marginLeft:-s-u.settings.arrowWidth,marginTop:""}),i+=s),i<d.scrollLeft()&&(c.find(".tipso_arrow").css({marginLeft:i-u.settings.arrowWidth}),i=0)),c.css({left:i+u.settings.offsetX,top:a+u.settings.offsetY}),a<d.scrollTop()&&("right"===u.settings.position||"left"===u.settings.position)&&(l.tipso("update","position","bottom"),r(u)),a+n(c).height>d.scrollTop()+d.outerHeight()&&("right"===u.settings.position||"left"===u.settings.position)&&(l.tipso("update","position","top"),r(u))}var a="tipso",i={speed:400,background:"#55b555",titleBackground:"#333333",color:"#ffffff",titleColor:"#ffffff",titleContent:"",showArrow:!0,position:"top",width:200,maxWidth:"",delay:200,hideDelay:0,animationIn:"",animationOut:"",offsetX:0,offsetY:0,arrowWidth:8,tooltipHover:!1,content:null,ajaxContentUrl:null,ajaxContentBuffer:0,contentElementId:null,useTitle:!1,templateEngineFunc:null,onBeforeShow:null,onShow:null,onHide:null};e.extend(t.prototype,{init:function(){var e=this,t=this.$element;if(this.doc,t.addClass("tipso_style").removeAttr("title"),e.settings.tooltipHover){var n=null,o=null;t.on("mouseover."+a,(function(){clearTimeout(n),clearTimeout(o),o=setTimeout((function(){e.show()}),150)})),t.on("mouseout."+a,(function(){clearTimeout(n),clearTimeout(o),n=setTimeout((function(){e.hide()}),200),e.tooltip().on("mouseover."+a,(function(){e.mode="tooltipHover"})).on("mouseout."+a,(function(){e.mode="show",clearTimeout(n),n=setTimeout((function(){e.hide()}),200)}))}))}else t.on("mouseover."+a,(function(){e.show()})),t.on("mouseout."+a,(function(){e.hide()}));e.settings.ajaxContentUrl&&(e.ajaxContent=null)},tooltip:function(){return this.tipso_bubble||(this.tipso_bubble=e('<div class="tipso_bubble"><div class="tipso_title"></div><div class="tipso_content"></div><div class="tipso_arrow"></div></div>')),this.tipso_bubble},show:function(){var t=this.tooltip(),n=this,o=this.win;!1===n.settings.showArrow?t.find(".tipso_arrow").hide():t.find(".tipso_arrow").show(),"hide"===n.mode&&(e.isFunction(n.settings.onBeforeShow)&&n.settings.onBeforeShow(n.$element,n.element,n),n.settings.size&&t.addClass(n.settings.size),n.settings.width?t.css({background:n.settings.background,color:n.settings.color,width:n.settings.width}).hide():n.settings.maxWidth?t.css({background:n.settings.background,color:n.settings.color,maxWidth:n.settings.maxWidth}).hide():t.css({background:n.settings.background,color:n.settings.color,width:200}).hide(),t.find(".tipso_title").css({background:n.settings.titleBackground,color:n.settings.titleColor}),t.find(".tipso_content").html(n.content()),t.find(".tipso_title").html(n.titleContent()),r(n),o.on("resize."+a,(function(){n.settings.position=n.settings.preferedPosition,r(n)})),window.clearTimeout(n.timeout),n.timeout=null,n.timeout=window.setTimeout((function(){n.ieFade||""===n.settings.animationIn||""===n.settings.animationOut?t.appendTo("body").stop(!0,!0).fadeIn(n.settings.speed,(function(){n.mode="show",e.isFunction(n.settings.onShow)&&n.settings.onShow(n.$element,n.element,n)})):t.remove().appendTo("body").stop(!0,!0).removeClass("animated "+n.settings.animationOut).addClass("noAnimation").removeClass("noAnimation").addClass("animated "+n.settings.animationIn).fadeIn(n.settings.speed,(function(){e(this).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){e(this).removeClass("animated "+n.settings.animationIn)})),n.mode="show",e.isFunction(n.settings.onShow)&&n.settings.onShow(n.$element,n.element,n),o.off("resize."+a,null,"tipsoResizeHandler")}))}),n.settings.delay))},hide:function(t){var n=this,o=this.win,r=this.tooltip(),i=n.settings.hideDelay;t&&(i=0,n.mode="show"),window.clearTimeout(n.timeout),n.timeout=null,n.timeout=window.setTimeout((function(){"tooltipHover"!==n.mode&&(n.ieFade||""===n.settings.animationIn||""===n.settings.animationOut?r.stop(!0,!0).fadeOut(n.settings.speed,(function(){e(this).remove(),e.isFunction(n.settings.onHide)&&"show"===n.mode&&n.settings.onHide(n.$element,n.element,n),n.mode="hide",o.off("resize."+a,null,"tipsoResizeHandler")})):r.stop(!0,!0).removeClass("animated "+n.settings.animationIn).addClass("noAnimation").removeClass("noAnimation").addClass("animated "+n.settings.animationOut).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){e(this).removeClass("animated "+n.settings.animationOut).remove(),e.isFunction(n.settings.onHide)&&"show"===n.mode&&n.settings.onHide(n.$element,n.element,n),n.mode="hide",o.off("resize."+a,null,"tipsoResizeHandler")})))}),i)},close:function(){this.hide(!0)},destroy:function(){var e=this.$element,t=this.win;this.doc,e.off("."+a),t.off("resize."+a,null,"tipsoResizeHandler"),e.removeData(a),e.removeClass("tipso_style").attr("title",this._title)},titleContent:function(){var e=this.$element;return this.settings.titleContent?this.settings.titleContent:e.data("tipso-title")},content:function(){var t,n=this.$element,o=this,r=this._title;return o.settings.ajaxContentUrl?o._ajaxContent?t=o._ajaxContent:(o._ajaxContent=t=e.ajax({type:"GET",url:o.settings.ajaxContentUrl,async:!1}).responseText,o.settings.ajaxContentBuffer>0?setTimeout((function(){o._ajaxContent=null}),o.settings.ajaxContentBuffer):o._ajaxContent=null):o.settings.contentElementId?t=e("#"+o.settings.contentElementId).text():o.settings.content?t=o.settings.content:!0===o.settings.useTitle?t=r:"string"==typeof n.data("tipso")&&(t=n.data("tipso")),null!==o.settings.templateEngineFunc&&(t=o.settings.templateEngineFunc(t)),t},update:function(e,t){return t?void(this.settings[e]=t):this.settings[e]}});var s=function(){var e=document.createElement("p").style,t=["ms","O","Moz","Webkit"];if(""===e.transition)return!0;for(;t.length;)if(t.pop()+"Transition"in e)return!0;return!1}();e[a]=e.fn[a]=function(n){var o,r=arguments;return void 0===n||"object"==typeof n?(this instanceof e||e.extend(i,n),this.each((function(){e.data(this,"plugin_"+a)||e.data(this,"plugin_"+a,new t(this,n))}))):"string"==typeof n&&"_"!==n[0]&&"init"!==n?(this.each((function(){var i=e.data(this,"plugin_"+a);i||(i=e.data(this,"plugin_"+a,new t(this,n))),i instanceof t&&"function"==typeof i[n]&&(o=i[n].apply(i,Array.prototype.slice.call(r,1))),"destroy"===n&&e.data(this,"plugin_"+a,null)})),void 0!==o?o:this):void 0}})),function e(t,n,o){function r(i,s){if(!n[i]){if(!t[i]){var c="function"==typeof require&&require;if(!s&&c)return c(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var l=n[i]={exports:{}};t[i][0].call(l.exports,(function(e){var n=t[i][1][e];return r(n||e)}),l,l.exports,e,t,n,o)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(e,t,n){"use strict";var o=e("./src/core/Chart"),r=e("./src/panel/TimePanel"),a=e("./src/panel/TimeValuePanel"),i=e("./src/panel/TimeLabelsPanel"),s=e("./src/layer/CandleLayer"),c=e("./src/layer/OHLCLayer"),l=e("./src/layer/ValueGridLayer"),u=e("./src/layer/TimeGridLayer"),d=e("./src/layer/indicator/VolumeLayer"),h=e("./src/layer/indicator/SimpleMovingAverageLayer"),p=e("./src/layer/indicator/SimpleExtLayer"),f=e("./src/layer/indicator/ExponentialMovingAverageLayer"),m=e("./src/layer/indicator/VolumeProfileLayer"),g=e("./src/layer/indicator/RSILayer"),y=e("./src/layer/indicator/BollingerBandsLayer"),_={core:{Chart:o},panel:{TimePanel:r,TimeValuePanel:a,TimeLabelsPanel:i},layer:{CandleLayer:s,OHLCLayer:c,ValueGridLayer:l,TimeGridLayer:u,indicator:{VolumeLayer:d,SimpleMovingAverageLayer:h,SimpleExtLayer:p,ExponentialMovingAverageLayer:f,VolumeProfileLayer:m,RSILayer:g,StochasticLayer:e("./src/layer/indicator/StochasticLayer"),BollingerBandsLayer:y}}};t.exports=_,window.DojiChart=_},{"./src/core/Chart":7,"./src/layer/CandleLayer":24,"./src/layer/OHLCLayer":26,"./src/layer/TimeGridLayer":27,"./src/layer/ValueGridLayer":29,"./src/layer/indicator/BollingerBandsLayer":30,"./src/layer/indicator/ExponentialMovingAverageLayer":31,"./src/layer/indicator/RSILayer":32,"./src/layer/indicator/SimpleExtLayer":33,"./src/layer/indicator/SimpleMovingAverageLayer":34,"./src/layer/indicator/StochasticLayer":35,"./src/layer/indicator/VolumeLayer":36,"./src/layer/indicator/VolumeProfileLayer":37,"./src/panel/TimeLabelsPanel":39,"./src/panel/TimePanel":40,"./src/panel/TimeValuePanel":41}],2:[function(e,t,n){function o(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function a(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}t.exports=o,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._maxListeners=void 0,o.defaultMaxListeners=10,o.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},o.prototype.emit=function(e){var t,n,o,s,c,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;throw TypeError('Uncaught, unspecified "error" event.')}if(i(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(o=arguments.length,s=new Array(o-1),c=1;c<o;c++)s[c-1]=arguments[c];n.apply(this,s)}else if(a(n)){for(o=arguments.length,s=new Array(o-1),c=1;c<o;c++)s[c-1]=arguments[c];for(o=(l=n.slice()).length,c=0;c<o;c++)l[c].apply(this,s)}return!0},o.prototype.addListener=function(e,t){var n;if(!r(t))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned)&&((n=i(this._maxListeners)?o.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()));return this},o.prototype.on=o.prototype.addListener,o.prototype.once=function(e,t){function n(){this.removeListener(e,n),o||(o=!0,t.apply(this,arguments))}if(!r(t))throw TypeError("listener must be a function");var o=!1;return n.listener=t,this.on(e,n),this},o.prototype.removeListener=function(e,t){var n,o,i,s;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(i=(n=this._events[e]).length,o=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(n)){for(s=i;s-- >0;)if(n[s]===t||n[s].listener&&n[s].listener===t){o=s;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},o.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},o.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},o.listenerCount=function(e,t){return e._events&&e._events[t]?r(e._events[t])?1:e._events[t].length:0}},{}],3:[function(e,t,n){(function(e,t){function o(e,t){return e-t}function r(e){if(this._config={store_data:!0},e)for(var t in a)e.hasOwnProperty(t)&&a[t](this,e[t]);return this.reset(),this}var a={bucket_precision:function(e,t){if("number"!=typeof t||t<=0)throw new Error("bucket_precision must be a positive number");e._config.bucket_precision=t,e.buckets=[]},buckets:function(e,t){if(!Array.isArray(t)||0==t.length)throw new Error("buckets must be an array of bucket limits");e._config.buckets=t,e.buckets=[]},bucket_extension_interval:function(e,t){if(void 0!==t){if("number"!=typeof t||t<=0)throw new Error("bucket_extension_interval must be a positive number");e._config.bucket_extension_interval=t}},store_data:function(e,t){if("boolean"!=typeof t)throw new Error("store_data must be a true or false");e._config.store_data=t},sampling:function(e,t){if("boolean"!=typeof t)throw new Error("sampling must be a true or false");e._config.sampling=t}};if(r.prototype={reset:function(){return this._config.store_data&&(this.data=[]),this.length=0,this.sum=0,this.sum_of_squares=0,this.sum_of_logs=0,this.sum_of_square_of_logs=0,this.zeroes=0,this.max=this.min=null,this._reset_cache(),this},_reset_cache:function(){this._stddev=null,this._config.store_data&&(this._data_sorted=null)},_find_bucket:function(e){var t,n,o=0;if(this._config.buckets)for(n=this._config.buckets.length,this._config.bucket_extension_interval&&e>=this._config.buckets[n-1]&&(t=e-this._config.buckets[n-1],o=parseInt(t/this._config.bucket_extension_interval)+n,void 0===this._config.buckets[o]&&(this._config.buckets[o]=this._config.buckets[n-1]+(parseInt(t/this._config.bucket_extension_interval)+1)*this._config.bucket_extension_interval),void 0===this._config.buckets[o-1]&&(this._config.buckets[o-1]=this._config.buckets[n-1]+parseInt(t/this._config.bucket_extension_interval)*this._config.bucket_extension_interval));o<n&&!(e<this._config.buckets[o]);o++);else this._config.bucket_precision&&(o=Math.floor(e/this._config.bucket_precision));return o},_add_cache:function(e){var t,n=[1];if(e instanceof Array&&(e=(n=e).shift()),this.sum+=e*n[0],this.sum_of_squares+=e*e*n[0],0===e?this.zeroes++:(this.sum_of_logs+=Math.log(e)*n[0],this.sum_of_square_of_logs+=Math.pow(Math.log(e),2)*n[0]),this.length+=n[0],n[0]>0&&((null===this.max||this.max<e)&&(this.max=e),(null===this.min||this.min>e)&&(this.min=e)),this.buckets){var o=this._find_bucket(e);for(this.buckets[o]||(this.buckets[o]=[0]),this.buckets[o][0]+=n.shift(),t=0;t<n.length;t++)this.buckets[o][t+1]=(0|this.buckets[o][t+1])+(0|n[t])}this._reset_cache()},_del_cache:function(e){var t=[1];if(e instanceof Array&&(e=(t=e).shift()),this.sum-=e*t[0],this.sum_of_squares-=e*e*t[0],0===e?this.zeroes--:(this.sum_of_logs-=Math.log(e)*t[0],this.sum_of_square_of_logs-=Math.pow(Math.log(e),2)*t[0]),this.length-=t[0],this._config.store_data)if(0===this.length&&(this.max=this.min=null),1===this.length)this.max=this.min=this.data[0];else if(t[0]>0&&(this.max===e||this.min===e)){var n;if((n=this.length-1)>=0)for(this.max=this.min=this.data[n--];n-- >=0;)this.max<this.data[n]&&(this.max=this.data[n]),this.min>this.data[n]&&(this.min=this.data[n])}if(this.buckets){var o=this._find_bucket(e);if(this.buckets[o])if(this.buckets[o][0]-=t.shift(),0===this.buckets[o][0])delete this.buckets[o];else for(n=0;n<t.length;n++)this.buckets[o][n+1]=(0|this.buckets[o][n+1])-(0|t[n])}this._reset_cache()},push:function(){var e,t,n=Array.prototype.slice.call(arguments,0);for(n.length&&n[0]instanceof Array&&(n=n[0]),e=0;e<n.length;e++)t=n[e],this._config.store_data&&this.data.push(t),this._add_cache(t);return this},push_tuple:function(e){if(!this.buckets)throw new Error("push_tuple is only valid when using buckets");this._add_cache(e)},pop:function(){if(0!==this.length&&!1!==this._config.store_data){var e=this.data.pop();return this._del_cache(e),e}},remove_tuple:function(e){if(!this.buckets)throw new Error("remove_tuple is only valid when using buckets");this._del_cache(e)},reset_tuples:function(e){var t,n,o,r=e.length;if(!this.buckets)throw new Error("reset_tuple is only valid when using buckets");for(t=0,n=this.buckets.length;t<n;t++)if(this.buckets[t]&&!(this.buckets[t].length<=1))for(o=0;o<r;o++)void 0!==e[o]&&(this.buckets[t][o]=e[o])},unshift:function(){var e,t,n=Array.prototype.slice.call(arguments,0);for(n.length&&n[0]instanceof Array&&(n=n[0]),e=n.length;e--;)t=n[e],this._config.store_data&&this.data.unshift(t),this._add_cache(t);return this},shift:function(){if(0!==this.length&&!1!==this._config.store_data){var e=this.data.shift();return this._del_cache(e),e}},amean:function(){return 0===this.length?NaN:this.sum/this.length},gmean:function(){return 0===this.length||this.zeroes>0?NaN:Math.exp(this.sum_of_logs/this.length)},stddev:function(){if(0===this.length)return NaN;var e=this.length;return this._config.sampling&&e--,null===this._stddev&&(this._stddev=Math.sqrt((this.length*this.sum_of_squares-this.sum*this.sum)/(this.length*e))),this._stddev},gstddev:function(){if(0===this.length)return NaN;if(this.zeroes>0)return NaN;var e=this.length;return this._config.sampling&&e--,Math.exp(Math.sqrt((this.length*this.sum_of_square_of_logs-this.sum_of_logs*this.sum_of_logs)/(this.length*e)))},moe:function(){return 0===this.length?NaN:1.96*this.stddev()/Math.sqrt(this.length)},range:function(){return 0===this.length?[NaN,NaN]:[this.min,this.max]},distribution:function(){if(0===this.length)return[];if(!this.buckets)throw new Error("bucket_precision or buckets not configured.");var e,t,n,o=[];if(this._config.buckets){for(t=this.min,n=Math.min(this.buckets.length,this._config.buckets.length),e=0;e<n&&(void 0===this._config.buckets[e]&&this._config.bucket_extension_interval&&(this._config.buckets[e]=this._config.buckets[e-1]+this._config.bucket_extension_interval),this.min>this._config.buckets[e]||(o[e]={bucket:(t+this._config.buckets[e])/2,range:[t,this._config.buckets[e]],count:this.buckets[e]?this.buckets[e][0]:0,tuple:this.buckets[e]?this.buckets[e].slice(1):[]},!(this.max<this._config.buckets[e])));t=this._config.buckets[e++]);e==n&&this.buckets[e]&&(o[e]={bucket:(t+this.max)/2,range:[t,this.max],count:this.buckets[e][0],tuple:this.buckets[e]?this.buckets[e].slice(1):[]})}else if(this._config.bucket_precision)for(e=Math.floor(this.min/this._config.bucket_precision),n=Math.floor(this.max/this._config.bucket_precision)+1,t=0;e<n&&e<this.buckets.length;e++,t++)this.buckets[e]&&(o[t]={bucket:(e+.5)*this._config.bucket_precision,range:[e*this._config.bucket_precision,(e+1)*this._config.bucket_precision],count:this.buckets[e][0],tuple:this.buckets[e]?this.buckets[e].slice(1):[]});return o},percentile:function(e){if(0===this.length||!this._config.store_data&&!this.buckets)return NaN;var t,n;if(0===(t=e<=0?0:25==e?[Math.floor(.25*(this.length-1)),Math.ceil(.25*(this.length-1))]:50==e?[Math.floor(.5*(this.length-1)),Math.ceil(.5*(this.length-1))]:75==e?[Math.floor(.75*(this.length-1)),Math.ceil(.75*(this.length-1))]:e>=100?this.length-1:Math.floor(this.length*e/100)))return this.min;if(t===this.length-1)return this.max;if(this._config.store_data)return null===this._data_sorted&&(this._data_sorted=this.data.slice(0).sort(o)),"number"==typeof t?this._data_sorted[t]:(this._data_sorted[t[0]]+this._data_sorted[t[1]])/2;for("number"!=typeof t&&(t=(t[0]+t[1])/2),this._config.buckets?n=0:this._config.bucket_precision&&(n=Math.floor(this.min/this._config.bucket_precision));n<this.buckets.length;n++)if(this.buckets[n]){if(t<=this.buckets[n][0])break;t-=this.buckets[n][0]}return this._get_nth_in_bucket(t,n)},_get_nth_in_bucket:function(e,t){var n=[];return this._config.buckets?(n[0]=t>0?this._config.buckets[t-1]:this.min,n[1]=t<this._config.buckets.length?this._config.buckets[t]:this.max):this._config.bucket_precision&&(n[0]=Math.max(t*this._config.bucket_precision,this.min),n[1]=Math.min((t+1)*this._config.bucket_precision,this.max)),n[0]+(n[1]-n[0])*e/this.buckets[t][0]},median:function(){return this.percentile(50)},iqr:function(){var e,t,n;return e=this.percentile(25),n=1.5*((t=this.percentile(75))-e),this.band_pass(e-n,t+n,!0)},band_pass:function(e,t,n,a){var i,s,c,l,u;if(a||(a=this._config),c=new r(a),0===this.length)return c;if(this._config.store_data)for(null===this._data_sorted&&(this._data_sorted=this.data.slice(0).sort(o)),i=0;i<this.length&&(this._data_sorted[i]<t||!n&&this._data_sorted[i]===t);i++)(this._data_sorted[i]>e||!n&&this._data_sorted[i]===e)&&c.push(this._data_sorted[i]);else if(this._config.buckets){for(i=0;i<=this._config.buckets.length;i++)if(!(this._config.buckets[i]<this.min)){if((l=0==i?this.min:this._config.buckets[i-1])<this.min&&(l=this.min),l>this.max&&(l=this.max),t<l||n&&t===l)break;if(e<l||!n&&e===l)for(s=0;s<(this.buckets[i]?this.buckets[i][0]:0);s++)((u=r.prototype._get_nth_in_bucket.call(this,s,i))>e||!n&&u===e)&&(u<t||!n&&u===t)&&c.push(u)}c.min=Math.max(e,c.min),c.max=Math.min(t,c.max)}else if(this._config.bucket_precision){var d=Math.floor(e/this._config.bucket_precision),h=Math.floor(t/this._config.bucket_precision)+1;for(i=d;i<Math.min(this.buckets.length,h);i++)for(s=0;s<(this.buckets[i]?this.buckets[i][0]:0);s++)((u=r.prototype._get_nth_in_bucket.call(this,s,i))>e||!n&&u===e)&&(u<t||!n&&u===t)&&c.push(u);c.min=Math.max(e,c.min),c.max=Math.min(t,c.max)}return c},copy:function(e){var t=r.prototype.band_pass.call(this,this.min,this.max,!1,e);return t.sum=this.sum,t.sum_of_squares=this.sum_of_squares,t.sum_of_logs=this.sum_of_logs,t.sum_of_square_of_logs=this.sum_of_square_of_logs,t.zeroes=this.zeroes,t},"Σ":function(){return this.sum},"Π":function(){return this.zeroes>0?0:Math.exp(this.sum_of_logs)}},r.prototype.σ=r.prototype.stddev,r.prototype.μ=r.prototype.amean,n.Stats=r,e.argv[1]&&e.argv[1].match(t)){var i=(new r).push(1,2,3),s=e.argv.slice(2);s.length||(s=[10,11,15,8,13,12,19,32,17,16]),s.forEach((function(e,t,n){n[t]=parseFloat(e,10)})),r.prototype.push.apply(i,s),console.log(i.amean().toFixed(2),i.μ().toFixed(2),i.stddev().toFixed(2),i.σ().toFixed(2),i.gmean().toFixed(2),i.median().toFixed(2),i.moe().toFixed(2))}}).call(this,e("g5I+bs"),"/node_modules/fast-stats/faststats.js")},{"g5I+bs":5}],4:[function(e,t,n){!function(e,o){"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof define&&define.amd?define(o):e.moment=o()}(this,(function(){"use strict";function n(){return ut.apply(null,arguments)}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function r(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function a(e){return void 0===e}function i(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function s(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function c(e,t){var n,o=[];for(n=0;n<e.length;++n)o.push(t(e[n],n));return o}function l(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function u(e,t){for(var n in t)l(t,n)&&(e[n]=t[n]);return l(t,"toString")&&(e.toString=t.toString),l(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,n,o){return Te(e,t,n,o,!0).utc()}function h(e){return null==e._pf&&(e._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}),e._pf}function p(e){if(null==e._isValid){var t=h(e),n=dt.call(t.parsedDateParts,(function(e){return null!=e})),o=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(o=o&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return o;e._isValid=o}return e._isValid}function f(e){var t=d(NaN);return null!=e?u(h(t),e):h(t).userInvalidated=!0,t}function m(e,t){var n,o,r;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=h(t)),a(t._locale)||(e._locale=t._locale),pt.length>0)for(n=0;n<pt.length;n++)a(r=t[o=pt[n]])||(e[o]=r);return e}function g(e){m(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===ft&&(ft=!0,n.updateOffset(this),ft=!1)}function y(e){return e instanceof g||null!=e&&null!=e._isAMomentObject}function _(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function b(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=_(t)),n}function v(e,t,n){var o,r=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),i=0;for(o=0;o<r;o++)(n&&e[o]!==t[o]||!n&&b(e[o])!==b(t[o]))&&i++;return i+a}function w(e){!1===n.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function x(e,t){var o=!0;return u((function(){if(null!=n.deprecationHandler&&n.deprecationHandler(null,e),o){for(var r,a=[],i=0;i<arguments.length;i++){if(r="","object"==typeof arguments[i]){for(var s in r+="\n["+i+"] ",arguments[0])r+=s+": "+arguments[0][s]+", ";r=r.slice(0,-2)}else r=arguments[i];a.push(r)}w(e+"\nArguments: "+Array.prototype.slice.call(a).join("")+"\n"+(new Error).stack),o=!1}return t.apply(this,arguments)}),t)}function k(e,t){null!=n.deprecationHandler&&n.deprecationHandler(e,t),mt[e]||(w(t),mt[e]=!0)}function $(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function T(e,t){var n,o=u({},e);for(n in t)l(t,n)&&(r(e[n])&&r(t[n])?(o[n]={},u(o[n],e[n]),u(o[n],t[n])):null!=t[n]?o[n]=t[n]:delete o[n]);for(n in e)l(e,n)&&!l(t,n)&&r(e[n])&&(o[n]=u({},o[n]));return o}function C(e){null!=e&&this.set(e)}function O(e,t){var n=e.toLowerCase();gt[n]=gt[n+"s"]=gt[t]=e}function S(e){return"string"==typeof e?gt[e]||gt[e.toLowerCase()]:void 0}function M(e){var t,n,o={};for(n in e)l(e,n)&&((t=S(n))&&(o[t]=e[n]));return o}function j(e,t){yt[e]=t}function E(e,t,n){var o=""+Math.abs(e),r=t-o.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+o}function D(e,t,n,o){var r=o;"string"==typeof o&&(r=function(){return this[o]()}),e&&(wt[e]=r),t&&(wt[t[0]]=function(){return E(r.apply(this,arguments),t[1],t[2])}),n&&(wt[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),e)})}function P(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function N(e,t){return e.isValid()?(t=L(t,e.localeData()),vt[t]=vt[t]||function(e){var t,n,o=e.match(_t);for(t=0,n=o.length;t<n;t++)wt[o[t]]?o[t]=wt[o[t]]:o[t]=P(o[t]);return function(t){var r,a="";for(r=0;r<n;r++)a+=$(o[r])?o[r].call(t,e):o[r];return a}}(t),vt[t](e)):e.localeData().invalidDate()}function L(e,t){function n(e){return t.longDateFormat(e)||e}var o=5;for(bt.lastIndex=0;o>=0&&bt.test(e);)e=e.replace(bt,n),bt.lastIndex=0,o-=1;return e}function F(e,t,n){Wt[e]=$(t)?t:function(e,o){return e&&n?n:t}}function A(e,t){return l(Wt,e)?Wt[e](t._strict,t._locale):new RegExp(function(e){return W(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,(function(e,t,n,o,r){return t||n||o||r})))}(e))}function W(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function I(e,t){var n,o=t;for("string"==typeof e&&(e=[e]),i(t)&&(o=function(e,n){n[t]=b(e)}),n=0;n<e.length;n++)It[e[n]]=o}function B(e,t){I(e,(function(e,n,o,r){o._w=o._w||{},t(e,o._w,o,r)}))}function Y(e,t,n){null!=t&&l(It,e)&&It[e](t,n._a,n,e)}function R(e){return H(e)?366:365}function H(e){return e%4==0&&e%100!=0||e%400==0}function q(e,t){return function(o){return null!=o?(V(this,e,o),n.updateOffset(this,t),this):z(this,e)}}function z(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function V(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&H(e.year())&&1===e.month()&&29===e.date()?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),G(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function G(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=function(e,t){return(e%t+t)%t}(t,12);return e+=(t-n)/12,1===n?H(e)?29:28:31-n%7%2}function U(e,t,n){var o,r,a,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)a=d([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(a,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(a,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(r=Zt.call(this._shortMonthsParse,i))?r:null:-1!==(r=Zt.call(this._longMonthsParse,i))?r:null:"MMM"===t?-1!==(r=Zt.call(this._shortMonthsParse,i))?r:-1!==(r=Zt.call(this._longMonthsParse,i))?r:null:-1!==(r=Zt.call(this._longMonthsParse,i))?r:-1!==(r=Zt.call(this._shortMonthsParse,i))?r:null}function Z(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=b(t);else if(!i(t=e.localeData().monthsParse(t)))return e;return n=Math.min(e.date(),G(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function J(e){return null!=e?(Z(this,e),n.updateOffset(this,!0),this):z(this,"Month")}function X(){function e(e,t){return t.length-e.length}var t,n,o=[],r=[],a=[];for(t=0;t<12;t++)n=d([2e3,t]),o.push(this.monthsShort(n,"")),r.push(this.months(n,"")),a.push(this.months(n,"")),a.push(this.monthsShort(n,""));for(o.sort(e),r.sort(e),a.sort(e),t=0;t<12;t++)o[t]=W(o[t]),r[t]=W(r[t]);for(t=0;t<24;t++)a[t]=W(a[t]);this._monthsRegex=new RegExp("^("+a.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function K(e,t,n,o,r,a,i){var s;return e<100&&e>=0?(s=new Date(e+400,t,n,o,r,a,i),isFinite(s.getFullYear())&&s.setFullYear(e)):s=new Date(e,t,n,o,r,a,i),s}function Q(e){var t;if(e<100&&e>=0){var n=Array.prototype.slice.call(arguments);n[0]=e+400,t=new Date(Date.UTC.apply(null,n)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)}else t=new Date(Date.UTC.apply(null,arguments));return t}function ee(e,t,n){var o=7+t-n;return-((7+Q(e,0,o).getUTCDay()-t)%7)+o-1}function te(e,t,n,o,r){var a,i,s=1+7*(t-1)+(7+n-o)%7+ee(e,o,r);return s<=0?i=R(a=e-1)+s:s>R(e)?(a=e+1,i=s-R(e)):(a=e,i=s),{year:a,dayOfYear:i}}function ne(e,t,n){var o,r,a=ee(e.year(),t,n),i=Math.floor((e.dayOfYear()-a-1)/7)+1;return i<1?o=i+oe(r=e.year()-1,t,n):i>oe(e.year(),t,n)?(o=i-oe(e.year(),t,n),r=e.year()+1):(r=e.year(),o=i),{week:o,year:r}}function oe(e,t,n){var o=ee(e,t,n),r=ee(e+1,t,n);return(R(e)-o+r)/7}function re(e,t){return e.slice(t,7).concat(e.slice(0,t))}function ae(e,t,n){var o,r,a,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)a=d([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(a,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(a,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(a,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(r=Zt.call(this._weekdaysParse,i))?r:null:"ddd"===t?-1!==(r=Zt.call(this._shortWeekdaysParse,i))?r:null:-1!==(r=Zt.call(this._minWeekdaysParse,i))?r:null:"dddd"===t?-1!==(r=Zt.call(this._weekdaysParse,i))?r:-1!==(r=Zt.call(this._shortWeekdaysParse,i))?r:-1!==(r=Zt.call(this._minWeekdaysParse,i))?r:null:"ddd"===t?-1!==(r=Zt.call(this._shortWeekdaysParse,i))?r:-1!==(r=Zt.call(this._weekdaysParse,i))?r:-1!==(r=Zt.call(this._minWeekdaysParse,i))?r:null:-1!==(r=Zt.call(this._minWeekdaysParse,i))?r:-1!==(r=Zt.call(this._weekdaysParse,i))?r:-1!==(r=Zt.call(this._shortWeekdaysParse,i))?r:null}function ie(){function e(e,t){return t.length-e.length}var t,n,o,r,a,i=[],s=[],c=[],l=[];for(t=0;t<7;t++)n=d([2e3,1]).day(t),o=this.weekdaysMin(n,""),r=this.weekdaysShort(n,""),a=this.weekdays(n,""),i.push(o),s.push(r),c.push(a),l.push(o),l.push(r),l.push(a);for(i.sort(e),s.sort(e),c.sort(e),l.sort(e),t=0;t<7;t++)s[t]=W(s[t]),c[t]=W(c[t]),l[t]=W(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+i.join("|")+")","i")}function se(){return this.hours()%12||12}function ce(e,t){D(e,0,0,(function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)}))}function le(e,t){return t._meridiemParse}function ue(e){return e?e.toLowerCase().replace("_","-"):e}function de(n){var o=null;if(!hn[n]&&void 0!==t&&t&&t.exports)try{o=ln._abbr,e("./locale/"+n),he(o)}catch(e){}return hn[n]}function he(e,t){var n;return e&&((n=a(t)?fe(e):pe(e,t))?ln=n:"undefined"!=typeof console&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),ln._abbr}function pe(e,t){if(null!==t){var n,o=dn;if(t.abbr=e,null!=hn[e])k("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),o=hn[e]._config;else if(null!=t.parentLocale)if(null!=hn[t.parentLocale])o=hn[t.parentLocale]._config;else{if(null==(n=de(t.parentLocale)))return pn[t.parentLocale]||(pn[t.parentLocale]=[]),pn[t.parentLocale].push({name:e,config:t}),null;o=n._config}return hn[e]=new C(T(o,t)),pn[e]&&pn[e].forEach((function(e){pe(e.name,e.config)})),he(e),hn[e]}return delete hn[e],null}function fe(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return ln;if(!o(e)){if(t=de(e))return t;e=[e]}return function(e){for(var t,n,o,r,a=0;a<e.length;){for(t=(r=ue(e[a]).split("-")).length,n=(n=ue(e[a+1]))?n.split("-"):null;t>0;){if(o=de(r.slice(0,t).join("-")))return o;if(n&&n.length>=t&&v(r,n,!0)>=t-1)break;t--}a++}return ln}(e)}function me(e){var t,n=e._a;return n&&-2===h(e).overflow&&(t=n[Yt]<0||n[Yt]>11?Yt:n[Rt]<1||n[Rt]>G(n[Bt],n[Yt])?Rt:n[Ht]<0||n[Ht]>24||24===n[Ht]&&(0!==n[qt]||0!==n[zt]||0!==n[Vt])?Ht:n[qt]<0||n[qt]>59?qt:n[zt]<0||n[zt]>59?zt:n[Vt]<0||n[Vt]>999?Vt:-1,h(e)._overflowDayOfYear&&(t<Bt||t>Rt)&&(t=Rt),h(e)._overflowWeeks&&-1===t&&(t=Gt),h(e)._overflowWeekday&&-1===t&&(t=Ut),h(e).overflow=t),e}function ge(e,t,n){return null!=e?e:null!=t?t:n}function ye(e){var t=new Date(n.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function _e(e){var t,n,o,r,a,i=[];if(!e._d){for(o=ye(e),e._w&&null==e._a[Rt]&&null==e._a[Yt]&&function(e){var t,n,o,r,a,i,s,c;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)a=1,i=4,n=ge(t.GG,e._a[Bt],ne(Ce(),1,4).year),o=ge(t.W,1),r=ge(t.E,1),(r<1||r>7)&&(c=!0);else{a=e._locale._week.dow,i=e._locale._week.doy;var l=ne(Ce(),a,i);n=ge(t.gg,e._a[Bt],l.year),o=ge(t.w,l.week),null!=t.d?((r=t.d)<0||r>6)&&(c=!0):null!=t.e?(r=t.e+a,(t.e<0||t.e>6)&&(c=!0)):r=a}o<1||o>oe(n,a,i)?h(e)._overflowWeeks=!0:null!=c?h(e)._overflowWeekday=!0:(s=te(n,o,r,a,i),e._a[Bt]=s.year,e._dayOfYear=s.dayOfYear)}(e),null!=e._dayOfYear&&(a=ge(e._a[Bt],o[Bt]),(e._dayOfYear>R(a)||0===e._dayOfYear)&&(h(e)._overflowDayOfYear=!0),n=Q(a,0,e._dayOfYear),e._a[Yt]=n.getUTCMonth(),e._a[Rt]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=i[t]=o[t];for(;t<7;t++)e._a[t]=i[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[Ht]&&0===e._a[qt]&&0===e._a[zt]&&0===e._a[Vt]&&(e._nextDay=!0,e._a[Ht]=0),e._d=(e._useUTC?Q:K).apply(null,i),r=e._useUTC?e._d.getUTCDay():e._d.getDay(),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ht]=24),e._w&&void 0!==e._w.d&&e._w.d!==r&&(h(e).weekdayMismatch=!0)}}function be(e){var t,n,o,r,a,i,s=e._i,c=fn.exec(s)||mn.exec(s);if(c){for(h(e).iso=!0,t=0,n=yn.length;t<n;t++)if(yn[t][1].exec(c[1])){r=yn[t][0],o=!1!==yn[t][2];break}if(null==r)return void(e._isValid=!1);if(c[3]){for(t=0,n=_n.length;t<n;t++)if(_n[t][1].exec(c[3])){a=(c[2]||" ")+_n[t][0];break}if(null==a)return void(e._isValid=!1)}if(!o&&null!=a)return void(e._isValid=!1);if(c[4]){if(!gn.exec(c[4]))return void(e._isValid=!1);i="Z"}e._f=r+(a||"")+(i||""),xe(e)}else e._isValid=!1}function ve(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function we(e){var t=vn.exec(function(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}(e._i));if(t){var n=function(e,t,n,o,r,a){var i=[ve(e),Qt.indexOf(t),parseInt(n,10),parseInt(o,10),parseInt(r,10)];return a&&i.push(parseInt(a,10)),i}(t[4],t[3],t[2],t[5],t[6],t[7]);if(!function(e,t,n){return!e||on.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(h(n).weekdayMismatch=!0,n._isValid=!1,!1)}(t[1],n,e))return;e._a=n,e._tzm=function(e,t,n){if(e)return wn[e];if(t)return 0;var o=parseInt(n,10),r=o%100;return(o-r)/100*60+r}(t[8],t[9],t[10]),e._d=Q.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),h(e).rfc2822=!0}else e._isValid=!1}function xe(e){if(e._f!==n.ISO_8601)if(e._f!==n.RFC_2822){e._a=[],h(e).empty=!0;var t,o,r,a,i,s=""+e._i,c=s.length,l=0;for(r=L(e._f,e._locale).match(_t)||[],t=0;t<r.length;t++)a=r[t],(o=(s.match(A(a,e))||[])[0])&&((i=s.substr(0,s.indexOf(o))).length>0&&h(e).unusedInput.push(i),s=s.slice(s.indexOf(o)+o.length),l+=o.length),wt[a]?(o?h(e).empty=!1:h(e).unusedTokens.push(a),Y(a,o,e)):e._strict&&!o&&h(e).unusedTokens.push(a);h(e).charsLeftOver=c-l,s.length>0&&h(e).unusedInput.push(s),e._a[Ht]<=12&&!0===h(e).bigHour&&e._a[Ht]>0&&(h(e).bigHour=void 0),h(e).parsedDateParts=e._a.slice(0),h(e).meridiem=e._meridiem,e._a[Ht]=function(e,t,n){var o;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(o=e.isPM(n),o&&t<12&&(t+=12),o||12!==t||(t=0),t):t}(e._locale,e._a[Ht],e._meridiem),_e(e),me(e)}else we(e);else be(e)}function ke(e){var t=e._i,n=e._f;return e._locale=e._locale||fe(e._l),null===t||void 0===n&&""===t?f({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),y(t)?new g(me(t)):(s(t)?e._d=t:o(n)?function(e){var t,n,o,r,a;if(0===e._f.length)return h(e).invalidFormat=!0,void(e._d=new Date(NaN));for(r=0;r<e._f.length;r++)a=0,t=m({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[r],xe(t),p(t)&&(a+=h(t).charsLeftOver,a+=10*h(t).unusedTokens.length,h(t).score=a,(null==o||a<o)&&(o=a,n=t));u(e,n||t)}(e):n?xe(e):$e(e),p(e)||(e._d=null),e))}function $e(e){var t=e._i;a(t)?e._d=new Date(n.now()):s(t)?e._d=new Date(t.valueOf()):"string"==typeof t?function(e){var t=bn.exec(e._i);null!==t?e._d=new Date(+t[1]):(be(e),!1===e._isValid&&(delete e._isValid,we(e),!1===e._isValid&&(delete e._isValid,n.createFromInputFallback(e))))}(e):o(t)?(e._a=c(t.slice(0),(function(e){return parseInt(e,10)})),_e(e)):r(t)?function(e){if(!e._d){var t=M(e._i);e._a=c([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],(function(e){return e&&parseInt(e,10)})),_e(e)}}(e):i(t)?e._d=new Date(t):n.createFromInputFallback(e)}function Te(e,t,n,a,i){var s={};return!0!==n&&!1!==n||(a=n,n=void 0),(r(e)&&function(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}(e)||o(e)&&0===e.length)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=n,s._i=e,s._f=t,s._strict=a,function(e){var t=new g(me(ke(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}(s)}function Ce(e,t,n,o){return Te(e,t,n,o,!1)}function Oe(e,t){var n,r;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return Ce();for(n=t[0],r=1;r<t.length;++r)t[r].isValid()&&!t[r][e](n)||(n=t[r]);return n}function Se(e){var t=M(e),n=t.year||0,o=t.quarter||0,r=t.month||0,a=t.week||t.isoWeek||0,i=t.day||0,s=t.hour||0,c=t.minute||0,l=t.second||0,u=t.millisecond||0;this._isValid=function(e){for(var t in e)if(-1===Zt.call($n,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,o=0;o<$n.length;++o)if(e[$n[o]]){if(n)return!1;parseFloat(e[$n[o]])!==b(e[$n[o]])&&(n=!0)}return!0}(t),this._milliseconds=+u+1e3*l+6e4*c+1e3*s*60*60,this._days=+i+7*a,this._months=+r+3*o+12*n,this._data={},this._locale=fe(),this._bubble()}function Me(e){return e instanceof Se}function je(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ee(e,t){D(e,0,0,(function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+E(~~(e/60),2)+t+E(~~e%60,2)}))}function De(e,t){var n=(t||"").match(e);if(null===n)return null;var o=((n[n.length-1]||[])+"").match(Tn)||["-",0,0],r=60*o[1]+b(o[2]);return 0===r?0:"+"===o[0]?r:-r}function Pe(e,t){var o,r;return t._isUTC?(o=t.clone(),r=(y(e)||s(e)?e.valueOf():Ce(e).valueOf())-o.valueOf(),o._d.setTime(o._d.valueOf()+r),n.updateOffset(o,!1),o):Ce(e).local()}function Ne(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Le(){return!!this.isValid()&&this._isUTC&&0===this._offset}function Fe(e,t){var n,o,r,a=e,s=null;return Me(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:i(e)?(a={},t?a[t]=e:a.milliseconds=e):(s=Cn.exec(e))?(n="-"===s[1]?-1:1,a={y:0,d:b(s[Rt])*n,h:b(s[Ht])*n,m:b(s[qt])*n,s:b(s[zt])*n,ms:b(je(1e3*s[Vt]))*n}):(s=On.exec(e))?(n="-"===s[1]?-1:1,a={y:Ae(s[2],n),M:Ae(s[3],n),w:Ae(s[4],n),d:Ae(s[5],n),h:Ae(s[6],n),m:Ae(s[7],n),s:Ae(s[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(r=function(e,t){var n;return e.isValid()&&t.isValid()?(t=Pe(t,e),e.isBefore(t)?n=We(e,t):(n=We(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}(Ce(a.from),Ce(a.to)),(a={}).ms=r.milliseconds,a.M=r.months),o=new Se(a),Me(e)&&l(e,"_locale")&&(o._locale=e._locale),o}function Ae(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function We(e,t){var n={};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function Ie(e,t){return function(n,o){var r;return null===o||isNaN(+o)||(k(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=o,o=r),Be(this,Fe(n="string"==typeof n?+n:n,o),e),this}}function Be(e,t,o,r){var a=t._milliseconds,i=je(t._days),s=je(t._months);e.isValid()&&(r=null==r||r,s&&Z(e,z(e,"Month")+s*o),i&&V(e,"Date",z(e,"Date")+i*o),a&&e._d.setTime(e._d.valueOf()+a*o),r&&n.updateOffset(e,i||s))}function Ye(e,t){var n,o=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(o,"months");return t-r<0?n=(t-r)/(r-e.clone().add(o-1,"months")):n=(t-r)/(e.clone().add(o+1,"months")-r),-(o+n)||0}function Re(e){var t;return void 0===e?this._locale._abbr:(null!=(t=fe(e))&&(this._locale=t),this)}function He(){return this._locale}function qe(e,t){return(e%t+t)%t}function ze(e,t,n){return e<100&&e>=0?new Date(e+400,t,n)-Nn:new Date(e,t,n).valueOf()}function Ve(e,t,n){return e<100&&e>=0?Date.UTC(e+400,t,n)-Nn:Date.UTC(e,t,n)}function Ge(e,t){D(0,[e,e.length],0,t)}function Ue(e,t,n,o,r){var a;return null==e?ne(this,o,r).year:(t>(a=oe(e,o,r))&&(t=a),Ze.call(this,e,t,n,o,r))}function Ze(e,t,n,o,r){var a=te(e,t,n,o,r),i=Q(a.year,0,a.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}function Je(e,t){t[Vt]=b(1e3*("0."+e))}function Xe(e){return e}function Ke(e,t,n,o){var r=fe(),a=d().set(o,t);return r[n](a,e)}function Qe(e,t,n){if(i(e)&&(t=e,e=void 0),e=e||"",null!=t)return Ke(e,t,n,"month");var o,r=[];for(o=0;o<12;o++)r[o]=Ke(e,o,n,"month");return r}function et(e,t,n,o){"boolean"==typeof e?(i(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,i(t)&&(n=t,t=void 0),t=t||"");var r=fe(),a=e?r._week.dow:0;if(null!=n)return Ke(t,(n+a)%7,o,"day");var s,c=[];for(s=0;s<7;s++)c[s]=Ke(t,(s+a)%7,o,"day");return c}function tt(e,t,n,o){var r=Fe(t,n);return e._milliseconds+=o*r._milliseconds,e._days+=o*r._days,e._months+=o*r._months,e._bubble()}function nt(e){return e<0?Math.floor(e):Math.ceil(e)}function ot(e){return 4800*e/146097}function rt(e){return 146097*e/4800}function at(e){return function(){return this.as(e)}}function it(e){return function(){return this.isValid()?this._data[e]:NaN}}function st(e,t,n,o,r){return r.relativeTime(t||1,!!n,e,o)}function ct(e){return(e>0)-(e<0)||+e}function lt(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n=so(this._milliseconds)/1e3,o=so(this._days),r=so(this._months);e=_(n/60),t=_(e/60),n%=60,e%=60;var a=_(r/12),i=r%=12,s=o,c=t,l=e,u=n?n.toFixed(3).replace(/\.?0+$/,""):"",d=this.asSeconds();if(!d)return"P0D";var h=d<0?"-":"",p=ct(this._months)!==ct(d)?"-":"",f=ct(this._days)!==ct(d)?"-":"",m=ct(this._milliseconds)!==ct(d)?"-":"";return h+"P"+(a?p+a+"Y":"")+(i?p+i+"M":"")+(s?f+s+"D":"")+(c||l||u?"T":"")+(c?m+c+"H":"")+(l?m+l+"M":"")+(u?m+u+"S":"")}var ut,dt;dt=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,o=0;o<n;o++)if(o in t&&e.call(this,t[o],o,t))return!0;return!1};var ht,pt=n.momentProperties=[],ft=!1,mt={};n.suppressDeprecationWarnings=!1,n.deprecationHandler=null,ht=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)l(e,t)&&n.push(t);return n};var gt={},yt={},_t=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,bt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,vt={},wt={},xt=/\d/,kt=/\d\d/,$t=/\d{3}/,Tt=/\d{4}/,Ct=/[+-]?\d{6}/,Ot=/\d\d?/,St=/\d\d\d\d?/,Mt=/\d\d\d\d\d\d?/,jt=/\d{1,3}/,Et=/\d{1,4}/,Dt=/[+-]?\d{1,6}/,Pt=/\d+/,Nt=/[+-]?\d+/,Lt=/Z|[+-]\d\d:?\d\d/gi,Ft=/Z|[+-]\d\d(?::?\d\d)?/gi,At=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Wt={},It={},Bt=0,Yt=1,Rt=2,Ht=3,qt=4,zt=5,Vt=6,Gt=7,Ut=8;D("Y",0,0,(function(){var e=this.year();return e<=9999?""+e:"+"+e})),D(0,["YY",2],0,(function(){return this.year()%100})),D(0,["YYYY",4],0,"year"),D(0,["YYYYY",5],0,"year"),D(0,["YYYYYY",6,!0],0,"year"),O("year","y"),j("year",1),F("Y",Nt),F("YY",Ot,kt),F("YYYY",Et,Tt),F("YYYYY",Dt,Ct),F("YYYYYY",Dt,Ct),I(["YYYYY","YYYYYY"],Bt),I("YYYY",(function(e,t){t[Bt]=2===e.length?n.parseTwoDigitYear(e):b(e)})),I("YY",(function(e,t){t[Bt]=n.parseTwoDigitYear(e)})),I("Y",(function(e,t){t[Bt]=parseInt(e,10)})),n.parseTwoDigitYear=function(e){return b(e)+(b(e)>68?1900:2e3)};var Zt,Jt=q("FullYear",!0);Zt=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},D("M",["MM",2],"Mo",(function(){return this.month()+1})),D("MMM",0,0,(function(e){return this.localeData().monthsShort(this,e)})),D("MMMM",0,0,(function(e){return this.localeData().months(this,e)})),O("month","M"),j("month",8),F("M",Ot),F("MM",Ot,kt),F("MMM",(function(e,t){return t.monthsShortRegex(e)})),F("MMMM",(function(e,t){return t.monthsRegex(e)})),I(["M","MM"],(function(e,t){t[Yt]=b(e)-1})),I(["MMM","MMMM"],(function(e,t,n,o){var r=n._locale.monthsParse(e,o,n._strict);null!=r?t[Yt]=r:h(n).invalidMonth=e}));var Xt=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Kt="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Qt="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),en=At,tn=At;D("w",["ww",2],"wo","week"),D("W",["WW",2],"Wo","isoWeek"),O("week","w"),O("isoWeek","W"),j("week",5),j("isoWeek",5),F("w",Ot),F("ww",Ot,kt),F("W",Ot),F("WW",Ot,kt),B(["w","ww","W","WW"],(function(e,t,n,o){t[o.substr(0,1)]=b(e)}));D("d",0,"do","day"),D("dd",0,0,(function(e){return this.localeData().weekdaysMin(this,e)})),D("ddd",0,0,(function(e){return this.localeData().weekdaysShort(this,e)})),D("dddd",0,0,(function(e){return this.localeData().weekdays(this,e)})),D("e",0,0,"weekday"),D("E",0,0,"isoWeekday"),O("day","d"),O("weekday","e"),O("isoWeekday","E"),j("day",11),j("weekday",11),j("isoWeekday",11),F("d",Ot),F("e",Ot),F("E",Ot),F("dd",(function(e,t){return t.weekdaysMinRegex(e)})),F("ddd",(function(e,t){return t.weekdaysShortRegex(e)})),F("dddd",(function(e,t){return t.weekdaysRegex(e)})),B(["dd","ddd","dddd"],(function(e,t,n,o){var r=n._locale.weekdaysParse(e,o,n._strict);null!=r?t.d=r:h(n).invalidWeekday=e})),B(["d","e","E"],(function(e,t,n,o){t[o]=b(e)}));var nn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),on="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),rn="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),an=At,sn=At,cn=At;D("H",["HH",2],0,"hour"),D("h",["hh",2],0,se),D("k",["kk",2],0,(function(){return this.hours()||24})),D("hmm",0,0,(function(){return""+se.apply(this)+E(this.minutes(),2)})),D("hmmss",0,0,(function(){return""+se.apply(this)+E(this.minutes(),2)+E(this.seconds(),2)})),D("Hmm",0,0,(function(){return""+this.hours()+E(this.minutes(),2)})),D("Hmmss",0,0,(function(){return""+this.hours()+E(this.minutes(),2)+E(this.seconds(),2)})),ce("a",!0),ce("A",!1),O("hour","h"),j("hour",13),F("a",le),F("A",le),F("H",Ot),F("h",Ot),F("k",Ot),F("HH",Ot,kt),F("hh",Ot,kt),F("kk",Ot,kt),F("hmm",St),F("hmmss",Mt),F("Hmm",St),F("Hmmss",Mt),I(["H","HH"],Ht),I(["k","kk"],(function(e,t,n){var o=b(e);t[Ht]=24===o?0:o})),I(["a","A"],(function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e})),I(["h","hh"],(function(e,t,n){t[Ht]=b(e),h(n).bigHour=!0})),I("hmm",(function(e,t,n){var o=e.length-2;t[Ht]=b(e.substr(0,o)),t[qt]=b(e.substr(o)),h(n).bigHour=!0})),I("hmmss",(function(e,t,n){var o=e.length-4,r=e.length-2;t[Ht]=b(e.substr(0,o)),t[qt]=b(e.substr(o,2)),t[zt]=b(e.substr(r)),h(n).bigHour=!0})),I("Hmm",(function(e,t,n){var o=e.length-2;t[Ht]=b(e.substr(0,o)),t[qt]=b(e.substr(o))})),I("Hmmss",(function(e,t,n){var o=e.length-4,r=e.length-2;t[Ht]=b(e.substr(0,o)),t[qt]=b(e.substr(o,2)),t[zt]=b(e.substr(r))}));var ln,un=q("Hours",!0),dn={calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},longDateFormat:{LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:/\d{1,2}/,relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},months:Kt,monthsShort:Qt,week:{dow:0,doy:6},weekdays:nn,weekdaysMin:rn,weekdaysShort:on,meridiemParse:/[ap]\.?m?\.?/i},hn={},pn={},fn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gn=/Z|[+-]\d\d(?::?\d\d)?/,yn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],_n=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],bn=/^\/?Date\((\-?\d+)/i,vn=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,wn={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};n.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",(function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))})),n.ISO_8601=function(){},n.RFC_2822=function(){};var xn=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Ce.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:f()})),kn=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",(function(){var e=Ce.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:f()})),$n=["year","quarter","month","week","day","hour","minute","second","millisecond"];Ee("Z",":"),Ee("ZZ",""),F("Z",Ft),F("ZZ",Ft),I(["Z","ZZ"],(function(e,t,n){n._useUTC=!0,n._tzm=De(Ft,e)}));var Tn=/([\+\-]|\d\d)/gi;n.updateOffset=function(){};var Cn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,On=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Fe.fn=Se.prototype,Fe.invalid=function(){return Fe(NaN)};var Sn=Ie(1,"add"),Mn=Ie(-1,"subtract");n.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",n.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var jn=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",(function(e){return void 0===e?this.localeData():this.locale(e)})),En=1e3,Dn=60*En,Pn=60*Dn,Nn=3506328*Pn;D(0,["gg",2],0,(function(){return this.weekYear()%100})),D(0,["GG",2],0,(function(){return this.isoWeekYear()%100})),Ge("gggg","weekYear"),Ge("ggggg","weekYear"),Ge("GGGG","isoWeekYear"),Ge("GGGGG","isoWeekYear"),O("weekYear","gg"),O("isoWeekYear","GG"),j("weekYear",1),j("isoWeekYear",1),F("G",Nt),F("g",Nt),F("GG",Ot,kt),F("gg",Ot,kt),F("GGGG",Et,Tt),F("gggg",Et,Tt),F("GGGGG",Dt,Ct),F("ggggg",Dt,Ct),B(["gggg","ggggg","GGGG","GGGGG"],(function(e,t,n,o){t[o.substr(0,2)]=b(e)})),B(["gg","GG"],(function(e,t,o,r){t[r]=n.parseTwoDigitYear(e)})),D("Q",0,"Qo","quarter"),O("quarter","Q"),j("quarter",7),F("Q",xt),I("Q",(function(e,t){t[Yt]=3*(b(e)-1)})),D("D",["DD",2],"Do","date"),O("date","D"),j("date",9),F("D",Ot),F("DD",Ot,kt),F("Do",(function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient})),I(["D","DD"],Rt),I("Do",(function(e,t){t[Rt]=b(e.match(Ot)[0])}));var Ln=q("Date",!0);D("DDD",["DDDD",3],"DDDo","dayOfYear"),O("dayOfYear","DDD"),j("dayOfYear",4),F("DDD",jt),F("DDDD",$t),I(["DDD","DDDD"],(function(e,t,n){n._dayOfYear=b(e)})),D("m",["mm",2],0,"minute"),O("minute","m"),j("minute",14),F("m",Ot),F("mm",Ot,kt),I(["m","mm"],qt);var Fn=q("Minutes",!1);D("s",["ss",2],0,"second"),O("second","s"),j("second",15),F("s",Ot),F("ss",Ot,kt),I(["s","ss"],zt);var An,Wn=q("Seconds",!1);for(D("S",0,0,(function(){return~~(this.millisecond()/100)})),D(0,["SS",2],0,(function(){return~~(this.millisecond()/10)})),D(0,["SSS",3],0,"millisecond"),D(0,["SSSS",4],0,(function(){return 10*this.millisecond()})),D(0,["SSSSS",5],0,(function(){return 100*this.millisecond()})),D(0,["SSSSSS",6],0,(function(){return 1e3*this.millisecond()})),D(0,["SSSSSSS",7],0,(function(){return 1e4*this.millisecond()})),D(0,["SSSSSSSS",8],0,(function(){return 1e5*this.millisecond()})),D(0,["SSSSSSSSS",9],0,(function(){return 1e6*this.millisecond()})),O("millisecond","ms"),j("millisecond",16),F("S",jt,xt),F("SS",jt,kt),F("SSS",jt,$t),An="SSSS";An.length<=9;An+="S")F(An,Pt);for(An="S";An.length<=9;An+="S")I(An,Je);var In=q("Milliseconds",!1);D("z",0,0,"zoneAbbr"),D("zz",0,0,"zoneName");var Bn=g.prototype;Bn.add=Sn,Bn.calendar=function(e,t){var o=e||Ce(),r=Pe(o,this).startOf("day"),a=n.calendarFormat(this,r)||"sameElse",i=t&&($(t[a])?t[a].call(this,o):t[a]);return this.format(i||this.localeData().calendar(a,this,Ce(o)))},Bn.clone=function(){return new g(this)},Bn.diff=function(e,t,n){var o,r,a;if(!this.isValid())return NaN;if(!(o=Pe(e,this)).isValid())return NaN;switch(r=6e4*(o.utcOffset()-this.utcOffset()),t=S(t)){case"year":a=Ye(this,o)/12;break;case"month":a=Ye(this,o);break;case"quarter":a=Ye(this,o)/3;break;case"second":a=(this-o)/1e3;break;case"minute":a=(this-o)/6e4;break;case"hour":a=(this-o)/36e5;break;case"day":a=(this-o-r)/864e5;break;case"week":a=(this-o-r)/6048e5;break;default:a=this-o}return n?a:_(a)},Bn.endOf=function(e){var t;if(void 0===(e=S(e))||"millisecond"===e||!this.isValid())return this;var o=this._isUTC?Ve:ze;switch(e){case"year":t=o(this.year()+1,0,1)-1;break;case"quarter":t=o(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=o(this.year(),this.month()+1,1)-1;break;case"week":t=o(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=o(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=Pn-qe(t+(this._isUTC?0:this.utcOffset()*Dn),Pn)-1;break;case"minute":t=this._d.valueOf(),t+=Dn-qe(t,Dn)-1;break;case"second":t=this._d.valueOf(),t+=En-qe(t,En)-1}return this._d.setTime(t),n.updateOffset(this,!0),this},Bn.format=function(e){e||(e=this.isUtc()?n.defaultFormatUtc:n.defaultFormat);var t=N(this,e);return this.localeData().postformat(t)},Bn.from=function(e,t){return this.isValid()&&(y(e)&&e.isValid()||Ce(e).isValid())?Fe({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Bn.fromNow=function(e){return this.from(Ce(),e)},Bn.to=function(e,t){return this.isValid()&&(y(e)&&e.isValid()||Ce(e).isValid())?Fe({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},Bn.toNow=function(e){return this.to(Ce(),e)},Bn.get=function(e){return $(this[e=S(e)])?this[e]():this},Bn.invalidAt=function(){return h(this).overflow},Bn.isAfter=function(e,t){var n=y(e)?e:Ce(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=S(t)||"millisecond")?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},Bn.isBefore=function(e,t){var n=y(e)?e:Ce(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=S(t)||"millisecond")?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},Bn.isBetween=function(e,t,n,o){var r=y(e)?e:Ce(e),a=y(t)?t:Ce(t);return!!(this.isValid()&&r.isValid()&&a.isValid())&&(("("===(o=o||"()")[0]?this.isAfter(r,n):!this.isBefore(r,n))&&(")"===o[1]?this.isBefore(a,n):!this.isAfter(a,n)))},Bn.isSame=function(e,t){var n,o=y(e)?e:Ce(e);return!(!this.isValid()||!o.isValid())&&("millisecond"===(t=S(t)||"millisecond")?this.valueOf()===o.valueOf():(n=o.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},Bn.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},Bn.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},Bn.isValid=function(){return p(this)},Bn.lang=jn,Bn.locale=Re,Bn.localeData=He,Bn.max=kn,Bn.min=xn,Bn.parsingFlags=function(){return u({},h(this))},Bn.set=function(e,t){if("object"==typeof e)for(var n=function(e){var t=[];for(var n in e)t.push({unit:n,priority:yt[n]});return t.sort((function(e,t){return e.priority-t.priority})),t}(e=M(e)),o=0;o<n.length;o++)this[n[o].unit](e[n[o].unit]);else if($(this[e=S(e)]))return this[e](t);return this},Bn.startOf=function(e){var t;if(void 0===(e=S(e))||"millisecond"===e||!this.isValid())return this;var o=this._isUTC?Ve:ze;switch(e){case"year":t=o(this.year(),0,1);break;case"quarter":t=o(this.year(),this.month()-this.month()%3,1);break;case"month":t=o(this.year(),this.month(),1);break;case"week":t=o(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=o(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=o(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=qe(t+(this._isUTC?0:this.utcOffset()*Dn),Pn);break;case"minute":t=this._d.valueOf(),t-=qe(t,Dn);break;case"second":t=this._d.valueOf(),t-=qe(t,En)}return this._d.setTime(t),n.updateOffset(this,!0),this},Bn.subtract=Mn,Bn.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},Bn.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},Bn.toDate=function(){return new Date(this.valueOf())},Bn.toISOString=function(e){if(!this.isValid())return null;var t=!0!==e,n=t?this.clone().utc():this;return n.year()<0||n.year()>9999?N(n,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):$(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",N(n,"Z")):N(n,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")},Bn.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',o=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r=t+'[")]';return this.format(n+o+"-MM-DD[T]HH:mm:ss.SSS"+r)},Bn.toJSON=function(){return this.isValid()?this.toISOString():null},Bn.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},Bn.unix=function(){return Math.floor(this.valueOf()/1e3)},Bn.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},Bn.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},Bn.year=Jt,Bn.isLeapYear=function(){return H(this.year())},Bn.weekYear=function(e){return Ue.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},Bn.isoWeekYear=function(e){return Ue.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},Bn.quarter=Bn.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},Bn.month=J,Bn.daysInMonth=function(){return G(this.year(),this.month())},Bn.week=Bn.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},Bn.isoWeek=Bn.isoWeeks=function(e){var t=ne(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},Bn.weeksInYear=function(){var e=this.localeData()._week;return oe(this.year(),e.dow,e.doy)},Bn.isoWeeksInYear=function(){return oe(this.year(),1,4)},Bn.date=Ln,Bn.day=Bn.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=function(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}(e,this.localeData()),this.add(e-t,"d")):t},Bn.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},Bn.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=function(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},Bn.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},Bn.hour=Bn.hours=un,Bn.minute=Bn.minutes=Fn,Bn.second=Bn.seconds=Wn,Bn.millisecond=Bn.milliseconds=In,Bn.utcOffset=function(e,t,o){var r,a=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=De(Ft,e)))return this}else Math.abs(e)<16&&!o&&(e*=60);return!this._isUTC&&t&&(r=Ne(this)),this._offset=e,this._isUTC=!0,null!=r&&this.add(r,"m"),a!==e&&(!t||this._changeInProgress?Be(this,Fe(e-a,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,n.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?a:Ne(this)},Bn.utc=function(e){return this.utcOffset(0,e)},Bn.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Ne(this),"m")),this},Bn.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=De(Lt,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},Bn.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Ce(e).utcOffset():0,(this.utcOffset()-e)%60==0)},Bn.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},Bn.isLocal=function(){return!!this.isValid()&&!this._isUTC},Bn.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},Bn.isUtc=Le,Bn.isUTC=Le,Bn.zoneAbbr=function(){return this._isUTC?"UTC":""},Bn.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},Bn.dates=x("dates accessor is deprecated. Use date instead.",Ln),Bn.months=x("months accessor is deprecated. Use month instead",J),Bn.years=x("years accessor is deprecated. Use year instead",Jt),Bn.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",(function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()})),Bn.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",(function(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(m(e,this),(e=ke(e))._a){var t=e._isUTC?d(e._a):Ce(e._a);this._isDSTShifted=this.isValid()&&v(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}));var Yn=C.prototype;Yn.calendar=function(e,t,n){var o=this._calendar[e]||this._calendar.sameElse;return $(o)?o.call(t,n):o},Yn.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,(function(e){return e.slice(1)})),this._longDateFormat[e])},Yn.invalidDate=function(){return this._invalidDate},Yn.ordinal=function(e){return this._ordinal.replace("%d",e)},Yn.preparse=Xe,Yn.postformat=Xe,Yn.relativeTime=function(e,t,n,o){var r=this._relativeTime[n];return $(r)?r(e,t,n,o):r.replace(/%d/i,e)},Yn.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return $(n)?n(t):n.replace(/%s/i,t)},Yn.set=function(e){var t,n;for(n in e)$(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},Yn.months=function(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||Xt).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone},Yn.monthsShort=function(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[Xt.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},Yn.monthsParse=function(e,t,n){var o,r,a;if(this._monthsParseExact)return U.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(r=d([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[o]||(a="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[o]=new RegExp(a.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[o].test(e))return o;if(n&&"MMM"===t&&this._shortMonthsParse[o].test(e))return o;if(!n&&this._monthsParse[o].test(e))return o}},Yn.monthsRegex=function(e){return this._monthsParseExact?(l(this,"_monthsRegex")||X.call(this),e?this._monthsStrictRegex:this._monthsRegex):(l(this,"_monthsRegex")||(this._monthsRegex=tn),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},Yn.monthsShortRegex=function(e){return this._monthsParseExact?(l(this,"_monthsRegex")||X.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(l(this,"_monthsShortRegex")||(this._monthsShortRegex=en),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},Yn.week=function(e){return ne(e,this._week.dow,this._week.doy).week},Yn.firstDayOfYear=function(){return this._week.doy},Yn.firstDayOfWeek=function(){return this._week.dow},Yn.weekdays=function(e,t){var n=o(this._weekdays)?this._weekdays:this._weekdays[e&&!0!==e&&this._weekdays.isFormat.test(t)?"format":"standalone"];return!0===e?re(n,this._week.dow):e?n[e.day()]:n},Yn.weekdaysMin=function(e){return!0===e?re(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin},Yn.weekdaysShort=function(e){return!0===e?re(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort},Yn.weekdaysParse=function(e,t,n){var o,r,a;if(this._weekdaysParseExact)return ae.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(r=d([2e3,1]).day(o),n&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[o]||(a="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[o]=new RegExp(a.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[o].test(e))return o;if(n&&"ddd"===t&&this._shortWeekdaysParse[o].test(e))return o;if(n&&"dd"===t&&this._minWeekdaysParse[o].test(e))return o;if(!n&&this._weekdaysParse[o].test(e))return o}},Yn.weekdaysRegex=function(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||ie.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(l(this,"_weekdaysRegex")||(this._weekdaysRegex=an),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},Yn.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||ie.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(l(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=sn),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},Yn.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(l(this,"_weekdaysRegex")||ie.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(l(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=cn),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},Yn.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},Yn.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},he("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===b(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),n.lang=x("moment.lang is deprecated. Use moment.locale instead.",he),n.langData=x("moment.langData is deprecated. Use moment.localeData instead.",fe);var Rn=Math.abs,Hn=at("ms"),qn=at("s"),zn=at("m"),Vn=at("h"),Gn=at("d"),Un=at("w"),Zn=at("M"),Jn=at("Q"),Xn=at("y"),Kn=it("milliseconds"),Qn=it("seconds"),eo=it("minutes"),to=it("hours"),no=it("days"),oo=it("months"),ro=it("years"),ao=Math.round,io={ss:44,s:45,m:45,h:22,d:26,M:11},so=Math.abs,co=Se.prototype;return co.isValid=function(){return this._isValid},co.abs=function(){var e=this._data;return this._milliseconds=Rn(this._milliseconds),this._days=Rn(this._days),this._months=Rn(this._months),e.milliseconds=Rn(e.milliseconds),e.seconds=Rn(e.seconds),e.minutes=Rn(e.minutes),e.hours=Rn(e.hours),e.months=Rn(e.months),e.years=Rn(e.years),this},co.add=function(e,t){return tt(this,e,t,1)},co.subtract=function(e,t){return tt(this,e,t,-1)},co.as=function(e){if(!this.isValid())return NaN;var t,n,o=this._milliseconds;if("month"===(e=S(e))||"quarter"===e||"year"===e)switch(t=this._days+o/864e5,n=this._months+ot(t),e){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(t=this._days+Math.round(rt(this._months)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}},co.asMilliseconds=Hn,co.asSeconds=qn,co.asMinutes=zn,co.asHours=Vn,co.asDays=Gn,co.asWeeks=Un,co.asMonths=Zn,co.asQuarters=Jn,co.asYears=Xn,co.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*b(this._months/12):NaN},co._bubble=function(){var e,t,n,o,r,a=this._milliseconds,i=this._days,s=this._months,c=this._data;return a>=0&&i>=0&&s>=0||a<=0&&i<=0&&s<=0||(a+=864e5*nt(rt(s)+i),i=0,s=0),c.milliseconds=a%1e3,e=_(a/1e3),c.seconds=e%60,t=_(e/60),c.minutes=t%60,n=_(t/60),c.hours=n%24,i+=_(n/24),s+=r=_(ot(i)),i-=nt(rt(r)),o=_(s/12),s%=12,c.days=i,c.months=s,c.years=o,this},co.clone=function(){return Fe(this)},co.get=function(e){return e=S(e),this.isValid()?this[e+"s"]():NaN},co.milliseconds=Kn,co.seconds=Qn,co.minutes=eo,co.hours=to,co.days=no,co.weeks=function(){return _(this.days()/7)},co.months=oo,co.years=ro,co.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=function(e,t,n){var o=Fe(e).abs(),r=ao(o.as("s")),a=ao(o.as("m")),i=ao(o.as("h")),s=ao(o.as("d")),c=ao(o.as("M")),l=ao(o.as("y")),u=r<=io.ss&&["s",r]||r<io.s&&["ss",r]||a<=1&&["m"]||a<io.m&&["mm",a]||i<=1&&["h"]||i<io.h&&["hh",i]||s<=1&&["d"]||s<io.d&&["dd",s]||c<=1&&["M"]||c<io.M&&["MM",c]||l<=1&&["y"]||["yy",l];return u[2]=t,u[3]=+e>0,u[4]=n,st.apply(null,u)}(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},co.toISOString=lt,co.toString=lt,co.toJSON=lt,co.locale=Re,co.localeData=He,co.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",lt),co.lang=jn,D("X",0,0,"unix"),D("x",0,0,"valueOf"),F("x",Nt),F("X",/[+-]?\d+(\.\d{1,3})?/),I("X",(function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))})),I("x",(function(e,t,n){n._d=new Date(b(e))})),n.version="2.24.0",function(e){ut=e}(Ce),n.fn=Bn,n.min=function(){return Oe("isBefore",[].slice.call(arguments,0))},n.max=function(){return Oe("isAfter",[].slice.call(arguments,0))},n.now=function(){return Date.now?Date.now():+new Date},n.utc=d,n.unix=function(e){return Ce(1e3*e)},n.months=function(e,t){return Qe(e,t,"months")},n.isDate=s,n.locale=he,n.invalid=f,n.duration=Fe,n.isMoment=y,n.weekdays=function(e,t,n){return et(e,t,n,"weekdays")},n.parseZone=function(){return Ce.apply(null,arguments).parseZone()},n.localeData=fe,n.isDuration=Me,n.monthsShort=function(e,t){return Qe(e,t,"monthsShort")},n.weekdaysMin=function(e,t,n){return et(e,t,n,"weekdaysMin")},n.defineLocale=pe,n.updateLocale=function(e,t){if(null!=t){var n,o,r=dn;null!=(o=de(e))&&(r=o._config),(n=new C(t=T(r,t))).parentLocale=hn[e],hn[e]=n,he(e)}else null!=hn[e]&&(null!=hn[e].parentLocale?hn[e]=hn[e].parentLocale:null!=hn[e]&&delete hn[e]);return hn[e]},n.locales=function(){return ht(hn)},n.weekdaysShort=function(e,t,n){return et(e,t,n,"weekdaysShort")},n.normalizeUnits=S,n.relativeTimeRounding=function(e){return void 0===e?ao:"function"==typeof e&&(ao=e,!0)},n.relativeTimeThreshold=function(e,t){return void 0!==io[e]&&(void 0===t?io[e]:(io[e]=t,"s"===e&&(io.ss=t-1),!0))},n.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},n.prototype=Bn,n.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},n}))},{}],5:[function(e,t,n){function o(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",(function(e){var t=e.source;(t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)&&n.shift()()}),!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=o,r.addListener=o,r.once=o,r.off=o,r.removeListener=o,r.removeAllListeners=o,r.emit=o,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],6:[function(e,t,n){(function(e){!function(e,o){"object"==typeof n&&void 0!==t?t.exports=o():"function"==typeof define&&define.amd?define("underscore",o):(e="undefined"!=typeof globalThis?globalThis:e||self,function(){var t=e._,n=e._=o();n.noConflict=function(){return e._=t,n}}())}(this,(function(){function t(e,t){return t=null==t?e.length-1:+t,function(){for(var n=Math.max(arguments.length-t,0),o=Array(n),r=0;r<n;r++)o[r]=arguments[r+t];switch(t){case 0:return e.call(this,o);case 1:return e.call(this,arguments[0],o);case 2:return e.call(this,arguments[0],arguments[1],o)}var a=Array(t+1);for(r=0;r<t;r++)a[r]=arguments[r];return a[t]=o,e.apply(this,a)}}function n(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function o(e){return void 0===e}function r(e){return!0===e||!1===e||"[object Boolean]"===xe.call(e)}function a(e){var t="[object "+e+"]";return function(e){return xe.call(e)===t}}function i(e,t){return null!=e&&ke.call(e,t)}function s(e){return Fe(e)&&je(e)}function c(e){return function(){return e}}function l(e){return function(t){var n=e(t);return"number"==typeof n&&n>=0&&n<=Ne}}function u(e){return function(t){return null==t?void 0:t[e]}}function d(e,t){t=function(e){for(var t={},n=e.length,o=0;o<n;++o)t[e[o]]=!0;return{contains:function(e){return t[e]},push:function(n){return t[n]=!0,e.push(n)}}}(t);var n=Pe.length,o=e.constructor,r=qe(o)&&o.prototype||_e,a="constructor";for(i(e,a)&&!t.contains(a)&&t.push(a);n--;)(a=Pe[n])in e&&e[a]!==r[a]&&!t.contains(a)&&t.push(a)}function h(e){if(!n(e))return[];if(Oe)return Oe(e);var t=[];for(var o in e)i(e,o)&&t.push(o);return De&&d(e,t),t}function p(e,t){var n=h(t),o=n.length;if(null==e)return!o;for(var r=Object(e),a=0;a<o;a++){var i=n[a];if(t[i]!==r[i]||!(i in r))return!1}return!0}function f(e){return e instanceof f?e:this instanceof f?void(this._wrapped=e):new f(e)}function m(e){return new Uint8Array(e.buffer||e,e.byteOffset||0,Qe(e))}function g(e,t,n,o){if(e===t)return 0!==e||1/e==1/t;if(null==e||null==t)return!1;if(e!=e)return t!=t;var r=typeof e;return("function"===r||"object"===r||"object"==typeof t)&&y(e,t,n,o)}function y(e,t,n,o){e instanceof f&&(e=e._wrapped),t instanceof f&&(t=t._wrapped);var r=xe.call(e);if(r!==xe.call(t))return!1;if(Ve&&"[object Object]"==r&&Ze(e)){if(!Ze(t))return!1;r=rt}switch(r){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:0==+e?1/+e==1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return be.valueOf.call(e)===be.valueOf.call(t);case"[object ArrayBuffer]":case rt:return y(m(e),m(t),n,o)}var a="[object Array]"===r;if(!a&&nt(e)){if(Qe(e)!==Qe(t))return!1;if(e.buffer===t.buffer&&e.byteOffset===t.byteOffset)return!0;a=!0}if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var s=e.constructor,c=t.constructor;if(s!==c&&!(qe(s)&&s instanceof s&&qe(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}o=o||[];for(var l=(n=n||[]).length;l--;)if(n[l]===e)return o[l]===t;if(n.push(e),o.push(t),a){if((l=e.length)!==t.length)return!1;for(;l--;)if(!g(e[l],t[l],n,o))return!1}else{var u,d=h(e);if(l=d.length,h(t).length!==l)return!1;for(;l--;)if(!i(t,u=d[l])||!g(e[u],t[u],n,o))return!1}return n.pop(),o.pop(),!0}function _(e){if(!n(e))return[];var t=[];for(var o in e)t.push(o);return De&&d(e,t),t}function b(e){var t=ot(e);return function(n){if(null==n)return!1;var o=_(n);if(ot(o))return!1;for(var r=0;r<t;r++)if(!qe(n[e[r]]))return!1;return e!==lt||!qe(n[at])}}function v(e){for(var t=h(e),n=t.length,o=Array(n),r=0;r<n;r++)o[r]=e[t[r]];return o}function w(e){for(var t={},n=h(e),o=0,r=n.length;o<r;o++)t[e[n[o]]]=n[o];return t}function x(e){var t=[];for(var n in e)qe(e[n])&&t.push(n);return t.sort()}function k(e,t){return function(n){var o=arguments.length;if(t&&(n=Object(n)),o<2||null==n)return n;for(var r=1;r<o;r++)for(var a=arguments[r],i=e(a),s=i.length,c=0;c<s;c++){var l=i[c];t&&void 0!==n[l]||(n[l]=a[l])}return n}}function $(e){if(!n(e))return{};if(Se)return Se(e);var t=function(){};t.prototype=e;var o=new t;return t.prototype=null,o}function T(e){return n(e)?Je(e)?e.slice():mt({},e):e}function C(e){return Je(e)?e:[e]}function O(e){return f.toPath(e)}function S(e,t){for(var n=t.length,o=0;o<n;o++){if(null==e)return;e=e[t[o]]}return n?e:void 0}function M(e,t,n){var r=S(e,O(t));return o(r)?n:r}function j(e){return e}function E(e){return e=gt({},e),function(t){return p(t,e)}}function D(e){return e=O(e),function(t){return S(t,e)}}function P(e,t,n){if(void 0===t)return e;switch(null==n?3:n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,o,r){return e.call(t,n,o,r)};case 4:return function(n,o,r,a){return e.call(t,n,o,r,a)}}return function(){return e.apply(t,arguments)}}function N(e,t,o){return null==e?j:qe(e)?P(e,t,o):n(e)&&!Je(e)?E(e):D(e)}function L(e,t){return N(e,t,1/0)}function F(e,t,n){return f.iteratee!==L?f.iteratee(e,t):N(e,t,n)}function A(){}function W(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}function I(e){var t=function(t){return e[t]},n="(?:"+h(e).join("|")+")",o=RegExp(n),r=RegExp(n,"g");return function(e){return e=null==e?"":""+e,o.test(e)?e.replace(r,t):e}}function B(e){return"\\"+$t[e]}function Y(e,t,o,r,a){if(!(r instanceof t))return e.apply(o,a);var i=$(e.prototype),s=e.apply(i,a);return n(s)?s:i}function R(e,t,n,o){if(o=o||[],t||0===t){if(t<=0)return o.concat(e)}else t=1/0;for(var r=o.length,a=0,i=ot(e);a<i;a++){var s=e[a];if(jt(s)&&(Je(s)||Ke(s)))if(t>1)R(s,t-1,n,o),r=o.length;else for(var c=0,l=s.length;c<l;)o[r++]=s[c++];else n||(o[r++]=s)}return o}function H(e){return function(){return!e.apply(this,arguments)}}function q(e,t){var n;return function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=null),n}}function z(e,t,n){t=F(t,n);for(var o,r=h(e),a=0,i=r.length;a<i;a++)if(t(e[o=r[a]],o,e))return o}function V(e){return function(t,n,o){n=F(n,o);for(var r=ot(t),a=e>0?0:r-1;a>=0&&a<r;a+=e)if(n(t[a],a,t))return a;return-1}}function G(e,t,n,o){for(var r=(n=F(n,o,1))(t),a=0,i=ot(e);a<i;){var s=Math.floor((a+i)/2);n(e[s])<r?a=s+1:i=s}return a}function U(e,t,n){return function(o,r,a){var i=0,c=ot(o);if("number"==typeof a)e>0?i=a>=0?a:Math.max(a+c,i):c=a>=0?Math.min(a+1,c):a+c+1;else if(n&&a&&c)return o[a=n(o,r)]===r?a:-1;if(r!=r)return(a=t(we.call(o,i,c),s))>=0?a+i:-1;for(a=e>0?i:c-1;a>=0&&a<c;a+=e)if(o[a]===r)return a;return-1}}function Z(e,t,n){var o=(jt(e)?Lt:z)(e,t,n);if(void 0!==o&&-1!==o)return e[o]}function J(e,t,n){var o,r;if(t=P(t,n),jt(e))for(o=0,r=e.length;o<r;o++)t(e[o],o,e);else{var a=h(e);for(o=0,r=a.length;o<r;o++)t(e[a[o]],a[o],e)}return e}function X(e,t,n){t=F(t,n);for(var o=!jt(e)&&h(e),r=(o||e).length,a=Array(r),i=0;i<r;i++){var s=o?o[i]:i;a[i]=t(e[s],s,e)}return a}function K(e){var t=function(t,n,o,r){var a=!jt(t)&&h(t),i=(a||t).length,s=e>0?0:i-1;for(r||(o=t[a?a[s]:s],s+=e);s>=0&&s<i;s+=e){var c=a?a[s]:s;o=n(o,t[c],c,t)}return o};return function(e,n,o,r){var a=arguments.length>=3;return t(e,P(n,r,4),o,a)}}function Q(e,t,n){var o=[];return t=F(t,n),J(e,(function(e,n,r){t(e,n,r)&&o.push(e)})),o}function ee(e,t,n){t=F(t,n);for(var o=!jt(e)&&h(e),r=(o||e).length,a=0;a<r;a++){var i=o?o[a]:a;if(!t(e[i],i,e))return!1}return!0}function te(e,t,n){t=F(t,n);for(var o=!jt(e)&&h(e),r=(o||e).length,a=0;a<r;a++){var i=o?o[a]:a;if(t(e[i],i,e))return!0}return!1}function ne(e,t,n,o){return jt(e)||(e=v(e)),("number"!=typeof n||o)&&(n=0),At(e,t,n)>=0}function oe(e,t){return X(e,D(t))}function re(e,t,n){var o,r,a=-1/0,i=-1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var s=0,c=(e=jt(e)?e:v(e)).length;s<c;s++)null!=(o=e[s])&&o>a&&(a=o);else t=F(t,n),J(e,(function(e,n,o){((r=t(e,n,o))>i||r===-1/0&&a===-1/0)&&(a=e,i=r)}));return a}function ae(e,t,n){if(null==t||n)return jt(e)||(e=v(e)),e[W(e.length-1)];var o=jt(e)?T(e):v(e),r=ot(o);t=Math.max(Math.min(t,r),0);for(var a=r-1,i=0;i<t;i++){var s=W(i,a),c=o[i];o[i]=o[s],o[s]=c}return o.slice(0,t)}function ie(e,t){return function(n,o,r){var a=t?[[],[]]:{};return o=F(o,r),J(n,(function(t,r){var i=o(t,r,n);e(a,t,i)})),a}}function se(e,t,n){return t in n}function ce(e,t,n){return we.call(e,0,Math.max(0,e.length-(null==t||n?1:t)))}function le(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[0]:ce(e,e.length-t)}function ue(e,t,n){return we.call(e,null==t||n?1:t)}function de(e,t,n,o){r(t)||(o=n,n=t,t=!1),null!=n&&(n=F(n,o));for(var a=[],i=[],s=0,c=ot(e);s<c;s++){var l=e[s],u=n?n(l,s,e):l;t&&!n?(s&&i===u||a.push(l),i=u):n?ne(i,u)||(i.push(u),a.push(l)):ne(a,l)||a.push(l)}return a}function he(e){for(var t=e&&re(e,ot).length||0,n=Array(t),o=0;o<t;o++)n[o]=oe(e,o);return n}function pe(e,t){return e._chain?f(t).chain():t}function fe(e){return J(x(e),(function(t){var n=f[t]=e[t];f.prototype[t]=function(){var e=[this._wrapped];return ve.apply(e,arguments),pe(this,n.apply(f,e))}})),f}var me="1.13.1",ge="object"==typeof self&&self.self===self&&self||"object"==typeof e&&e.global===e&&e||Function("return this")()||{},ye=Array.prototype,_e=Object.prototype,be="undefined"!=typeof Symbol?Symbol.prototype:null,ve=ye.push,we=ye.slice,xe=_e.toString,ke=_e.hasOwnProperty,$e="undefined"!=typeof ArrayBuffer,Te="undefined"!=typeof DataView,Ce=Array.isArray,Oe=Object.keys,Se=Object.create,Me=$e&&ArrayBuffer.isView,je=isNaN,Ee=isFinite,De=!{toString:null}.propertyIsEnumerable("toString"),Pe=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],Ne=Math.pow(2,53)-1,Le=a("String"),Fe=a("Number"),Ae=a("Date"),We=a("RegExp"),Ie=a("Error"),Be=a("Symbol"),Ye=a("ArrayBuffer"),Re=a("Function"),He=ge.document&&ge.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof He&&(Re=function(e){return"function"==typeof e||!1});var qe=Re,ze=a("Object"),Ve=Te&&ze(new DataView(new ArrayBuffer(8))),Ge="undefined"!=typeof Map&&ze(new Map),Ue=a("DataView"),Ze=Ve?function(e){return null!=e&&qe(e.getInt8)&&Ye(e.buffer)}:Ue,Je=Ce||a("Array"),Xe=a("Arguments");!function(){Xe(arguments)||(Xe=function(e){return i(e,"callee")})}();var Ke=Xe,Qe=u("byteLength"),et=l(Qe),tt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,nt=$e?function(e){return Me?Me(e)&&!Ze(e):et(e)&&tt.test(xe.call(e))}:c(!1),ot=u("length");f.VERSION=me,f.prototype.value=function(){return this._wrapped},f.prototype.valueOf=f.prototype.toJSON=f.prototype.value,f.prototype.toString=function(){return String(this._wrapped)};var rt="[object DataView]",at="forEach",it=["clear","delete"],st=["get","has","set"],ct=it.concat(at,st),lt=it.concat(st),ut=["add"].concat(it,at,"has"),dt=Ge?b(ct):a("Map"),ht=Ge?b(lt):a("WeakMap"),pt=Ge?b(ut):a("Set"),ft=a("WeakSet"),mt=k(_),gt=k(h),yt=k(_,!0);f.toPath=C,f.iteratee=L;var _t=Date.now||function(){return(new Date).getTime()},bt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},vt=I(bt),wt=I(w(bt)),xt=f.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},kt=/(.)^/,$t={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Tt=/\\|'|\r|\n|\u2028|\u2029/g,Ct=/^\s*(\w|\$)+\s*$/,Ot=0,St=t((function(e,t){var n=St.placeholder,o=function(){for(var r=0,a=t.length,i=Array(a),s=0;s<a;s++)i[s]=t[s]===n?arguments[r++]:t[s];for(;r<arguments.length;)i.push(arguments[r++]);return Y(e,o,this,this,i)};return o}));St.placeholder=f;var Mt=t((function(e,n,o){if(!qe(e))throw new TypeError("Bind must be called on a function");var r=t((function(t){return Y(e,r,n,this,o.concat(t))}));return r})),jt=l(ot),Et=t((function(e,t){var n=(t=R(t,!1,!1)).length;if(n<1)throw new Error("bindAll must be passed function names");for(;n--;){var o=t[n];e[o]=Mt(e[o],e)}return e})),Dt=t((function(e,t,n){return setTimeout((function(){return e.apply(null,n)}),t)})),Pt=St(Dt,f,1),Nt=St(q,2),Lt=V(1),Ft=V(-1),At=U(1,Lt,G),Wt=U(-1,Ft),It=K(1),Bt=K(-1),Yt=t((function(e,t,n){var o,r;return qe(t)?r=t:(t=O(t),o=t.slice(0,-1),t=t[t.length-1]),X(e,(function(e){var a=r;if(!a){if(o&&o.length&&(e=S(e,o)),null==e)return;a=e[t]}return null==a?a:a.apply(e,n)}))})),Rt=ie((function(e,t,n){i(e,n)?e[n].push(t):e[n]=[t]})),Ht=ie((function(e,t,n){e[n]=t})),qt=ie((function(e,t,n){i(e,n)?e[n]++:e[n]=1})),zt=ie((function(e,t,n){e[n?0:1].push(t)}),!0),Vt=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g,Gt=t((function(e,t){var n={},o=t[0];if(null==e)return n;qe(o)?(t.length>1&&(o=P(o,t[1])),t=_(e)):(o=se,t=R(t,!1,!1),e=Object(e));for(var r=0,a=t.length;r<a;r++){var i=t[r],s=e[i];o(s,i,e)&&(n[i]=s)}return n})),Ut=t((function(e,t){var n,o=t[0];return qe(o)?(o=H(o),t.length>1&&(n=t[1])):(t=X(R(t,!1,!1),String),o=function(e,n){return!ne(t,n)}),Gt(e,o,n)})),Zt=t((function(e,t){return t=R(t,!0,!0),Q(e,(function(e){return!ne(t,e)}))})),Jt=t((function(e,t){return Zt(e,t)})),Xt=t((function(e){return de(R(e,!0,!0))})),Kt=t(he);J(["pop","push","reverse","shift","sort","splice","unshift"],(function(e){var t=ye[e];f.prototype[e]=function(){var n=this._wrapped;return null!=n&&(t.apply(n,arguments),"shift"!==e&&"splice"!==e||0!==n.length||delete n[0]),pe(this,n)}})),J(["concat","join","slice"],(function(e){var t=ye[e];f.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),pe(this,e)}}));var Qt={__proto__:null,VERSION:me,restArguments:t,isObject:n,isNull:function(e){return null===e},isUndefined:o,isBoolean:r,isElement:function(e){return!(!e||1!==e.nodeType)},isString:Le,isNumber:Fe,isDate:Ae,isRegExp:We,isError:Ie,isSymbol:Be,isArrayBuffer:Ye,isDataView:Ze,isArray:Je,isFunction:qe,isArguments:Ke,isFinite:function(e){return!Be(e)&&Ee(e)&&!isNaN(parseFloat(e))},isNaN:s,isTypedArray:nt,isEmpty:function(e){if(null==e)return!0;var t=ot(e);return"number"==typeof t&&(Je(e)||Le(e)||Ke(e))?0===t:0===ot(h(e))},isMatch:p,isEqual:function(e,t){return g(e,t)},isMap:dt,isWeakMap:ht,isSet:pt,isWeakSet:ft,keys:h,allKeys:_,values:v,pairs:function(e){for(var t=h(e),n=t.length,o=Array(n),r=0;r<n;r++)o[r]=[t[r],e[t[r]]];return o},invert:w,functions:x,methods:x,extend:mt,extendOwn:gt,assign:gt,defaults:yt,create:function(e,t){var n=$(e);return t&&gt(n,t),n},clone:T,tap:function(e,t){return t(e),e},get:M,has:function(e,t){for(var n=(t=O(t)).length,o=0;o<n;o++){var r=t[o];if(!i(e,r))return!1;e=e[r]}return!!n},mapObject:function(e,t,n){t=F(t,n);for(var o=h(e),r=o.length,a={},i=0;i<r;i++){var s=o[i];a[s]=t(e[s],s,e)}return a},identity:j,constant:c,noop:A,toPath:C,property:D,propertyOf:function(e){return null==e?A:function(t){return M(e,t)}},matcher:E,matches:E,times:function(e,t,n){var o=Array(Math.max(0,e));t=P(t,n,1);for(var r=0;r<e;r++)o[r]=t(r);return o},random:W,now:_t,escape:vt,unescape:wt,templateSettings:xt,template:function(e,t,n){!t&&n&&(t=n),t=yt({},t,f.templateSettings);var o=RegExp([(t.escape||kt).source,(t.interpolate||kt).source,(t.evaluate||kt).source].join("|")+"|$","g"),r=0,a="__p+='";e.replace(o,(function(t,n,o,i,s){return a+=e.slice(r,s).replace(Tt,B),r=s+t.length,n?a+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":o?a+="'+\n((__t=("+o+"))==null?'':__t)+\n'":i&&(a+="';\n"+i+"\n__p+='"),t})),a+="';\n";var i,s=t.variable;if(s){if(!Ct.test(s))throw new Error("variable is not a bare identifier: "+s)}else a="with(obj||{}){\n"+a+"}\n",s="obj";a="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+a+"return __p;\n";try{i=new Function(s,"_",a)}catch(e){throw e.source=a,e}var c=function(e){return i.call(this,e,f)};return c.source="function("+s+"){\n"+a+"}",c},result:function(e,t,n){var o=(t=O(t)).length;if(!o)return qe(n)?n.call(e):n;for(var r=0;r<o;r++){var a=null==e?void 0:e[t[r]];void 0===a&&(a=n,r=o),e=qe(a)?a.call(e):a}return e},uniqueId:function(e){var t=++Ot+"";return e?e+t:t},chain:function(e){var t=f(e);return t._chain=!0,t},iteratee:L,partial:St,bind:Mt,bindAll:Et,memoize:function(e,t){var n=function(o){var r=n.cache,a=""+(t?t.apply(this,arguments):o);return i(r,a)||(r[a]=e.apply(this,arguments)),r[a]};return n.cache={},n},delay:Dt,defer:Pt,throttle:function(e,t,n){var o,r,a,i,s=0;n||(n={});var c=function(){s=!1===n.leading?0:_t(),o=null,i=e.apply(r,a),o||(r=a=null)},l=function(){var l=_t();s||!1!==n.leading||(s=l);var u=t-(l-s);return r=this,a=arguments,u<=0||u>t?(o&&(clearTimeout(o),o=null),s=l,i=e.apply(r,a),o||(r=a=null)):o||!1===n.trailing||(o=setTimeout(c,u)),i};return l.cancel=function(){clearTimeout(o),s=0,o=r=a=null},l},debounce:function(e,n,o){var r,a,i,s,c,l=function(){var t=_t()-a;n>t?r=setTimeout(l,n-t):(r=null,o||(s=e.apply(c,i)),r||(i=c=null))},u=t((function(t){return c=this,i=t,a=_t(),r||(r=setTimeout(l,n),o&&(s=e.apply(c,i))),s}));return u.cancel=function(){clearTimeout(r),r=i=c=null},u},wrap:function(e,t){return St(t,e)},negate:H,compose:function(){var e=arguments,t=e.length-1;return function(){for(var n=t,o=e[t].apply(this,arguments);n--;)o=e[n].call(this,o);return o}},after:function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},before:q,once:Nt,findKey:z,findIndex:Lt,findLastIndex:Ft,sortedIndex:G,indexOf:At,lastIndexOf:Wt,find:Z,detect:Z,findWhere:function(e,t){return Z(e,E(t))},each:J,forEach:J,map:X,collect:X,reduce:It,foldl:It,inject:It,reduceRight:Bt,foldr:Bt,filter:Q,select:Q,reject:function(e,t,n){return Q(e,H(F(t)),n)},every:ee,all:ee,some:te,any:te,contains:ne,includes:ne,include:ne,invoke:Yt,pluck:oe,where:function(e,t){return Q(e,E(t))},max:re,min:function(e,t,n){var o,r,a=1/0,i=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e)for(var s=0,c=(e=jt(e)?e:v(e)).length;s<c;s++)null!=(o=e[s])&&o<a&&(a=o);else t=F(t,n),J(e,(function(e,n,o){((r=t(e,n,o))<i||r===1/0&&a===1/0)&&(a=e,i=r)}));return a},shuffle:function(e){return ae(e,1/0)},sample:ae,sortBy:function(e,t,n){var o=0;return t=F(t,n),oe(X(e,(function(e,n,r){return{value:e,index:o++,criteria:t(e,n,r)}})).sort((function(e,t){var n=e.criteria,o=t.criteria;if(n!==o){if(n>o||void 0===n)return 1;if(n<o||void 0===o)return-1}return e.index-t.index})),"value")},groupBy:Rt,indexBy:Ht,countBy:qt,partition:zt,toArray:function(e){return e?Je(e)?we.call(e):Le(e)?e.match(Vt):jt(e)?X(e,j):v(e):[]},size:function(e){return null==e?0:jt(e)?e.length:h(e).length},pick:Gt,omit:Ut,first:le,head:le,take:le,initial:ce,last:function(e,t,n){return null==e||e.length<1?null==t||n?void 0:[]:null==t||n?e[e.length-1]:ue(e,Math.max(0,e.length-t))},rest:ue,tail:ue,drop:ue,compact:function(e){return Q(e,Boolean)},flatten:function(e,t){return R(e,t,!1)},without:Jt,uniq:de,unique:de,union:Xt,intersection:function(e){for(var t=[],n=arguments.length,o=0,r=ot(e);o<r;o++){var a=e[o];if(!ne(t,a)){var i;for(i=1;i<n&&ne(arguments[i],a);i++);i===n&&t.push(a)}}return t},difference:Zt,unzip:he,transpose:he,zip:Kt,object:function(e,t){for(var n={},o=0,r=ot(e);o<r;o++)t?n[e[o]]=t[o]:n[e[o][0]]=e[o][1];return n},range:function(e,t,n){null==t&&(t=e||0,e=0),n||(n=t<e?-1:1);for(var o=Math.max(Math.ceil((t-e)/n),0),r=Array(o),a=0;a<o;a++,e+=n)r[a]=e;return r},chunk:function(e,t){if(null==t||t<1)return[];for(var n=[],o=0,r=e.length;o<r;)n.push(we.call(e,o,o+=t));return n},mixin:fe,default:f},en=fe(Qt);return en._=en,en}))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],7:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../core/Type"),i=e("../timeseries/TimeSeriesData"),s=e("../core/TimeGrid"),c=e("../crosshair/Crosshair"),l={width:"auto",intervalWidth:7,paddingRight:70,offset:0,relativeOffset:0,offsetFromEnd:!1,scrollToEndOnLoad:!0,scrollToEndOnResize:!0,verticalGridLineSpacing:50},u=function(e){function t(e,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),n=r.extend({},l,n);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return o._el=e,o._components=[],o._data=void 0,r.isNumber(o.width)&&(o._el.style.width=o.width+"px"),o._initCrosshair(),o._listenForDOMEvents(),o._time_grid=new s,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"_initCrosshair",value:function(){this.crosshair&&(this.crosshair=r.isObject(this.crosshair)?this.crosshair:{},this._crosshair=new c(this,this.crosshair))}},{key:"_refreshCrosshair",value:function(){void 0===this._crosshair?this._initCrosshair():this._crosshair.refresh()}},{key:"_listenForDOMEvents",value:function(){window.addEventListener("resize",this._handleWindowResize.bind(this))}},{key:"_handleWindowResize",value:function(e){"auto"===this.width&&(this._refreshCrosshair(),!0===this.scrollToEndOnResize&&this._setOffset(0,!0),this._refreshCrosshair(),this.draw())}},{key:"getEl",value:function(){return this._el}},{key:"getWidth",value:function(){return"auto"===this.width?this.getEl().clientWidth:this.width}},{key:"getPaddingRight",value:function(){return this.paddingRight}},{key:"getDrawingWidth",value:function(){return this.getWidth()-this.getPaddingRight()}},{key:"getHeight",value:function(){return this._el.offsetHeight}},{key:"setIntervalWidth",value:function(e){this.intervalWidth=e}},{key:"getIntervalWidth",value:function(){return this.intervalWidth}},{key:"getOffset",value:function(){return this.offset}},{key:"getTimeGrid",value:function(){return this._time_grid}},{key:"getComponents",value:function(){return this._components}},{key:"addComponent",value:function(e,t){t.setParentChart(this),t.initLayers&&t.initLayers(),this._components.push(t),t.render(e),this._componentsHaveChanged()}},{key:"removeComponents",value:function(e){e=e||[];for(var t=0;t<this._components.length;t++){for(var n=this._components[t],o=!1,r=0;r<e.length;r++)if(n===e[r]){o=!0;break}!0!==o&&n.destroy()}this._components=e,this._componentsHaveChanged()}},{key:"loadData",value:function(e,t,n,o){this._data=new i(e,this.fieldMap,t,n);for(var r=0;r<this._components.length;r++){var a=this._components[r];a.precompute&&a.precompute(this._data)}void 0!==o&&!0!==o||(!0===this.scrollToEndOnLoad&&this.scroll(0,!0,!1),this.draw())}},{key:"draw",value:function(){if(void 0!==this._data){var e=this._calculateIntervalCapacity(),t=this.getIndexToPixelMapper();this._time_grid.refresh(this._data,e,this.getOffset(),this.getDrawingWidth(),this.verticalGridLineSpacing);for(var n=0;n<this._components.length;n++){var o=this._components[n];o.draw&&o.draw(this._data,e,this.getOffset(),t)}this.emit("afterdraw")}}},{key:"_calculateIntervalCapacity",value:function(){return Math.floor(this.getDrawingWidth()/this.intervalWidth)}},{key:"getIndexToPixelMapper",value:function(){var e=this.getIntervalWidth(),t=this.getOffset();return function(n){return(n-t)*e}}},{key:"_componentsHaveChanged",value:function(){this._refreshCrosshair()}},{key:"scroll",value:function(e,t,n){this._setOffset(e,t),void 0!==n&&!0!==n||this.draw()}},{key:"_setOffset",value:function(e,t){if(this.relativeOffset=e,this.offsetFromEnd=t,!0===t&&void 0!==this._data){var n=this._data.getRawData().length,o=this._calculateIntervalCapacity();this.offset=n-o-e}else this.offset=e}},{key:"getRelativeScrollOffset",value:function(){return this.relativeOffset}},{key:"isScrollOffsetFromEnd",value:function(){return this.offsetFromEnd}},{key:"isBeyondStart",value:function(){return this.offset<0}}]),t}(a);t.exports=u},{"../core/TimeGrid":10,"../core/Type":11,"../crosshair/Crosshair":13,"../timeseries/TimeSeriesData":42,underscore:6}],8:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("../core/Type"),a=e("../core/Region"),i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.layers=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"destroy",value:function(){var e=this.getEl();e&&e.parentNode&&e.parentNode.removeChild(e),this.el=void 0}},{key:"setParentChart",value:function(e){this._parent_chart=e}},{key:"getParentChart",value:function(){return this._parent_chart}},{key:"getEl",value:function(){return this.el}},{key:"getClassName",value:function(){return"component"}},{key:"getHeight",value:function(){return this.height}},{key:"render",value:function(e){var t=a.getRegionsByName(this.getParentChart().getEl())[e];return this.el=this.createElement(),t.getEl().innerHTML="",t.getEl().appendChild(this.el),this}},{key:"createElement",value:function(){var e=window.document.createElement("DIV");return e.className=this.getClassName(),e.style.height=this.height+"px",e}},{key:"addLayer",value:function(e){e.setParentComponent(this),this.layers.push(e)}},{key:"getAllLayers",value:function(){return this.layers}},{key:"removeLayers",value:function(e){e=e||[],this.layers=e,this._layersHaveChanged()}},{key:"_layersHaveChanged",value:function(){}}]),t}(r);t.exports=i},{"../core/Region":9,"../core/Type":11}],9:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return n.el=e,n.name=n.el.getAttribute("data-name"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"getEl",value:function(){return this.el}},{key:"getName",value:function(){return this.name}},{key:"getHeight",value:function(){return this.el.offsetHeight}}],[{key:"getRegionsByName",value:function(e){for(var n={},o=t.getElementsByClassName(e,"region"),r=0;r<o.length;r++){var a=new t(o[r]);n[a.getName()]=a}return n}},{key:"getElementsByClassName",value:function(e,t){var n=[];return function e(o){for(var r=0;r<o.childNodes.length;r++){var a=o.childNodes[r];a.childNodes.length>0&&e(a),a.getAttribute&&a.getAttribute("class")&&a.getAttribute("class").split(" ").indexOf(t)>=0&&n.push(a)}}(e),n}}]),t}(e("../core/Type"));t.exports=r},{"../core/Type":11}],10:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("moment"),i=e("../core/Type"),s={M1:{ident:"M1",hours:1/60,mins:1},M5:{ident:"M5",hours:1/12,mins:5},M10:{ident:"M10",hours:1/6,mins:10},M15:{ident:"M15",hours:.25,mins:15},M30:{ident:"M30",hours:.5,mins:30},H1:{ident:"H1",hours:1,mins:60},H4:{ident:"H4",hours:4,mins:240},H8:{ident:"H8",hours:8,mins:480},D:{ident:"D",hours:24,mins:1440,days:1},W:{ident:"W",hours:120,mins:7200,days:5,weeks:1},M:{ident:"M",hours:504,mins:30240,days:21,weeks:4,months:1},Q:{ident:"Q",hours:1512,mins:90720,days:63,weeks:13,months:3},Y:{ident:"Y",hours:6e3,mins:36e4,days:250,weeks:51,months:12,years:1}},c={},l=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=r.extend({},c,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.lines={},n._pixelToTimeString=function(){return""},n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"refresh",value:function(e,n,o,r,a){this.lines={},this.line_spacing=a;var i=e.getFieldMap(),s=e.getRawData(),c=e.getGranularity(),l=this.granularity;void 0===l&&(l=t.determineTimeGranularity(c,n,r,a));for(var u=o>=0?o+1:1;u<o+n&&u<s.length;u++){var d=s[u],h=s[u-1],p=d[i.time],f=h[i.time],m=t.isGridLine(l,p,f);null!==m&&(this.lines[""+u]=m)}this._pixelToTimeString=this.getPixelToTimeStringMapper(r,n,o,s,c,i.time)}},{key:"getPixelToTimeStringMapper",value:function(e,t,n,o,r,i){var s="ddd D HH:mm";"D"!==r&&"W"!==r||(s="ddd D MMM");return function(r){var c=Math.round(r/e*t)+1,l=o[n+c];return l?a(l[i]).format(s):""}}},{key:"lineAt",value:function(e){return this.lines[""+e]}},{key:"getLineSpacing",value:function(){return this.line_spacing}},{key:"pixelToTimeString",value:function(e){return this._pixelToTimeString(e)}}],[{key:"isGridLine",value:function(e,n,o){var r=s[e],a=new Date(n),i=new Date(o);return r.mins<60&&t.isNMinuteChange(r.mins,a)?{format:t.determineMinFormat(a,i)}:r.hours<24&&t.isNHourChange(r.hours,a)?{format:t.determineHourFormat(a,i)}:void 0!==r.days&&r.days<5&&t.isDayChange(a,i)?{format:t.determineDayFormat(a,i)}:void 0!==r.weeks&&1===r.weeks&&t.isWeekChange(a,i)?{format:t.determineWeekFormat(a,i)}:void 0!==r.months&&1===r.months&&t.isMonthChange(a,i)?{format:t.determineMonthFormat(a,i)}:void 0!==r.months&&r.months<12&&t.isNMonthChange(r.months,a,i)?{format:t.determineQuarterFormat(a,i)}:t.isYearChange(a,i)?{format:t.determineYearFormat(a,i)}:null}},{key:"isNMinuteChange",value:function(e,t){return t.getUTCMinutes()%e==0}},{key:"isHourChange",value:function(e,t){return e.getUTCHours()!==t.getUTCHours()}},{key:"isNHourChange",value:function(e,t){return t.getUTCHours()%e==0&&0===t.getUTCMinutes()}},{key:"isDayChange",value:function(e,t){return e.getUTCDate()!==t.getUTCDate()}},{key:"isWeekChange",value:function(e,t){return a(e).utc().weeks()!==a(t).utc().weeks()}},{key:"isMonthChange",value:function(e,t){return e.getUTCMonth()!==t.getUTCMonth()}},{key:"isNMonthChange",value:function(e,n,o){return n.getUTCMonth()%e==0&&t.isMonthChange(n,o)}},{key:"isYearChange",value:function(e,t){return e.getUTCFullYear()!==t.getUTCFullYear()}},{key:"determineMinFormat",value:function(e,n){return t.isDayChange(e,n)?"ddd D":(t.isHourChange(e,n),"HH:mm")}},{key:"determineHourFormat",value:function(e,n){return t.isDayChange(e,n)?"ddd D":"HH:mm"}},{key:"determineDayFormat",value:function(e,n){return t.isMonthChange(e,n)?"MMM":"D"}},{key:"determineWeekFormat",value:function(e,n){return t.isMonthChange(e,n)?"MMM":"D"}},{key:"determineMonthFormat",value:function(e,n){return t.isYearChange(e,n)?"YYYY":"MMM"}},{key:"determineQuarterFormat",value:function(e,n){return t.isYearChange(e,n)?"YYYY":"MMM"}},{key:"determineYearFormat",value:function(e,t){return"'YY"}},{key:"determineTimeGranularity",value:function(e,t,n,o){var r=n/o,a=t*s[e].mins/r;for(var i in s)if(s[i].mins>=a)return i;return"Y"}}]),t}(i);t.exports=l},{"../core/Type":11,moment:4,underscore:6}],11:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._config=e,r.extend(n,e),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"getConfig",value:function(){return this._config}}]),t}(e("events").EventEmitter);t.exports=a},{events:2,underscore:6}],12:[function(e,t,n){"use strict";t.exports=function(e){var t=e.getContext("2d"),n=window.devicePixelRatio||1,o=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1,r=n/o;if(n!==o){var a=e.width,i=e.height;e.width=a*r,e.height=i*r,e.style.width=a+"px",e.style.height=i+"px",t.scale(r,r)}return e}},{}],13:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../core/Type"),i=e("../crosshair/CrosshairZone"),s={lineColor:"#000000",labelHeight:16,showTimeLabel:!1,labelFont:"7pt normal normal arial;",labelBgColor:"#000000",labelColor:"#FFFFFF",timeLabelWidth:70,valuePrecision:8},c=function(e){function t(e,n){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),n=r.extend({},s,n);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n));return o._crosshair_zones={},o._parent_chart=e,o.width=o.getParentChart().getWidth(),o.lineWidth=o.getParentChart().getDrawingWidth(),o.valueLabelWidth=o.width-o.lineWidth,o._render(),o._listenForDOMEvents(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"destroy",value:function(){for(var e in this._crosshair_zones)if(this._crosshair_zones.hasOwnProperty(e)){var t=this._crosshair_zones[e].getEl();t&&t.parentNode&&t.parentNode.removeChild(t)}}},{key:"getParentChart",value:function(){return this._parent_chart}},{key:"_render",value:function(){this.destroy();for(var e=this.getParentChart().getComponents(),t=0;t<e.length;t++){var n=new i(this,e[t]);this._crosshair_zones[""+t]=n,n.render(t)}}},{key:"_listenForDOMEvents",value:function(){this.getParentChart().getEl().addEventListener("mousemove",this._handleMousemove.bind(this)),this.getParentChart().getEl().addEventListener("mouseout",this._handleMouseout.bind(this))}},{key:"_handleMousemove",value:function(e){var t=e.target.getAttribute("ch-zone-index"),n=this._crosshair_zones[t];this._draw(e.offsetX,e.offsetY,n,this._crosshair_zones)}},{key:"_handleMouseout",value:function(e){this.clear()}},{key:"refresh",value:function(){this.width=this.getParentChart().getWidth(),this.lineWidth=this.getParentChart().getDrawingWidth(),this.valueLabelWidth=this.width-this.lineWidth,this._render()}},{key:"_draw",value:function(e,t,n,o){if(n)for(var r in o)if(o.hasOwnProperty(r)){var a=o[r].getComponent(),i=o[r].getEl(),s=i.getContext("2d");if(s.clearRect(0,0,i.width,i.height),s.beginPath(),s.rect(e,0,1,i.height),s.fillStyle=this.lineColor,s.fill(),a.crosshair&&a.crosshair.time&&a.crosshair.time.label){s.beginPath(),s.rect(e,0,this.timeLabelWidth,this.labelHeight),s.fillStyle=this.labelBgColor,s.fill();var c=this.getParentChart().getTimeGrid().pixelToTimeString(e);s.font=this.labelFont,s.textAlign="left",s.textBaseline="middle",s.fillStyle=this.labelColor,s.fillText(c,e+4,.5*this.labelHeight)}if(o[r]===n&&(void 0===a.crosshair||a.crosshair.value)){s.beginPath(),s.rect(0,t,this.lineWidth,1),s.fillStyle=this.lineColor,s.fill(),s.beginPath(),s.rect(this.lineWidth,t-.5*this.labelHeight,this.valueLabelWidth,this.labelHeight),s.fillStyle=this.labelBgColor,s.fill();var l=""+a.pixelToValue(t).toFixed(this.valuePrecision);s.font=this.labelFont,s.textAlign="left",s.textBaseline="middle",s.fillStyle=this.labelColor,s.fillText(l,this.lineWidth+4,t)}}}},{key:"clear",value:function(){for(var e in this._crosshair_zones)if(this._crosshair_zones.hasOwnProperty(e)){var t=this._crosshair_zones[e].getEl();t&&t.getContext("2d").clearRect(0,0,t.width,t.height)}}}]),t}(a);t.exports=c},{"../core/Type":11,"../crosshair/CrosshairZone":14,underscore:6}],14:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("../core/Type"),a=e("../core/adjustCanvas"),i=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return o._parent_crosshair=e,o._underlying_component=n,o.name="crosshair-"+o._underlying_component.getClassName().replace(/ /g,""),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"render",value:function(e){var t=this._underlying_component,n=t.getEl().parentNode,o=window.document.createElement("CANVAS");return o.className="crosshair "+this.name,o.setAttribute("ch-zone-index",""+e),o.setAttribute("width",t.getWidth()),o.setAttribute("height",t.getHeight()),a(o),this._el=o,n.appendChild(o),o}},{key:"getEl",value:function(){return this._el}},{key:"getComponent",value:function(){return this._underlying_component}}]),t}(r);t.exports=i},{"../core/Type":11,"../core/adjustCanvas":12}],15:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o,r,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var i=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return i.layer=e,i.index=n,i.time=o,i.value=r,i.previous_arc=a,i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){if(this.previous_arc){var r=n(this.previous_arc.getIndex()),a=t(this.previous_arc.getValue()),i=n(this.index),s=t(this.value);e.beginPath(),e.moveTo(r,a),e.lineTo(i,s),e.strokeStyle=o.color,e.stroke()}}},{key:"getIndex",value:function(){return this.index}},{key:"getTime",value:function(){return this.time}},{key:"getValue",value:function(){return this.value}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],16:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o,r,a,i,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return c.layer=e,c.index=n,c.time=o,c.open=r,c.high=a,c.low=i,c.close=s,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){var r,a,i;this.close===this.open?(r=this.open,a=this.close,i=o.wickColor):this.close>this.open?(r=this.open,a=this.close,i=o.bullBodyColor):(r=this.close,a=this.open,i=o.bearBodyColor);var s=n(this.index),c=o.candleWickWidth,l=t(this.high),u=t(a)-l;e.beginPath(),e.rect(s,l,c,u),e.fillStyle=o.wickColor,e.fill(),l=t(r),u=t(this.low)-l,e.beginPath(),e.rect(s,l,c,u),e.fillStyle=o.wickColor,e.fill();var d=s-Math.ceil(.5*(o.candleBodyWidth-1)),h=t(a),p=o.candleBodyWidth,f=t(r)-h+1;e.beginPath(),e.rect(d,h,p,f),e.fillStyle=i,e.fill()}},{key:"getIndex",value:function(){return this.index}},{key:"getTime",value:function(){return this.time}},{key:"getOpen",value:function(){return this.open}},{key:"getHigh",value:function(){return this.high}},{key:"getLow",value:function(){return this.low}},{key:"getClose",value:function(){return this.close}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],17:[function(e,t,n){"use strict";var o=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(e("../core/Type"));t.exports=o},{"../core/Type":11}],18:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return a.layer=e,a.index=n,a.time=o,a.value=r,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){var r=n(this.index)-Math.ceil(.5*(o.barWidth-1)),a=t(this.value),i=o.barWidth,s=t(0)-a;s<o.minHeightPx&&(s=o.minHeightPx),e.beginPath(),e.rect(r,a,i,s),e.fillStyle=o.barColor,e.fill()}},{key:"getIndex",value:function(){return this.index}},{key:"getTime",value:function(){return this.time}},{key:"getValue",value:function(){return this.value}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],19:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return a.layer=e,a.value=n,a.start=o,a.end=r,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){var r=t(this.value);e.beginPath(),e.moveTo(this.start,r),e.lineTo(this.end,r),e.strokeStyle=o.lineColor,e.stroke()}},{key:"getValue",value:function(){return this.value}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],20:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o,r,a,i,s){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return c.layer=e,c.index=n,c.time=o,c.open=r,c.high=a,c.low=i,c.close=s,c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){var r;r=this.close>=this.open?o.bullBodyColor:o.bearBodyColor;var a=n(this.index),i=Math.floor(.5*o.candleBodyWidth)||1,s=t(this.high),c=t(this.low)-t(this.high);e.beginPath(),e.rect(a,s,i,c),e.fillStyle=r,e.fill();var l=a-o.candleBodyWidth+1,u=t(this.open),d=o.candleBodyWidth;e.beginPath(),e.rect(l,u,d,1),e.fillStyle=r,e.fill();var h=a,p=t(this.close),f=o.candleBodyWidth;e.beginPath(),e.rect(h,p,f,1),e.fillStyle=r,e.fill()}},{key:"getIndex",value:function(){return this.index}},{key:"getTime",value:function(){return this.time}},{key:"getOpen",value:function(){return this.open}},{key:"getHigh",value:function(){return this.high}},{key:"getLow",value:function(){return this.low}},{key:"getClose",value:function(){return this.close}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],21:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("moment"),a=function(e){function t(e,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return a.layer=e,a.index=n,a.time=o,a.format=r,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,n,o){var r=n(this.index);e.font=o.labelFont,e.textAlign="left",e.textBaseline="middle",e.fillStyle=o.labelColor,e.fillText(t.formatTimestamp(this.time,this.format),r,o.labelY)}},{key:"getIndex",value:function(){return this.index}},{key:"getTime",value:function(){return this.time}}],[{key:"formatTimestamp",value:function(e,t){return r(e).format(t)}}]),t}(e("../element/Element"));t.exports=a},{"../element/Element":17,moment:4}],22:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return r.layer=e,r.value=n,r.x=o,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){var r=this.x+o.labelPaddingLeft,a=t(this.value),i=""+this.value;e.font=o.labelFont,e.textBaseline="middle",e.fillStyle=o.labelColor,e.fillText(i,r,a)}},{key:"getValue",value:function(){return this.value}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],23:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(e){function t(e,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{}));return a.layer=e,a.index=n,a.start=o,a.end=r,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o){var r=n(this.index);e.beginPath(),e.moveTo(r,this.start),e.lineTo(r,this.end),e.strokeStyle=o.lineColor,e.stroke()}},{key:"getIndex",value:function(){return this.index}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}]),t}(e("../element/Element"));t.exports=r},{"../element/Element":17}],24:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../layer/Layer"),i=e("../element/Candle"),s={bearBodyColor:"red",bullBodyColor:"green",wickColor:"black",candleBodyWidth:5,candleWickWidth:1,extField:"ext",minField:"low",maxField:"high"},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e||{}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"setCandleBodyWidth",value:function(e){this.candleBodyWidth=e}},{key:"getCandleBodyWidth",value:function(){return this.candleBodyWidth}},{key:"setBearBodyColor",value:function(e){this.bearBodyColor=e}},{key:"getBearBodyColor",value:function(){return this.bearBodyColor}},{key:"setBullBodyColor",value:function(e){this.bullBodyColor=e}},{key:"getBullBodyColor",value:function(){return this.bullBodyColor}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=n>=0?n:0;l<n+t&&l<c.length;l++){var u=c[l],d=new i(this,l,u[s.time],u[s.open],u[s.high],u[s.low],u[s.close]);d.draw(a,o,r,this),this.elements.push(d)}}}]),t}(a);t.exports=c},{"../element/Candle":16,"../layer/Layer":25,underscore:6}],25:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../core/Type"),i={},s=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=r.extend({},i,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.elements=[],n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"setParentComponent",value:function(e){this._parent_component=e}},{key:"getParentComponent",value:function(){return this._parent_component}},{key:"_getContext",value:function(){return this.getParentComponent().getContext()}},{key:"getWidth",value:function(){return this.getParentComponent().getWidth()}},{key:"getDrawingWidth",value:function(){return this.getParentComponent().getDrawingWidth()}},{key:"getHeight",value:function(){return this.getParentComponent().getHeight()}},{key:"getExtField",value:function(){return this.extField}},{key:"getMinField",value:function(){return this.minField}},{key:"getMaxField",value:function(){return this.maxField}},{key:"getMinValue",value:function(){return this.minValue}},{key:"getMaxValue",value:function(){return this.maxValue}}]),t}(a);t.exports=s},{"../core/Type":11,underscore:6}],26:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../layer/Layer"),i=e("../element/OHLCBar"),s={bearBodyColor:"red",bullBodyColor:"green",wickColor:"black",candleBodyWidth:3,candleWickWidth:1,minField:"low",maxField:"high"},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e||{}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"setCandleBodyWidth",value:function(e){this.candleBodyWidth=e}},{key:"getCandleBodyWidth",value:function(){return this.candleBodyWidth}},{key:"setBearBodyColor",value:function(e){this.bearBodyColor=e}},{key:"getBearBodyColor",value:function(){return this.bearBodyColor}},{key:"setBullBodyColor",value:function(e){this.bullBodyColor=e}},{key:"getBullBodyColor",value:function(){return this.bullBodyColor}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=n>=0?n:0;l<n+t&&l<c.length;l++){var u=c[l],d=new i(this,l,u[s.time],u[s.open],u[s.high],u[s.low],u[s.close]);d.draw(a,o,r,this),this.elements.push(d)}}}]),t}(a);t.exports=c},{"../element/OHLCBar":20,"../layer/Layer":25,underscore:6}],27:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../layer/Layer"),i=e("../element/VerticalLine"),s={lineColor:"#ebebeb",showLabels:!0,labelColor:"#555555",labelFont:"7pt normal normal arial;"},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"getLineStart",value:function(){return 0}},{key:"getLineEnd",value:function(){return this.getHeight()}},{key:"draw",value:function(e,t,n,o,r,a){var s=this._getContext(),c=e.getRawData();this.elements=[];for(var l=n>=0?n:0;l<n+t&&l<c.length;l++)if(void 0!==this.timeGrid.lineAt(l)){var u=new i(this,l,this.getLineStart(),this.getLineEnd());this.elements.push(u),u.draw(s,o,r,this)}}}]),t}(a);t.exports=c},{"../element/VerticalLine":23,"../layer/Layer":25,underscore:6}],28:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../layer/Layer"),i=e("../element/TimeLabel"),s={labelColor:"#444444",labelFont:"7pt normal normal arial;",labelY:8},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o,r,a){var s=this._getContext(),c=e.getFieldMap(),l=e.getRawData();this.elements=[];for(var u,d=this.timeGrid.getLineSpacing(),h=[],p=n>=0?n:0;p<n+t&&p<l.length;p++){var f=l[p][c.time],m=this.timeGrid.lineAt(p);void 0!==m&&(u=new i(this,p,f,m.format),h.push(u))}for(p=0;p<h.length-1;p++){u=h[p];var g=h[p+1],y=r(u.getIndex());r(g.getIndex())-y>=.6*d&&(u.draw(s,r,this),this.elements.push(u))}}}]),t}(a);t.exports=c},{"../element/TimeLabel":21,"../layer/Layer":25,underscore:6}],29:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../layer/Layer"),i=e("../element/HorizontalLine"),s=e("../element/ValueLabel"),c={lineSpacing:50,lineColor:"#ebebeb",showLabels:!0,labelColor:"#555555",labelFont:"7pt normal normal arial;",labelPaddingLeft:4,valueStep:1e-7},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},c,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e||{}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"getLabelWidth",value:function(){return this.labelWidth}},{key:"getLineStart",value:function(){return 0}},{key:"getLineEnd",value:function(){return this.getWidth()-this.getLabelWidth()}},{key:"draw",value:function(e,n,o,r,a,c){var l=this._getContext();this.elements=[],this.label_elements=[];var u,d,h=c.min,p=c.max;if(void 0===this.lines){u=[];var f=this.granularity;void 0===f&&(f=t.determineValueGranularity(h,p,this.getHeight(),this.lineSpacing,this.valueStep));var m=Math.round(1*h/f)/(1/f);d=t.decimalPlaces(f);for(;m<=p;)m=t.decimalAdjust("round",m,-8),u.push(m),m+=f}else u=this.lines;for(var g=0;g<u.length;g++){var y=u[g],_=new i(this,y,this.getLineStart(),this.getLineEnd());if(this.elements.push(_),_.draw(l,r,a,this),!0===this.showLabels){var b=new s(g,y.toFixed(d||2),this.getLineEnd());this.label_elements.push(b),b.draw(l,r,a,this)}}}}],[{key:"determineValueGranularity",value:function(e,t,n,o,r){for(var a=(t-e)/(n/o),i=2*r,s=r,c=[2.5,2,2],l=function(e,t){return e*c[t%3]},u=0;;u++){if(i>=a)return s;s=i,i=l(i,u)}return 1e3}},{key:"decimalAdjust",value:function(e,t,n){return void 0===n||0==+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!=0?NaN:(t=t.toString().split("e"),+((t=(t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n)))).toString().split("e"))[0]+"e"+(t[1]?+t[1]+n:n))))}},{key:"decimalPlaces",value:function(e){var t=(""+e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0}}]),t}(a);t.exports=l},{"../element/HorizontalLine":19,"../element/ValueLabel":22,"../layer/Layer":25,underscore:6}],30:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("fast-stats").Stats,i=e("../../layer/Layer"),s=e("../../element/Arc"),c={input:"close",upperBandOutputPrefix:"_bb_upper",midOutputPrefix:"_bb_mid",lowerBandOutputPrefix:"_bb_lower",period:20,multiplier:2,bandColor:"rgba(0, 0, 0, 0.3)",midColor:"rgba(0, 0, 0, 0.3)"},l=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=r.extend({},c,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.upperBandOutput=n.upperBandOutputPrefix+""+n.period+"x"+n.multiplier,n.midOutput=n.midOutputPrefix+""+n.period+"x"+n.multiplier,n.lowerBandOutput=n.lowerBandOutputPrefix+""+n.period+"x"+n.multiplier,n.minField=n.lowerBandOutput,n.maxField=n.upperBandOutput,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"precompute",value:function(e){for(var t=e.getRawData(),n=e.getFieldMap()[this.input],o=this.upperBandOutput,r=this.midOutput,i=this.lowerBandOutput,s=this.period,c=new a,l=new a,u=0;u<t.length;u++){var d=t[u];if(c.push(d[n]),l.push(d[n]),l.length===s){var h=c.amean(),p=l.stddev();d[o]=h+2*p,d[r]=h,d[i]=h-2*p,isNaN(d[o])&&(d[o]=0),isNaN(d[i])&&(d[i]=0),l.shift(),c.shift()}}}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),i=e.getFieldMap(),c=e.getRawData();this.elements=[],this.elements_upper=[],this.elements_lower=[];for(var l=null,u=null,d=null,h=n>=0?n:0;h<n+t&&h<c.length;h++){var p=c[h],f=new s(this,h,p[i.time],p[this.upperBandOutput],l);this.elements_upper.push(f),f.draw(a,o,r,{color:this.bandColor});var m=new s(this,h,p[i.time],p[this.midOutput],u);this.elements.push(m),m.draw(a,o,r,{color:this.midColor});var g=new s(this,h,p[i.time],p[this.lowerBandOutput],d);this.elements_lower.push(g),g.draw(a,o,r,{color:this.bandColor}),l=f,u=m,d=g}}}]),t}(i);t.exports=l},{"../../element/Arc":15,"../../layer/Layer":25,"fast-stats":3,underscore:6}],31:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i=e("../../element/Arc"),s={input:"close",outputPrefix:"_sma",period:50,color:"orange"},c=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=r.extend({},s,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.output=n.outputPrefix+""+n.period,n.minField=n.output,n.maxField=n.output,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"precompute",value:function(e){for(var t,n=e.getRawData(),o=e.getFieldMap(),r=this.output,a=o[this.input],i=this.period,s=2/(i+1),c=[],l=0,u=0;u<n.length;u++){var d=n[u];if(t){var h=(d[a]||1)*s+t*(1-s);d[r]=h,t=h}else if(c.length===i){t=l/i}else c.push(d[a]||1),l+=d[a]||1}}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=null,u=n>=0?n:0;u<n+t&&u<c.length;u++){var d=c[u],h=new i(this,u,d[s.time],d[this.output],l);this.elements.push(h),h.draw(a,o,r,this),l=h}}}]),t}(a);t.exports=c},{"../../element/Arc":15,"../../layer/Layer":25,underscore:6}],32:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i=e("../../element/Arc"),s={input:"close",output:"_rsi",period:14,color:"red",minValue:0,maxValue:100},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"precompute",value:function(e){for(var t,n,o=e.getRawData(),r=e.getFieldMap()[this.input],a=this.output,i=this.period,s=[],c=[],l=[],u=0,d=0,h=1;h<o.length;h++){var p,f=o[h],m=o[h-1],g=f[r]-m[r],y=Math.abs(g),_=0,b=0,v=0,w=0;g>=0?_=y:b=y,s.length<i?(s.push(g),g>=0?(c.push(y),d+=y):(l.push(y),u+=y)):s.length===i?(p=d/u,f[a]=100-100/(1+p),isNaN(f[a])&&(f[a]=0),s.push(g)):(p=(v=(t*(i-1)+_)/i)/(w=(n*(i-1)+b)/i),f[a]=100-100/(1+p),isNaN(f[a])&&(f[a]=0)),t=v,n=w,f[a]}}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=null,u=n>=0?n:0;u<n+t&&u<c.length;u++){var d=c[u],h=new i(this,u,d[s.time],d[this.output],l);this.elements.push(h),h.draw(a,o,r,this),l=h}}}]),t}(a);t.exports=c},{"../../element/Arc":15,"../../layer/Layer":25,underscore:6}],33:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i=e("../../element/Arc"),s={input:"ext",outputPrefix:"_ext",period:1,color:"orange"},c=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=r.extend({},s,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.output=n.outputPrefix+""+n.period,n.minField=n.output,n.maxField=n.output,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"precompute",value:function(e){for(var t=e.getRawData(),n=e.getFieldMap(),o=this.output,r=n[this.input],a=this.period,i=[],s=0,c=0;c<t.length;c++){var l=t[c];i.push(l[r]),s+=l[r],i.length===a+1&&(s-=i.shift(),l[o]=s/a)}}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=null,u=n>=0?n:0;u<n+t&&u<c.length;u++){var d=c[u],h=new i(this,u,d[s.time],d[this.output],l);this.elements.push(h),h.draw(a,o,r,this),l=h}}}]),t}(a);t.exports=c},{"../../element/Arc":15,"../../layer/Layer":25,underscore:6}],34:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i=e("../../element/Arc"),s={input:"close",outputPrefix:"_sma",period:50,color:"orange"},c=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=r.extend({},s,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.output=n.outputPrefix+""+n.period,n.minField=n.output,n.maxField=n.output,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"precompute",value:function(e){for(var t=e.getRawData(),n=e.getFieldMap(),o=this.output,r=n[this.input],a=this.period,i=[],s=0,c=0;c<t.length;c++){var l=t[c];i.push(l[r]),s+=l[r],i.length===a+1&&(s-=i.shift(),l[o]=s/a)}}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=null,u=n>=0?n:0;u<n+t&&u<c.length;u++){var d=c[u],h=new i(this,u,d[s.time],d[this.output],l);this.elements.push(h),h.draw(a,o,r,this),l=h}}}]),t}(a);t.exports=c},{"../../element/Arc":15,"../../layer/Layer":25,underscore:6}],35:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i=e("../../element/Arc"),s={lowInput:"low",highInput:"high",closeInput:"close",kOutput:"_stoch14_k",dOutput:"_stoch14_d",period:14,kMa:3,dMa:5,kColor:"orange",dColor:"lime",minValue:0,maxValue:100},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"precompute",value:function(e){for(var t,n,o=e.getRawData(),r=e.getFieldMap(),a=this.kOutput,i=this.dOutput,s=r[this.lowInput],c=r[this.highInput],l=r[this.closeInput],u=this.period,d=this.kMa,h=this.dMa,p=[],f=[],m=[],g=0,y=[],_=0,b=0;b<o.length;b++){var v=o[b];if(p.push(v[s]),p.length===u&&(t=Math.min.apply(Math,p),p.shift()),f.push(v[c]),f.length===u&&(n=Math.max.apply(Math,f),f.shift()),void 0!==t&&void 0!==n){var w=(v[l]-t)/(n-t)*100;isNaN(w)&&(w=0),m.push(w),g+=w,m.length===d+1&&(g-=m.shift(),v[a]=g/d),void 0!==v[a]&&(y.push(v[a]),_+=v[a],y.length===h+1&&(_-=y.shift(),v[i]=_/h))}}}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[],this.d_elements=[];for(var l=null,u=null,d=n>=0?n:0;d<n+t&&d<c.length;d++){var h=c[d],p=new i(this,d,h[s.time],h[this.dOutput],u);this.d_elements.push(p),p.draw(a,o,r,{color:this.dColor});var f=new i(this,d,h[s.time],h[this.kOutput],l);this.elements.push(f),f.draw(a,o,r,{color:this.kColor}),l=f,u=p}}}]),t}(a);t.exports=c},{"../../element/Arc":15,"../../layer/Layer":25,underscore:6}],36:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i=e("../../element/HistogramBar"),s={barColor:"blue",barWidth:3,minValue:0,maxField:"volume",minHeightPx:0},c=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},s,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"setBarWidth",value:function(e){this.barWidth=e}},{key:"getBarWidth",value:function(){return this.barWidth}},{key:"draw",value:function(e,t,n,o,r){var a=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=n>=0?n:0;l<n+t&&l<c.length;l++){var u=c[l],d=new i(this,l,u[s.time],u[s.volume]);d.draw(a,o,r,this),this.elements.push(d)}}}]),t}(a);t.exports=c},{"../../element/HistogramBar":18,"../../layer/Layer":25,underscore:6}],37:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../../layer/Layer"),i={highInput:"high",lowInput:"low",volumeInput:"volume",relativeWidth:.3333,vertexCount:120,color:"rgba(153, 180, 255, 0.7)"},s=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=r.extend({},i,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"draw",value:function(e,t,n,o,r,a){var i=this._getContext(),s=e.getFieldMap(),c=e.getRawData();this.elements=[];for(var l=this.vertexCount,u=a.min,d=a.max-u,h=this.profileWidth||this.getDrawingWidth()*this.relativeWidth,p=this.getHeight(),f=.5*(p/l),m=[],g=s[this.highInput],y=s[this.lowInput],_=s[this.volumeInput],b=0,v=0;v<l;v++)m[v]=0;for(v=n>=0?n:0;v<n+t&&v<c.length;v++)for(var w=c[v],x=w[g],k=w[y],$=w[_],T=Math.floor((k-u)/d*l),C=Math.floor((x-u)/d*l),O=1/(C-T+1),S=T;S<=C;S++)m[S]+=Math.round($*O);for(var M=0;M<l;M++)m[M]>b&&(b=m[M]);for(i.fillStyle=this.color,i.beginPath(),i.moveTo(0,p),M=0;M<l;M++){var j=m[M]/b*h,E=p-(M+1)/l*p*1;i.lineTo(j,E+f),i.lineTo(j,E-f)}i.lineTo(0,0),i.closePath(),i.fill()}}]),t}(a);t.exports=s},{"../../layer/Layer":25,underscore:6}],38:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0},a=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"getClassName",value:function(){return r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getClassName",this).call(this)+" panel"}},{key:"getWidth",value:function(){return this.getParentChart().getWidth()}},{key:"getDrawingWidth",value:function(){return this.getParentChart().getDrawingWidth()}}]),t}(e("../core/Component"));t.exports=a},{"../core/Component":8}],39:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0},a=e("underscore"),i=e("../panel/TimePanel"),s=e("../layer/TimeLabelsLayer"),c={height:16,crosshair:{value:!1,time:{label:!0}}},l=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=a.extend({},c,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"initLayers",value:function(){this.primaryLayer=this.primaryLayer||new s({timeGrid:this.getParentChart().getTimeGrid()}),this.primaryLayer.setParentComponent(this)}},{key:"getClassName",value:function(){return r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getClassName",this).call(this)+" timelabelspanel"}}]),t}(i);t.exports=l},{"../layer/TimeLabelsLayer":28,"../panel/TimePanel":40,underscore:6}],40:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0},a=e("underscore"),i=e("../panel/Panel"),s=e("../layer/TimeGridLayer"),c=e("../core/adjustCanvas"),l={},u=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),e=a.extend({},l,e),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"setPrimaryLayer",value:function(e){this.primaryLayer=e,this.primaryLayer.setParentComponent(this)}},{key:"initLayers",value:function(){this.grid&&(this.time_grid_layer=this.time_grid_layer||new s({timeGrid:this.getParentChart().getTimeGrid()}),this.time_grid_layer.setParentComponent(this)),this.primaryLayer.setParentComponent(this)}},{key:"getClassName",value:function(){return r(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getClassName",this).call(this)+" timepanel"}},{key:"createElement",value:function(){var e=window.document.createElement("CANVAS");return e.className=this.getClassName(),e.setAttribute("width",this.getWidth()),e.setAttribute("height",this.getHeight()),e}},{key:"_refresh",value:function(){var e=this.getEl();e.setAttribute("width",this.getWidth()),e.setAttribute("height",this.getHeight()),c(e)}},{key:"getContext",value:function(){return this.getEl().getContext("2d")}},{key:"precompute",value:function(e){this.primaryLayer.precompute&&this.primaryLayer.precompute(e);for(var t=this.getAllLayers(),n=0;n<t.length;n++){var o=t[n];o.precompute&&o.precompute(e)}}},{key:"draw",value:function(e,t,n,o){var r=this.getAllLayers();this._refresh(),this.grid&&(this.time_grid_layer=this.time_grid_layer||new s({}),this.time_grid_layer.draw(e,t,n,null,o,null));for(var a=0;a<r.length;a++){var i=r[a];i.draw&&i.draw(e,t,n,null,o,null)}this.primaryLayer.draw(e,t,n,null,o,null)}}]),t}(i);t.exports=u},{"../core/adjustCanvas":12,"../layer/TimeGridLayer":27,"../panel/Panel":38,underscore:6}],41:[function(e,t,n){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0},i=e("underscore"),s=e("../panel/TimePanel"),c=e("../layer/TimeGridLayer"),l=e("../layer/ValueGridLayer"),u={paddingTop:10,paddingBottom:10,primaryAtBack:!1,valueGridLayerConfig:{},timeGridLayerConfig:{}},d=function(e){function t(e){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),e=i.extend({},u,e);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._pixelToValue=function(){return 0},n.drawingHeight=Math.round(n.getHeight()-(n.paddingTop+n.paddingBottom)),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"initLayers",value:function(){var e;this.grid&&("object"===o(this.grid)&&this.grid.value&&(e=this.grid.value.lines),this.value_grid_layer=this.value_grid_layer||new l(i.extend(this.valueGridLayerConfig,{labelWidth:this.getParentChart().getPaddingRight(),lines:e})),this.value_grid_layer.setParentComponent(this),this.time_grid_layer=this.time_grid_layer||new c(i.extend(this.timeGridLayerConfig,{timeGrid:this.getParentChart().getTimeGrid()})),this.time_grid_layer.setParentComponent(this));this.primaryLayer.setParentComponent(this)}},{key:"getClassName",value:function(){return a(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getClassName",this).call(this)+" timevaluepanel"}},{key:"getDrawingHeight",value:function(){return this.drawingHeight}},{key:"draw",value:function(e,t,n,o){var r=e.findValueBounds(t,n,this.getMinAndMaxFields(),this.getMinAndMaxValues()),a=this.getValueToPixelMapper(r,!0);this._pixelToValue=this.getPixelToValueMapper(r,!0);var i=this.getAllLayers();this._refresh(),this.grid&&(this.value_grid_layer&&this.value_grid_layer.draw(e,t,n,a,o,r),this.time_grid_layer&&this.time_grid_layer.draw(e,t,n,a,o,r)),!0===this.primaryAtBack&&this.primaryLayer.draw(e,t,n,a,o,r);for(var s=0;s<i.length;s++){var c=i[s];c.draw&&c.draw(e,t,n,a,o,r)}void 0!==this.primaryAtBack&&!0===this.primaryAtBack||this.primaryLayer.draw(e,t,n,a,o,r)}},{key:"getMinAndMaxFields",value:function(){return{ext:this.primaryLayer.getExtField(),min:this.primaryLayer.getMinField(),max:this.primaryLayer.getMaxField()}}},{key:"getMinAndMaxValues",value:function(){return{min:this.primaryLayer.getMinValue(),max:this.primaryLayer.getMaxValue()}}},{key:"getValueToPixelMapper",value:function(e,t){var n=e.min,o=e.max-n,r=this.getDrawingHeight(),a=this.paddingTop;return!0===t?function(e){return r-(e-n)/o*r+a}:function(e){return(e-n)/o*r-a}}},{key:"getPixelToValueMapper",value:function(e,t){var n=e.min,o=e.max-n,r=this.getDrawingHeight(),a=this.paddingTop;return!0===t?function(e){return(r-(e-a))/r*o+n}:function(e){return(e+a)/r*o+n}}},{key:"pixelToValue",value:function(e){return this._pixelToValue(e)}}]),t}(s);t.exports=d},{"../layer/TimeGridLayer":27,"../layer/ValueGridLayer":29,"../panel/TimePanel":40,underscore:6}],42:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=e("underscore"),a=e("../core/Type"),i={},s=function(e){function t(e,n,o,a,s){(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,t),s=r.extend({},i,s);var c=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s));return c._raw_data=e,c._field_map=n,c._symbol=o,c._granularity=a,c._initTimeToIndexMap(),c}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"_initTimeToIndexMap",value:function(){this._time_to_index_map={};for(var e=0;e<this._raw_data.length;e++){var t=this._raw_data[e][this._field_map.time];this._time_to_index_map[t]=e}}},{key:"getRawData",value:function(){return this._raw_data}},{key:"getFieldMap",value:function(){return this._field_map}},{key:"getSymbol",value:function(){return this._symbol}},{key:"getGranularity",value:function(){return this._granularity}},{key:"findValueBounds",value:function(e,t,n,o){var r=this._raw_data,a=t,i=e+t-1;a<0&&(a=0),i>=r.length&&(i=r.length-1);var s,c,l=n.ext,u=n.min,d=n.max,h=o.min,p=o.max,f=99999999,m=-99999999;if(void 0!==h)f=h;else if(void 0!==u){var g=this._field_map[l],y=this._field_map[u];for(s=a;s<=i;s++){var _=(c=r[s])[y];_<f&&(f=_);var b=c[g];b<f&&(f=b)}}else f=0;if(void 0!==p)m=p;else if(void 0!==d){var v=this._field_map[l],w=this._field_map[d];for(s=a;s<=i;s++){var x=(c=r[s])[w];x>m&&(m=x);var k=c[v];k>m&&(m=k)}}if(f===m){var $=f;$>0&&(f=.75*$,m=1.25*$),$<0&&(m=.75*$,f=1.25*$),m-f<1e-7&&(f-=1e-7,m+=1e-7),0===$&&(f=0,m=1)}return{min:f,max:m}}}]),t}(a);t.exports=s},{"../core/Type":11,underscore:6}]},{},[1]),function(e,t){"function"==typeof define&&define.amd?define([],t):"undefined"!=typeof module&&module.exports?module.exports=t():e.ReconnectingWebSocket=t()}(this,(function(){function e(t,n,o){function r(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}var a={debug:!1,automaticOpen:!0,reconnectInterval:1e3,maxReconnectInterval:3e4,reconnectDecay:1.5,timeoutInterval:2e3};for(var i in o||(o={}),a)this[i]=void 0!==o[i]?o[i]:a[i];this.url=t,this.reconnectAttempts=0,this.readyState=WebSocket.CONNECTING,this.protocol=null;var s,c=this,l=!1,u=!1,d=document.createElement("div");d.addEventListener("open",(function(e){c.onopen(e)})),d.addEventListener("close",(function(e){c.onclose(e)})),d.addEventListener("connecting",(function(e){c.onconnecting(e)})),d.addEventListener("message",(function(e){c.onmessage(e)})),d.addEventListener("error",(function(e){c.onerror(e)})),this.addEventListener=d.addEventListener.bind(d),this.removeEventListener=d.removeEventListener.bind(d),this.dispatchEvent=d.dispatchEvent.bind(d),this.open=function(t){s=new WebSocket(c.url,n||[]),t||d.dispatchEvent(r("connecting")),(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","attempt-connect",c.url);var o=s,a=setTimeout((function(){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","connection-timeout",c.url),u=!0,o.close(),u=!1}),c.timeoutInterval);s.onopen=function(){clearTimeout(a),(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onopen",c.url),c.protocol=s.protocol,c.readyState=WebSocket.OPEN,c.reconnectAttempts=0;var n=r("open");n.isReconnect=t,t=!1,d.dispatchEvent(n)},s.onclose=function(n){if(clearTimeout(a),s=null,l)c.readyState=WebSocket.CLOSED,d.dispatchEvent(r("close"));else{c.readyState=WebSocket.CONNECTING;var o=r("connecting");o.code=n.code,o.reason=n.reason,o.wasClean=n.wasClean,d.dispatchEvent(o),t||u||((c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onclose",c.url),d.dispatchEvent(r("close")));var a=c.reconnectInterval*Math.pow(c.reconnectDecay,c.reconnectAttempts);setTimeout((function(){c.reconnectAttempts++,c.open(!0)}),a>c.maxReconnectInterval?c.maxReconnectInterval:a)}},s.onmessage=function(t){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onmessage",c.url,t.data);var n=r("message");n.data=t.data,d.dispatchEvent(n)},s.onerror=function(t){(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","onerror",c.url,t),d.dispatchEvent(r("error"))}},1==this.automaticOpen&&this.open(!1),this.send=function(t){if(s)return(c.debug||e.debugAll)&&console.debug("ReconnectingWebSocket","send",c.url,t),s.send(t);throw"INVALID_STATE_ERR : Pausing to reconnect websocket"},this.close=function(e,t){void 0===e&&(e=1e3),l=!0,s&&s.close(e,t)},this.refresh=function(){s&&s.close()}}return e.prototype.onopen=function(){},e.prototype.onclose=function(){},e.prototype.onconnecting=function(){},e.prototype.onmessage=function(){},e.prototype.onerror=function(){},e.debugAll=!1,e.CONNECTING=WebSocket.CONNECTING,e.OPEN=WebSocket.OPEN,e.CLOSING=WebSocket.CLOSING,e.CLOSED=WebSocket.CLOSED,e})),$((function(){$.fn.table_config=function e(t){let n=$.extend({page:10,cls_row:"",cls_cell:"",cls_tbody:""},t);e.data=n},$.fn.table_config(),$.fn.table_init=function(e){const t=$.fn.table_config.data;let n=$.extend({cols:["Name"],rows:t.page,cls_row:t.cls_row,cls_cell:t.cls_cell,cls_tbody:t.cls_tbody},e);const o=this.attr("id"),r=this.prop("tagName");n.rows;let a="div",i="div",s="div";"TABLE"==r&&(a="tr",i="td",s="tbody");let c=[],l=[];n.cols.forEach((function(e,t){let n="",o=e;"object"==typeof e&&null!==e&&(o=e.name,"cls"in e&&(n=e.cls)),c.push(o),l.push(n)}));let u=!1,d=0;Array.isArray(n.rows)?(d=n.rows.length,u=!0):d=n.rows||t.page;let h=document.getElementById(o),p=document.createElement(s);p.setAttribute("id",o+"-tbody"),p.setAttribute("class",n.cls_tbody);for(let e=0;e<d;e++){let t=""+e;u&&(t=n.rows[e]);if(document.getElementById(o+"-"+t+"-"+c[0]))continue;let r=document.createElement(a);r.setAttribute("class",n.cls_row),r.setAttribute("id",o+"-"+t),c.forEach((function(e,a){let s=document.createElement(i),c=document.createTextNode(" ");s.appendChild(c),s.setAttribute("id",o+"-"+t+"-"+e);const u=l[a];""!=u?s.setAttribute("class",u):s.setAttribute("class",n.cls_cell),r.appendChild(s)})),p.appendChild(r)}h.appendChild(p),this.attr("jchui_size",d),this.attr("jchui_cols",c.join(",")),this.attr("jchui_cols_cls",l.join(",")),this.attr("jchui_rows",n.rows),this.attr("jchui_named",u),u&&this.attr("jchui_rows",n.rows.join(","))},$.fn.table_resize=function(e){this.attr("id");const t=this.attr("jchui_size");e>t&&this.table_expand(e),e<t&&this.table_shrink(e)},$.fn.table_shrink=function(e){const t=this.attr("id"),n=this.attr("jchui_size"),o="true"===this.attr("jchui_named");let r=this.attr("jchui_rows");o&&(r=this.attr("jchui_rows").split(","));let a=document.getElementById(t+"-tbody");for(let i=n-1;i>=e;i--){let e=""+i;o&&(e=r[i]);let n=document.getElementById(t+"-"+e);a.removeChild(n)}e<n&&this.attr("jchui_size",e)},$.fn.table_expand=function(e){const t=this.attr("id"),n=this.prop("tagName"),o=this.attr("jchui_size"),r=this.attr("jchui_cols").split(","),a=this.attr("jchui_cols_cls").split(","),i=$.fn.table_config.data;let s="div",c="div",l="div";"TABLE"==n&&(s="tr",c="td",l="tbody");let u=document.getElementById(t+"-tbody");for(let n=o;n<e;n++){let e=document.createElement(s);e.setAttribute("class",i.cls_row),e.setAttribute("id",t+"-"+n),r.forEach((function(o,r){let s=document.createElement(c),l=document.createTextNode(" ");s.appendChild(l),s.setAttribute("id",t+"-"+n+"-"+o);const u=a[r];""!=u?s.setAttribute("class",u):s.setAttribute("class",i.cls_cell),e.appendChild(s)})),u.appendChild(e)}e>o&&this.attr("jchui_size",e)},$.fn.table_clear=function(){const e=this.attr("id"),t=this.attr("jchui_size"),n=this.attr("jchui_cols").split(","),o="true"===this.attr("jchui_named");let r=this.attr("jchui_rows");o&&(r=this.attr("jchui_rows").split(","));for(let a=0;a<t;a++){let t=""+a;o&&(t=r[a]),n.forEach((function(n,o){document.getElementById(e+"-"+t+"-"+n).innerText=" "}))}},$.fn.table_col_show=function(e,t){const n=this.attr("id");if(null==t&&(t=!0),!t)return void this.table_col_hide(e);const o=this.attr("jchui_size"),r="true"===this.attr("jchui_named");let a=this.attr("jchui_rows");r&&(a=this.attr("jchui_rows").split(",")),$("#"+n+"-head-"+e).show();for(let t=0;t<o;t++){let o=""+t;r&&(o=a[t]),$("#"+n+"-"+o+"-"+e).show()}},$.fn.table_col_hide=function(e){const t=this.attr("id"),n=this.attr("jchui_size"),o="true"===this.attr("jchui_named");let r=this.attr("jchui_rows");o&&(r=this.attr("jchui_rows").split(",")),$("#"+t+"-head-"+e).hide();for(let a=0;a<n;a++){let n=""+a;o&&(n=r[a]),$("#"+t+"-"+n+"-"+e).hide()}},$.fn.table_row_add_class=function(e,t){const n=this.attr("id");this.attr("jchui_cols").split(",").forEach((function(o,r){$("#"+n+"-"+e+"-"+o).addClass(t)}))},$.fn.table_row_remove_class=function(e,t){const n=this.attr("id");this.attr("jchui_cols").split(",").forEach((function(o,r){$("#"+n+"-"+e+"-"+o).removeClass(t)}))},$.fn.table_insert_custom_row=function(e,t){const n=this.attr("id"),o=this.prop("tagName"),r=(this.attr("jchui_size"),this.attr("jchui_cols").split(",")),a=this.attr("jchui_cols_cls").split(","),s=$.fn.table_config.data;let c="div",l="div",u="div";"TABLE"==o&&(c="tr",l="td",u="tbody");let d=document.getElementById(n+"-tbody"),h=document.createElement(c);h.setAttribute("class",s.cls_row),h.setAttribute("id",n+"-"+t),r.forEach((function(e,o){let r=document.createElement(l),i=document.createTextNode(" ");r.appendChild(i),r.setAttribute("id",n+"-"+t+"-"+e);const c=a[o];""!=c?r.setAttribute("class",c):r.setAttribute("class",s.cls_cell),h.appendChild(r)}));let p=0,f=0,m=d.childNodes;for(i=0;i<m.length;i++){let t=m[i];if("classList"in t&&t.classList.length>0&&t.classList[0]==s.cls_row&&(f++,f>e)){p=i;break}}d.insertBefore(h,m[p])}})),$((function(){$.fn.dot_slide=function(e,t,n){const o=this.attr("id"),r=this.prop("tagName");if(""!=o&&"SPAN"==r&&!(this.children().length>0))for(let r=10;r<=100;r+=10){let a=document.createElement("a");if(a.setAttribute("id",o+"-fill-"+r),a.setAttribute("href",e+"-fill-"+r),a.setAttribute("class","dotslide"),100==r){let e=document.createTextNode(" ");this[0].appendChild(e),a.innerHTML=t}else if(50==r){let e=document.createTextNode("½");a.appendChild(e)}else{let e=document.createTextNode("●");a.appendChild(e)}this[0].appendChild(a),$("#"+o+"-fill-"+r).on("click",(function(e){e.preventDefault(),n(r)})),$("#"+o+"-fill-"+r).on("mouseenter",(function(){for(let e=10;e<r;e+=10)$("#"+o+"-fill-"+e).addClass("dotslide-on")})),$("#"+o+"-fill-"+r).on("mouseleave",(function(){for(let e=10;e<r;e+=10)$("#"+o+"-fill-"+e).removeClass("dotslide-on")}))}},$.fn.dot_slide_max_html=function(e){const t=this.attr("id"),n=this.prop("tagName");if(""==t)return;if("SPAN"!=n)return;$("#"+t+"-fill-100")[0].innerHTML=e}}));var ych=function(){};ych.gui=function(){},ych.gui.forms={},ych.gui.pages={},ych.gui.parts={},ych.gui.guictx={},$((function(){console.log("Init1"),$("#pages").hide(),$("#reload1").hide(),$("#connecting2").hide(),$("#connecting1").css("display","flex"),$("button").button(),$("fieldset").controlgroup(),$('input[type="radio"]').checkboxradio({icon:!1}),$('input[type="checkbox"]').checkboxradio({icon:!1}),window.ych_login_path="/u/init",ych.nnum="",ych.user="",ych.sigi_num=30,ych.pubkey1="",ych.prvkey1="",ych.pubkey2="",ych.pubkey3="",ych.address={},ych.locktime1={},ych.locktime2={},ych.asset_extra={},ych.data={},ych.data.buys={},ych.data.sells={},ych.data.trades={},ych.data.markets={},ych.ws_calls={},ych.gui.pagesize=15,$("body").table_config({page:ych.gui.pagesize,cls_row:"ytable-row",cls_cell:"ytable-cell",cls_tbody:"ytable-tbody"}),ych.gui.current_market="",ych.gui.prefs_txouts_debug=!1,ych.gui.connecting1=!0,ych.gui.connecting2=!0,ych.timer_reauth=setTimeout((function(){}),3e5),ych.zerotxid="0000000000000000000000000000000000000000000000000000000000000000",window.onresize=function(){const e="on_resize";for(const t in ych.gui.pages)if($("#page-"+t).is(":visible")){let n=ych.gui.pages[t];e in n&&n[e]()}},window.onconnecting=function(){ych.gui.connecting1?($("#pages").hide(),$("#connecting1").css("display","flex"),$("#connecting2").hide()):ych.gui.connecting2?($("#pages").hide(),$("#connecting1").hide(),$("#connecting2").css("display","flex")):($("#pages").show(),$("#connecting1").hide(),$("#connecting2").hide())}}));var jsonBNparse=function(e,t){return"string"==typeof t&&/^\-?\d+n$/.test(t)?BigInt(t.slice(0,-1)):t};$((function(){console.log("Init utils"),ych.is_logged=function(){let e=!1,t=ych.get_cookie("jwt").split(".");if(3==t.length){let n=t[1].replace("-","+").replace("_","/");"uid"in JSON.parse(window.atob(n))&&(e=!0)}return e},ych.get_cookie=function(e){let t=e+"=",n=decodeURIComponent(document.cookie).split(";");for(let e=0;e<n.length;e++){let o=n[e];for(;" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""},ych.buy_fee=function(e,t){if(null==ych.data.coininfos)return 0;if(!(t in ych.data.coininfos))return 0;let n=ych.data.coininfos[t].fee.buyfee;const o=e+"-"+t;if(null==ych.data.markets)return n;if(!o in ych.data.markets)return n;const r=ych.data.markets[o];return r.fee.over&&(n=r.fee.buyfee),n},ych.sell_fee=function(e,t){if(null==ych.data.coininfos)return 0;if(!(e in ych.data.coininfos))return 0;let n=ych.data.coininfos[e].fee.sellfee;const o=e+"-"+t;if(null==ych.data.markets)return n;if(!o in ych.data.markets)return n;const r=ych.data.markets[o];return r.fee.over&&(n=r.fee.sellfee),n}})),$((function(){console.log("Init utils-gui"),ych.gui.format_date=function(e){let t='<span class="ydate">';if(0==e)return t+"-</span>";let n=new Date,o=new Date(1e3*e),r=function(e){return e<10&&(e="0"+e),t+e+"</span>"};return n.getFullYear()==o.getFullYear()&&n.getMonth()==o.getMonth()&&n.getDate()==o.getDate()?t+r(o.getHours())+":"+r(o.getMinutes())+":"+r(o.getSeconds())+"</span>":n.getFullYear()==o.getFullYear()?t+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][o.getMonth()]+" "+r(o.getDate())+" "+r(o.getHours())+":"+r(o.getMinutes())+"</span>":t+["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][o.getMonth()]+" "+r(o.getDate())+" "+o.getFullYear()+"</span>"},ych.gui.format_txout_link1=function(e,t,n){const o=ych.data.coininfos[e].type;let r=t.substr(0,8)+":"+n,a=ych.data.coininfos[e].ext.txhashurl;return""==a||null==a||"txout_t1"!=o&&"peg_t1"!=o&&"evm_t1"!=o&&"erc20_t1"!=o?r:(a=a.replace("{txid}",t),a=a.replace("{nout}",n),"<a class='ytable-txout-a' href='"+a+"' target='_blank'>"+r+"</a>")},ych.gui.format_txout_link2=function(e,t,n,o){const r=ych.data.coininfos[e].type;let a=t.substr(0,8)+":"+n;350==o&&(a=t.substr(0,8)+"'"+n),800==o&&(a=t.substr(0,8)+"."+n);let i=ych.data.coininfos[e].ext.txhashurl;return""==i||null==i||"txout_t1"!=r&&"peg_t1"!=r?a:(i=i.replace("{txid}",t),i=i.replace("{nout}",n),"<a class='ytable-txout-a' href='"+i+"' target='_blank'>"+a+"</a>")},ych.gui.format_addr_link=function(e,t){let n=ych.data.coininfos[e].ext.txaddrurl;if(""!=n&&null!=n){return n=n.replace("{addr}",t),"<a class='ytable-txout-a' href='"+n+"' target='_blank'>"+(t.substr(0,6)+"..."+t.substr(t.length-4,t.length))+"</a>"}return t},ych.gui.format_amount=function(e){if(e<0)return"-"+ych.gui.format_amount(-e);let t='<span class="yamount">';t+='<span class="yamount-B">&#8239;</span>';const n=(e,t)=>String(e).padStart(t,"0"),o=(e,t)=>String(e).padStart(t,"0").substring(0,t-String(e).length),r=100000000n,a=e,i=["yamount-col1","yamount-col2","yamount-col3","yamount-col-off"];let s=0,c=!1,l=!1,u=!1,d=!1,h=" yamount-sign";if(e>=1000000000n*r){t+='<span class="yamount-B '+i[s]+h+'">'+e/(1000000000n*r)+'</span><span class="yamount-N yamount-col-off">,</span>',e%=1000000000n*r,c=!0,h="",s<3&&s++}if(e>=1000000n*r){const o=e/(1000000n*r);let a=""+o;c&&(a=n(o,3)),t+='<span class="yamount-M '+i[s]+h+'">'+a+'</span><span class="yamount-N yamount-col-off">,</span>',e%=1000000n*r,l=!0,h="",s<3&&s++}if(e>=1000n*r||l){const o=e/(1000n*r);let a=""+o;l&&(a=n(o,3)),t+='<span class="yamount-K '+i[s]+h+'">'+a+'</span><span class="yamount-N yamount-col-off">,</span>',e%=1000n*r,u=!0,h="",s<3&&s++}if(e>=r||u){const o=e/r;let a=""+o;u&&(a=n(o,3)),t+='<span class="yamount-N '+i[s]+h+'">'+a+"</span>",e%=r,d=!0,h="",s<3&&s++}let p=!1;a<r?(t+='<span class="yamount-N yamount-col-off">0.&#8239;</span>',p=!0):t+='<span class="yamount-N yamount-col1">.&#8239;</span>';{const n=e/(r/100n);let a=n+"&#8239;";0==n&&p?t+='<span class="yamount-c yamount-col-off">00&#8239;</span>':(t+=p?'<span class="yamount-c yamount-col-off">':'<span class="yamount-c '+i[s]+'">',t+=o(n,2)+"</span>",t+='<span class="yamount-c '+i[s]+h+'">'+a+"</span>",s<3&&s++,p=!1,h=""),e%=r/100n}{const n=e/1000n;let r=n+"&#8239;";0==n&&p?t+='<span class="yamount-cm yamount-col-off">000&#8239;</span>':(t+=p?'<span class="yamount-cm yamount-col-off">':'<span class="yamount-cm '+i[s]+'">',t+=o(n,3)+"</span>",t+='<span class="yamount-cm '+i[s]+h+'">'+r+"</span>",s<3&&s++,p=!1,h=""),e%=1000n}{let n=""+e;0==e&&p?t+='<span class="yamount-cmm yamount-col-off">000</span>':(t+=p?'<span class="yamount-cmm yamount-col-off">':'<span class="yamount-cmm '+i[s]+'">',t+=o(e,3)+"</span>",t+='<span class="yamount-cmm '+i[s]+h+'">'+n+"</span>")}return t+="<span>",t},ych.gui.format_amount_off=function(e){if(e<0)return"-"+ych.gui.format_amount_off(-e);let t="",n=Number(e%100000000n),o=e/100000000n+".",r=(a=8,String(n).padStart(a,"0"));var a;let i=o+r,s=i.match(/^0(\.)?0*/g);if(null!=s){t+='<span class="ysemi">'+s[0]+"</span>",t+='<span class="ysemi">'+i.substr(s[0].length)+"</span>"}else t+='<span class="ysemi">'+o+"</span>",t+='<span class="ysemi">'+r+"</span>";return t},ych.gui.format_amount_or_empty=function(e){return 0!=e?ych.gui.format_amount(e):"-"},ych.gui.format_usd_like=function(e,t){if(t<0)return"-"+ych.gui.format_usd_like(e,-t);let n='<span class="yamount">',o=Math.round(100*t)/100,r=(a=Math.round(100*o%100),i=2,String(a).padStart(i,"0"));var a,i;return n+='<span class="ysemi">'+e+"</span>",n+='<span class="ynorm">'+Number(((100*o-100*o%100)/100).toFixed(0)).toLocaleString()+"</span>",n+='<span class="ysemi ycents">.'+r+"</span>",n+="<span>",n},ych.gui.format_usd=function(e){if(e<0)return"-"+ych.gui.format_usd(-e);let t='<span class="yamount">',n=Math.round(100*e)/100;if(0==e)t+='<span class="ysemi">≈$0</span>';else if(e<10){let e=(o=Math.round(100*n%100),r=2,String(o).padStart(r,"0"));t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/100).toFixed(0)).toLocaleString()+"</span>",t+='<span class="ysemi ycents">.'+e+"</span>"}else if(e<1e3){t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/100).toFixed(0)).toLocaleString()+"</span>"}else if(e<1e4){t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/1e5).toFixed(2)).toLocaleString()+"K</span>"}else if(e<1e5){t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/1e5).toFixed(1)).toLocaleString()+"K</span>"}else if(e<1e6){t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/1e5).toFixed(0)).toLocaleString()+"K</span>"}else{t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/1e8).toFixed(2)).toLocaleString()+"M</span>"}var o,r;return t+="<span>",t},ych.gui.format_usd_full=function(e){if(e<0)return"-"+ych.gui.format_usd(-e);let t="",n=Math.round(100*e)/100,o=(r=Math.round(100*n%100),a=2,String(r).padStart(a,"0"));var r,a;return t+='<span class="ysemi">≈$</span>',t+='<span class="ynorm">'+Number(((100*n-100*n%100)/100).toFixed(0)).toLocaleString()+"</span>",t+='<span class="ysemi ycents">.'+o+"</span>",t},ych.gui.format_usd_or_empty=function(e){return ych.gui.format_usd(e)},ych.gui.format_paused=function(e){let t="";return t+="<span>"+e+"</span>",t},ych.gui.cleanup_email=function(e){return e.startsWith("BM-")?e:e.toLowerCase()},ych.gui.check_email=function(e){if(e.startsWith("BM-")){try{coinjs.base58decode(e.substring(3))}catch(e){return console.log(e),!1}return!0}return/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e)},ych.gui.get_input_amount=function(e){let t=0n;return isNaN($("#"+e).val())||""==$("#"+e).val()||(t=BigInt(Math.floor(.5+1e8*parseFloat($("#"+e).val())))),t}})),$((function(){console.log("Init api calls"),ych.apicall=function(e){if("digest"in e){ych.init_coinjs();let t=ych.prvkey1;"uprvk"in e&&(t=e.uprvk);const n=ych.str2bytes(e.digest+ych.nnum),o=Crypto.SHA256(n,{asBytes:!0}),r=Crypto.SHA256(o,{asBytes:!0}),a=coinjs.transaction(),i=coinjs.privkey2wif(t),s=a.transactionSig(0,i,1,r);e.data.usig=s}$.ajax({type:"PUT",url:e.uri,data:JSON.stringify(e.data,((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),dataType:"text",success:function(t){const n=JSON.parse(t,jsonBNparse);console.log(n),n.ok?e.on_success(n):e.on_error(n.error)},error:function(t,n,o){e.on_error(n+": "+o)}})}})),$((function(){console.log("Init data updates"),ych.gui.update_coininfo=function(e){if(null!=ych.data.profile&&e.coin in ych.data.profile.balances){let t=ych.data.profile.balances[e.coin];ych.gui.parts.wallet.balances.show_sync(t,e)}ych.data_update("coininfo",e)},ych.data_update=function(e,t){let n="on_"+e;for(let e in ych.gui.pages){let o=ych.gui.pages[e];if(n in o){(0,o[n])(t)}if(e in ych.gui.parts)for(let o in ych.gui.parts[e]){let r=ych.gui.parts[e][o];if(n in r){(0,r[n])(t)}}}},ych.gui.update_balance=function(e){"wallet"in ych.gui.parts&&"balances"in ych.gui.parts.wallet&&ych.gui.parts.wallet.balances.update_balance(e)},ych.ws_calls.nnum=function(e){const t=e.objects[0];ych.nnum=t},ych.ws_calls.coininfo=function(e){const t=e.objects[0];null==ych.data.coininfos&&(ych.data.coininfos={}),ych.data.coininfos[t.coin]=t,ych.gui.update_coininfo(t)},ych.ws_calls.market=function(e){const t=e.objects[0];ych.data.markets[t.name]=t,ych.data_update("market",t)},ych.ws_calls.markettradesupdate=function(e){const t=e.objects[0],n=t.coina+"-"+t.coinb;ych.data.trades[n]=t.page},ych.ws_calls.usertradesupdate=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[0],n=t.coina+"-"+t.coinb;ych.data.profile.trades[n]=t.page},ych.ws_calls.depositaddress=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[0],n=t.coin;ych.address[n]=t.addr,ych.locktime1[n]=t.lck1,ych.locktime2[n]=t.lck2,n in ych.data.profile.balances&&ych.gui.update_balance(ych.data.profile.balances[n])},ych.ws_calls.addressesupdate1=function(e){const t=e.objects[0],n=t.coin,o=t.list;n in ych.asset_extra||(ych.asset_extra[n]={},ych.asset_extra[n].senders=[]),ych.asset_extra[n].senders=o},ych.ws_calls.adddeposit=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[1],n=t.coin;let o=ych.data.profile.deposits[n],r=!0;o.forEach((function(e,n){e.index>=t.index&&(r=!1)})),r&&(o.unshift(t),o=o.slice(0,ych.gui.pagesize),ych.data.profile.deposits[n]=o)},ych.ws_calls.regdeposit=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[1],n=t.coin;let o=ych.data.profile.deposits[n];o.forEach((function(e,n){t.index==e.index&&(o[n]=t,e=t)}))},ych.ws_calls.addwithdraw=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[1],n=t.coin;let o=ych.data.profile.withdraws[n],r=!0;o.forEach((function(e,n){e.uidx>=t.uidx&&(r=!1)})),r&&(o.unshift(t),o=o.slice(0,ych.gui.pagesize),ych.data.profile.withdraws[t.coin]=o)},ych.ws_calls.regwithdraw=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[1],n=t.coin;let o=ych.data.profile.withdraws[n];o.forEach((function(e,n){t.uidx==e.uidx&&(o[n]=t,e=t)}))},ych.ws_calls.balances=function(e){e.objects[0].forEach((function(e,t){ych.data.profile.balances[e.coin]=e,ych.gui.update_balance(e)}))},ych.ws_calls.accountchange=function(e){},ych.ws_calls.newcandle=function(e){},ych.ws_calls.updatecandle=function(e){},ych.ws_calls.txoutsupdate=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[0],n=e.objects[1];ych.data.profile.txouts[t]=n,ych.data_update("txouts",{coin:t,txouts:n})},ych.ws_calls.buysupdate=function(e){const t=e.objects[0],n=t.coina+"-"+t.coinb;ych.data.buys[n]=t.buyspage},ych.ws_calls.sellsupdate=function(e){const t=e.objects[0],n=t.coina+"-"+t.coinb;ych.data.sells[n]=t.sellspage},ych.ws_calls.userbuysupdate=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[0],n=t.coina+"-"+t.coinb;ych.data.profile.buys[n]=t.buyspage},ych.ws_calls.usersellsupdate=function(e){if(null==ych.data.profile)return;if(null==ych.data.profile)return;const t=e.objects[0],n=t.coina+"-"+t.coinb;ych.data.profile.sells[n]=t.sellspage}})),$((function(){console.log("Init multisig-evm"),ych.evm_abi_erc20=[{inputs:[{internalType:"string",name:"name_",type:"string"},{internalType:"string",name:"symbol_",type:"string"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"owner",type:"address"},{indexed:!0,internalType:"address",name:"spender",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Approval",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"from",type:"address"},{indexed:!0,internalType:"address",name:"to",type:"address"},{indexed:!1,internalType:"uint256",name:"value",type:"uint256"}],name:"Transfer",type:"event"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"allowance",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"spender",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"approve",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"balanceOf",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"burn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"decimals",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"}],name:"mint",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"symbol",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[],name:"totalSupply",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transfer",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"recipient",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],name:"transferFrom",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"nonpayable",type:"function"}],ych.evm_abi_vault7=[{inputs:[{internalType:"address",name:"tss_addr",type:"address"},{internalType:"address",name:"weth_addr",type:"address"},{internalType:"address[]",name:"add_coins",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"coin",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"bytes32",name:"state",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"irev",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orev",type:"uint256"}],name:"In",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"coin",type:"address"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"bytes32",name:"state1",type:"bytes32"},{indexed:!1,internalType:"bytes32",name:"state2",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"irev",type:"uint256"},{indexed:!1,internalType:"uint256",name:"orev",type:"uint256"},{indexed:!1,internalType:"uint256",name:"balance",type:"uint256"},{indexed:!1,internalType:"uint256",name:"sigr",type:"uint256"},{indexed:!1,internalType:"uint256",name:"sigv",type:"uint256"}],name:"Op",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"sender",type:"address"},{indexed:!0,internalType:"address",name:"user",type:"address"},{indexed:!1,internalType:"bool",name:"reg",type:"bool"}],name:"Reg",type:"event"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"balances",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"coin",type:"address"},{components:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"usea",type:"uint256"},{internalType:"bytes",name:"sig1",type:"bytes"},{internalType:"uint256",name:"sigr",type:"uint256"},{internalType:"uint256",name:"sigv",type:"uint256"}],internalType:"struct Vault7.Use[]",name:"uses",type:"tuple[]"},{components:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"}],internalType:"struct Vault7.Fill[]",name:"fills",type:"tuple[]"},{internalType:"bytes",name:"sig2",type:"bytes"},{internalType:"uint256",name:"tw",type:"uint256"}],name:"clearance1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"coins",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"coin",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"user",type:"address"},{internalType:"bytes",name:"sig1",type:"bytes"}],name:"deposit1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"irevs",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"addr",type:"address"},{internalType:"uint256",name:"min_amount",type:"uint256"},{internalType:"bool",name:"on",type:"bool"},{internalType:"bytes",name:"sig2",type:"bytes"},{internalType:"uint256",name:"tw",type:"uint256"}],name:"listCoin",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"locktime1",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"locktime2",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"minamount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"orevs",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"user",type:"address"},{internalType:"bytes",name:"sig1",type:"bytes"},{internalType:"uint256",name:"tw",type:"uint256"}],name:"register1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"user",type:"address"},{internalType:"bool",name:"on",type:"bool"},{internalType:"bytes",name:"sig2",type:"bytes"},{internalType:"uint256",name:"tw",type:"uint256"}],name:"register2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"sigr",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"},{internalType:"uint256",name:"",type:"uint256"}],name:"sigv",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"}],name:"states",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"totals",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"unregister1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"sender",type:"address"},{internalType:"address",name:"user",type:"address"},{internalType:"bytes",name:"sig1",type:"bytes"}],name:"unregister2",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"users",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"ustate",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"coin",type:"address"},{internalType:"address",name:"user",type:"address"},{internalType:"address",name:"dest",type:"address"},{components:[{internalType:"address",name:"user",type:"address"},{internalType:"uint256",name:"usea",type:"uint256"},{internalType:"bytes",name:"sig1",type:"bytes"},{internalType:"uint256",name:"sigr",type:"uint256"},{internalType:"uint256",name:"sigv",type:"uint256"}],internalType:"struct Vault7.Use[]",name:"uses",type:"tuple[]"},{internalType:"bytes",name:"sig2",type:"bytes"},{internalType:"uint256",name:"tw",type:"uint256"}],name:"withdraw1",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"coin",type:"address"},{internalType:"address",name:"dest",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"bytes",name:"sig2",type:"bytes"}],name:"withdraw3",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],ych.evm_zeroaddr="0x0000000000000000000000000000000000000000",ych.evm_hash1=function(e,t,n,o,r){const a=_ethers.utils.arrayify(t),i=_ethers.utils.arrayify(e),s=_ethers.utils.arrayify(o),c=_ethers.utils.hexZeroPad(_ethers.utils.hexValue(n),32),l=_ethers.utils.arrayify(c),u=_ethers.utils.hexZeroPad(_ethers.utils.hexValue(r),32),d=_ethers.utils.arrayify(u),h=_ethers.utils.concat([i,a,l,s,d]),p=_ethers.utils.keccak256(h),f=_ethers.utils.arrayify(p),m=_ethers.utils.toUtf8Bytes("Ethereum Signed Message:\n32"),g=_ethers.utils.concat([m,f]);return"0x"+_ethers.utils.keccak256(g)},ych.evm_sign1=function(e,t,n,o,r){const a=_ethers.utils.arrayify(t),i=_ethers.utils.arrayify(e),s=_ethers.utils.arrayify(o),c=_ethers.utils.hexZeroPad(_ethers.utils.hexValue(n),32),l=_ethers.utils.arrayify(c),u=_ethers.utils.hexZeroPad(_ethers.utils.hexValue(r),32),d=_ethers.utils.arrayify(u),h=_ethers.utils.concat([i,a,l,s,d]),p=_ethers.utils.keccak256(h),f=_ethers.utils.arrayify(p),m=_ethers.utils.toUtf8Bytes("Ethereum Signed Message:\n32"),g=_ethers.utils.concat([m,f]),y=_ethers.utils.keccak256(g),_=new _ethers.utils.SigningKey("0x"+ych.prvkey1).signDigest(y);return _ethers.utils.joinSignature(_)},ych.evm_next_state1=function(e,t,n,o){const r=_ethers.utils.arrayify(e),a=_ethers.utils.arrayify(t),i=_ethers.utils.hexZeroPad(_ethers.utils.hexValue(n),32),s=_ethers.utils.arrayify(i),c=_ethers.utils.hexZeroPad(_ethers.utils.hexValue(o),32),l=_ethers.utils.arrayify(c),u=_ethers.utils.concat([r,a,s,l]);return _ethers.utils.keccak256(u)}})),$((function(){console.log("Init multisig-txout"),ych.str2bytes=function(e){let t=[];for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t.push(o):o<2048?t.push(192|o>>6,128|63&o):o<55296||o>=57344?t.push(224|o>>12,128|o>>6&63,128|63&o):(n++,o=65536+((1023&o)<<10|1023&e.charCodeAt(n)),t.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|63&o))}return t},ych.privtopub=function(e,t){let n=BigInteger.fromByteArrayUnsigned(Crypto.util.hexToBytes(e)),o=EllipticCurve.getSECCurveByName("secp256k1").getG().multiply(n),r=o.getX().toBigInteger(),a=o.getY().toBigInteger(),i=EllipticCurve.integerToBytes(r,32);if(i=i.concat(EllipticCurve.integerToBytes(a,32)),i.unshift(4),1==t){let e=EllipticCurve.integerToBytes(r,32);return a.isEven()?e.unshift(2):e.unshift(3),Crypto.util.bytesToHex(e)}return Crypto.util.bytesToHex(i)},ych.user_keys_v1=function(e,t){e=ych.gui.cleanup_email(e);let n=Crypto.SHA256(Crypto.SHA256(e)+Crypto.SHA256(t));return[n,ych.privtopub(n,!0)]},ych.init_coinjs=function(e){if(coinjs.pub=[111],coinjs.priv=[239],coinjs.multisig=[196],coinjs.base32pref="",coinjs.compressed=!1,coinjs.txversion=1,coinjs.shf=0,coinjs.maxrbf=0,coinjs.txExtraTimeField=0,!(e in ych.data.coininfos))return;if("peg_t1"!=ych.data.coininfos[e].type&&"txout_t1"!=ych.data.coininfos[e].type)return;let t=ych.data.coininfos[e].cfg;if(""==t.pub)return;let n=Crypto.util.hexToBytes(t.pub),o=Crypto.util.hexToBytes(t.prv),r=Crypto.util.hexToBytes(t.msig);coinjs.pub=n,coinjs.priv=o,coinjs.multisig=r,coinjs.base32pref=t.pref,coinjs.compressed=t.comp,coinjs.txversion=t.txver,coinjs.txExtraTimeField=t.txtime,coinjs.shf=t.shf,coinjs.maxrbf=t.maxrbf},ych.txout_select_inps=function(e,t){let n=[],o=0n,r=0n,a=0n,i=0n;if(e.forEach((function(e,t){i+=e.free})),i<t)return console.log("ych_select_txouts, free",i," is less than amount",t),[n,-1,-1,-1];for(;o<t;){for(let i=0;i<e.length;i++){let s=e[i];if(i+1==e.length){n.push(s),s.selected=s.free,o+=s.free,r+=s.orders,a+=s.filled,e=e.slice(0,i);break}if(o+s.free>=t){n.push(s),s.selected=s.free,o+=s.free,r+=s.orders,a+=s.filled,e.splice(i,1);break}if(o>=t)break}if(o<t&&0==e.length)return console.log("ych_select_txouts, no fit",o,t),[n,-1,-1,-1]}return o>t&&n.length>0&&(txout=n[0],txout.selected-=o-t),[n,o,r,a]},ych.sign_txout=function(e){if(""==e.txid)return[null,"Txid is empty"];if(e.nout<0)return[null,"Nout is not valid"];const t=e.coin,n=ych.address[t];if(""==n)return[null,"Not change address"];if(!(t in ych.data.coininfos))return[null,"No coininfo"];const o=ych.data.coininfos[t],r=o.fee.minamount;if("txout_t1"!=o.type)return[null,"Not supported"];if(""==e.addr.rdsc)return[null,"Redeem script is not valid"];let a=e.free-e.selected,i=e.amount-a;i<r&&(i=r),i>e.amount&&(i=e.amount),a=e.amount-i;let s=e.amount-e.filled-a;s<r&&(s=r),s>e.amount-e.filled&&(s=e.amount-e.filled),a=e.amount-e.filled-s;let c={};if(c.txid=e.txid,c.nout=e.nout,c.amnt=e.amount,c.fill=e.filled,c.usea=e.selected,a>=r){const o=ych.sign_txout_multipos(t,e,n,a);return 0==o.length?[null,"Fail to sign change"]:(c.sigv=a,c.siga=n,c.sigs=o,c.sigf="",[c,null])}const l=ych.sign_txout_full(t,e);return 0==l.length?[null,"Fail to sign txout"]:(c.sigv=0n,c.siga="",c.sigs=[],c.sigf=l,[c,null])},ych.sign_txout_full=function(e,t){if(""==t.txid)return console.log("Txid is empty"),[];if(t.nout<0)return console.log("Nout is not valid"),[];if(!(e in ych.data.coininfos))return console.log("No coininfo",e),[];if("txout_t1"==ych.data.coininfos[e].type){if(""==t.addr.rdsc)return console.log("Redeem script is not valid"),[];ych.init_coinjs(e);let n=null;coinjs.maxrbf>0&&(n=coinjs.maxrbf-1);let o=130,r=coinjs.transaction();r.addinput(t.txid,t.nout,Crypto.util.hexToBytes(t.addr.rdsc),n,t.amount);let a=coinjs.privkey2wif(ych.prvkey1);return r.transactionSig(0,a,o)}return console.log("Not supported",e),[]},ych.sign_txout_multipos=function(e,t,n,o){if(""==t.txid)return console.log("Txid is empty"),[];if(t.nout<0)return console.log("Nout is not valid"),[];if(""==n)return console.log("Change address is empty"),[];if("bigint"!=typeof o)return console.log("Change need bigint",change),[];if(!(e in ych.data.coininfos))return console.log("No coininfo",e),[];if("txout_t1"==ych.data.coininfos[e].type){if(""==t.addr.rdsc)return console.log("Redeem script is not valid"),[];ych.init_coinjs(e);let r=null;coinjs.maxrbf>0&&(r=coinjs.maxrbf-1);let a=coinjs.privkey2wif(ych.prvkey1),i=[],s="e".repeat(64);for(let e=0;e<ych.sigi_num;e++){let c=coinjs.transaction();for(let t=0;t<e;t++){let e=0,t=[];c.addinput(s,e,Crypto.util.hexToBytes(t),null,1n),c.addoutput(n,1n)}c.addinput(t.txid,t.nout,Crypto.util.hexToBytes(t.addr.rdsc),r,t.amount),c.addoutput(n,o);let l=131,u=c.transactionSig(e,a,l);c.transactionHash(e,l);i.push(u)}return i}return console.log("Not supported",e),[]}})),$((function(){console.log("Init jui part-withdraw-crypto");let e=function(){};ych.gui.guictx["part-withdraw-crypto"]=e,e.get_input_amount=function(){return ych.gui.get_input_amount("page-withdraw-text-quantity")}})),$((function(){console.log("Init topbar"),$(".ui-dropdown").menu().hide(),$("#topbar-button-menu").click((function(e){e.preventDefault();let t=$("#"+$(this).attr("data-drop"));return $(".ui-menu:visible").not("#"+$(this).attr("data-drop")).hide(),t.toggle().position({my:"left top",at:"left bottom",of:this}),$(document).one("click",(function(){$(".ui-menu:visible").hide()})),!1})),$("#topbar-button-login").click((function(e){e.preventDefault(),window.ych_navigate("#login")})),$("#topbar-button-register").click((function(e){e.preventDefault(),window.ych_navigate("#register")})),$("#topbar-button-profile").click((function(e){e.preventDefault(),window.ych_navigate("#account"),$("#page-account-button-profile").prop("checked",!0).trigger("change")})),$("#topbar-button-helps").click((function(e){e.preventDefault(),window.open("https://support.nighttrader.exchange/")}))})),$((function(){console.log("Init page main");let e=function(){};ych.gui.pages.main=e,ych.gui.parts.main={},e.on_init=function(){},e.on_show=function(){const t=ych.data;e.update(t.groups,t.markets,t.coininfos)},e.on_login=function(){$("#topbar-button-login").hide(),$("#topbar-button-register").hide(),$("#topbar-button-wallet").show(),$("#topbar-button-profile").show()},e.on_logout=function(){$("#topbar-button-login").show(),$("#topbar-button-register").show(),$("#topbar-button-wallet").hide(),$("#topbar-button-profile").hide()},e.on_coininfo=function(e){},e.on_data_init=function(t){let n=document.getElementById("page-main-part-markets-div");{let e=document.createElement("br");n.appendChild(e)}t.groups.forEach((function(e,t){if(null===document.getElementById("page-main-part-markets-table-"+e.name)){let t=document.createElement("table");t.setAttribute("border",0),t.setAttribute("class","ytable page-main-part-markets-table"),t.setAttribute("id","page-main-part-markets-table-"+e.name);let o=document.createElement("thead");o.setAttribute("class","ytable-thead");let r=document.createElement("tr");r.setAttribute("class","ytable-head");{let t=document.createElement("th");t.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col");let n=document.createElement("b");n.appendChild(document.createTextNode(e.name)),t.appendChild(n);let o=document.createElement("span");o.setAttribute("class","page-main-part-markets-table-span-text-markets"),o.appendChild(document.createTextNode(" Markets")),t.appendChild(o),r.appendChild(t);let a=document.createElement("th");a.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),a.appendChild(document.createTextNode("Price")),r.appendChild(a);let i=document.createElement("th");i.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),i.appendChild(document.createTextNode("Ext Price")),r.appendChild(i);let s=document.createElement("th");s.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),s.appendChild(document.createTextNode("Trades")),r.appendChild(s);let c=document.createElement("th");c.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),c.appendChild(document.createTextNode("1h %")),r.appendChild(c);let l=document.createElement("th");l.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),l.appendChild(document.createTextNode("1d %")),r.appendChild(l);let u=document.createElement("th");u.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),u.appendChild(document.createTextNode("7d %")),r.appendChild(u);let d=document.createElement("th");d.setAttribute("class","ytable-hcell-70 ytable-hcell-market-col"),d.appendChild(document.createTextNode("Preview")),r.appendChild(d)}o.appendChild(r),t.appendChild(o),n.appendChild(t);let a=document.createElement("br");n.appendChild(a)}})),e.update(t.groups,t.markets,t.coininfos)},e.update=function(t,n,o){e.markets_idxs={},e.marketname_to_groups={};let r={},a={},i={},s={};t.forEach((function(e,t){a[e.name]=0,s[e.name]=[],r[e.name]=e,i[e.coinb]=e.name}));for(let t in n)e.marketname_to_groups[t]=[];let c=[];for(let e in n)c.push(n[e]);c.sort((function(e,t){return Number(e.index-t.index)})),c.forEach((function(t,n){if(t.coinb in i){const n=i[t.coinb];a[n]++,s[n].push(t),e.marketname_to_groups[t.name].push(r[n])}})),null==e.tables_inited&&(e.tables_inited={}),t.forEach((function(t,n){const o=a[t.name];t.name in e.tables_inited?$("#page-main-part-markets-table-"+t.name).table_resize(o):($("#page-main-part-markets-table-"+t.name).table_init({cols:["Pair",{name:"price",cls:"ytable-cell-r"},{name:"extprice",cls:"ytable-cell-r"},{name:"volume",cls:"ytable-cell-r"},{name:"change1h",cls:"ytable-cell-r page-main-part-markets-table-span-min"},{name:"change1d",cls:"ytable-cell-r page-main-part-markets-table-span-min"},{name:"change7d",cls:"ytable-cell-r page-main-part-markets-table-span-min"},{name:"preview",cls:"ytable-cell-r page-main-part-markets-table-span-preview"}],rows:o}),e.tables_inited[t.name]=!0),e.update_of(s[t.name])}))},e.update_of=function(t){t.forEach((function(t,n){e.markets_idxs[t.name]=n,e.update_market(t)}))},e.update_market=function(t){if(null==e.markets_idxs)return;if(null==e.marketname_to_groups)return;if(!(t.name in e.markets_idxs))return;if(!(t.name in e.marketname_to_groups))return;const n=e.marketname_to_groups[t.name];if(n.length<1)return;const o=n[0];let r=8;0!=o.digits&&(r=o.digits);const a=o.name,i=e.markets_idxs[t.name],s="#page-main-part-markets-table-"+t.coinb+"-"+i;let c="OPEN";if(c=t.service?"MAINTENANCE":t.open?"OPEN":"CLOSED",$(s+"-Pair").html("<a id='"+a+"-markets-table-"+i+"-a' href='#market-"+t.coina+"-"+t.coinb+"'>"+t.coina+'</a><br/><div class="page-main-part-markets-table-span-status">'+c+"</div>"),$(s+"-volume").html(ych.gui.format_usd_or_empty(t.volusd)),8==r?$(s+"-price").html(ych.gui.format_amount(BigInt(Math.floor(.5+t.price)))):2==r?$(s+"-price").html(ych.gui.format_usd_like("",t.price/1e8)):$(s+"-price").text(t.price.toFixed(r)),t.change1h>0?$(s+"-change1h").html('<span class="ycol080">&#9650;'+t.change1h.toFixed(2)+"%</span>"):t.change1h<0?$(s+"-change1h").html('<span class="ycol800">&#9660;'+t.change1h.toFixed(2)+"%</span>"):$(s+"-change1h").html("0.00%"),t.change1d>0?$(s+"-change1d").html('<span class="ycol080">&#9650;'+t.change1d.toFixed(2)+"%</span>"):t.change1d<0?$(s+"-change1d").html('<span class="ycol800">&#9660;'+t.change1d.toFixed(2)+"%</span>"):$(s+"-change1d").html("0.00%"),t.change7d>0?$(s+"-change7d").html('<span class="ycol080">&#9650;'+t.change7d.toFixed(2)+"%</span>"):t.change1d<0?$(s+"-change7d").html('<span class="ycol800">&#9660;'+t.change7d.toFixed(2)+"%</span>"):$(s+"-change7d").html("0.00%"),$(s+"-preview").html('<img width=300 height=50 src="/u/chart/'+t.coina+"-"+t.coinb+'/3600/preview1.png"/>'),t.coina in ych.data.coininfos&&t.coinb in ych.data.coininfos&&ych.data.coininfos[t.coinb].ext.priceext>0){let e=ych.data.coininfos[t.coina],n=ych.data.coininfos[t.coinb],o=e.ext.priceext/n.ext.priceext;8==r?$(s+"-extprice").html(ych.gui.format_amount(BigInt(Math.floor(.5+1e8*o)))+'<br/><span class="page-main-part-markets-table-span-mini">'+e.ext.nameext+"</span>"):2==r?$(s+"-extprice").html(ych.gui.format_usd_like("",o)+'<br/><span class="page-main-part-markets-table-span-mini">'+e.ext.nameext+"</span>"):$(s+"-extprice").html(o.toFixed(r)+'<br/><span class="page-main-part-markets-table-span-mini">'+e.ext.nameext+"</span>")}else $(s+"-extprice").text("-");$(s+"-a").click((function(e){e.preventDefault(),window.ych_navigate("#market-"+t.coina+"-"+t.coinb)}))},e.on_ws_market=function(t){const n=t.objects[0];e.update_market(n)},e.on_ws_markettradesupdate=function(t){const n=t.objects[1];e.update_market(n)}})),$((function(){console.log("Init page coins");let e=function(){};ych.gui.pages.coins=e,e.on_init=function(){$("#page-coins-button-back").on("click",(function(e){e.preventDefault(),window.history.back()})),$("#coininfos-table").table_init({cols:["coin",{name:"state",cls:"ytable-cell-c"},{name:"block",cls:"ytable-cell-r"},{name:"priceext",cls:"ytable-cell-r"}]})},e.on_show=function(){e.on_coininfos(ych.data.coininfos)},e.update_coininfo_row=function(t,n){e.inited&&($("#coininfos-table-"+t+"-coin").text(n.coin),0!=n.btime&&n.ops.info?$("#coininfos-table-"+t+"-block").html(n.block+" at "+ych.gui.format_date(n.btime)):$("#coininfos-table-"+t+"-block").text("-"),$("#coininfos-table-"+t+"-priceext").html(ych.gui.format_usd_full(n.ext.priceext)+" at "+ych.gui.format_date(n.ext.priceexttime)),$("#coininfos-table-"+t+"-state").text("OK"),null!=n.peg&&n.peg.R==n.coin&&$("#coininfos-table-"+t+"-state").text("peg="+n.peg.peg+"+"+n.peg.shift))},e.on_coininfos=function(t){e.inited&&($("#coininfos-table").table_clear(),ych.data.coins.forEach((function(n,o){const r=t[n];e.update_coininfo_row(o,r)})))},e.update_coininfo_in_table=function(t){if(e.inited)for(let n=0;n<ych.gui.pagesize;n++){if($("#coininfos-table-"+n+"-coin").text()==t.coin){e.update_coininfo_row(n,t);break}}},e.on_ws_coininfo=function(t){const n=t.objects[0];e.update_coininfo_in_table(n)}})),$((function(){console.log("Init page account");let e=function(){};ych.gui.pages.account=e,ych.gui.parts.account={},e.on_init=function(){console.log("account page on_init"),$("#page-account-button-profile").prop("checked",!0).trigger("change"),$("#page-account-button-back").click((function(e){e.preventDefault(),window.history.back()})),$("#page-account-part-referrals").hide(),$("#page-account-button-profile").on("change",(function(e){e.preventDefault(),$("#page-account-part-profile").show(),$("#page-account-part-referrals").hide()})),$("#page-account-button-referrals").on("change",(function(e){e.preventDefault(),$("#page-account-part-profile").hide(),$("#page-account-part-referrals").show()})),$("#page-account-button-profile-logout").click((function(e){e.preventDefault(),window.ych_gui_on_logout(),window.ych_navigate("#"),window.ych_data_init()})),e.account_table_rows=4,$("#page-account-table-profile").table_init({cols:["name","value",{name:"ops",cls:"ytable-cell-c"}],rows:e.account_table_rows}),$("#page-account-button-referrals-inv-code-copy").click((function(t){t.preventDefault(),"profile"in e&&navigator.clipboard.writeText(window.location.origin+"/#register-"+e.profile.invt)}))},e.on_data_init=function(t){e.init_referrals_table()},e.on_show=function(){e.update_account_table(e.profile)},e.on_login=function(t){if(e.profile=t,1!=e.inited)return;e.update_account_table(t);let n=0;for(coin in t.rewards){let e=t.rewards[coin];$("#page-account-table-referrals-"+coin+"-coin").text(coin),$("#page-account-table-referrals-"+coin+"-reward").html(ych.gui.format_amount(e));let o=0;if(coin in ych.data.coininfos){o=ych.data.coininfos[coin].ext.priceext}let r=Number(e)/1e8*o;n+=r,$("#page-account-table-referrals-"+coin+"-usd").html(ych.gui.format_usd_or_empty(r))}$("#page-account-table-referrals-Total-usd").html(ych.gui.format_usd_or_empty(n))},e.on_logout=function(){$("#page-account-div-txouts-expired").hide(),e.clean_account_table(),e.clean_referrals_table()},e.clean_account_table=function(){for(let t=0;t<e.account_table_rows;t++)$("#page-account-table-profile-"+t+"-name").text(" "),$("#page-account-table-profile-"+t+"-value").text(" "),$("#page-account-table-profile-"+t+"-ops").text(" ")},e.update_account_txouts_debug=function(){$("#page-account-table-profile-3-name").text("Txouts debug:"),ych.gui.prefs_txouts_debug?($("#page-account-table-profile-3-value").text("ON"),$("#page-account-table-profile-3-ops").html("<a class='ytable-a' id='page-account-table-profile-txouts-debug-a-act-off' href='/#account-txouts-debug-act-off'>Disable</a>"),$("#page-account-table-profile-txouts-debug-a-act-off").click((function(t){t.preventDefault(),ych.gui.prefs_txouts_debug=!1,e.update_account_txouts_debug(),$("#part-t-txouts").hide(),$("#part-w-txouts").hide()}))):($("#page-account-table-profile-3-value").text("OFF"),$("#page-account-table-profile-3-ops").html("<a class='ytable-a' id='page-account-table-profile-txouts-debug-a-act-on' href='/#account-txouts-debug-act-on'>Enable</a>"),$("#page-account-table-profile-txouts-debug-a-act-on").click((function(t){t.preventDefault(),ych.gui.prefs_txouts_debug=!0,e.update_account_txouts_debug(),$("#part-t-txouts").show(),$("#part-w-txouts").show()})))},e.update_account_table=function(t){e.clean_account_table(),$("#page-account-table-profile-0-name").text("Account:"),$("#page-account-table-profile-0-value").text("U-"+t.uidx),$("#page-account-table-profile-1-name").text("Login:"),$("#page-account-table-profile-1-value").text(t.user),$("#page-account-table-profile-2-name").text("2FA:"),1==t.twofa?$("#page-account-table-profile-2-value").text("ON"):$("#page-account-table-profile-2-value").text("OFF"),e.update_account_txouts_debug(),$("#page-account-div-referrals-title").text(t.title),$("#page-account-span-referrals-inv-code").text(window.location.origin+"/#register-"+t.invt)},e.init_referrals_table=function(){let e=ych.data.coins.slice();e.push("Total"),$("#page-account-table-referrals").table_init({cols:["coin",{name:"reward",cls:"ytable-cell-r"},{name:"usd",cls:"ytable-cell-r"}],rows:e}),ych.data.coins.forEach((function(e,t){$("#page-account-table-referrals-"+e+"-coin").text(e),$("#page-account-table-referrals-"+e+"-usd").html(ych.gui.format_usd_or_empty(0)),$("#page-account-table-referrals-"+e+"-reward").html(ych.gui.format_amount(0n))})),$("#page-account-table-referrals-Total-coin").html("<b>TOTAL</b>"),$("#page-account-table-referrals-Total-usd").html(ych.gui.format_usd_or_empty(0)),$("#page-account-table-referrals-Total-reward").html("")},e.clean_referrals_table=function(){$("#page-account-table-referrals").table_clear()},e.on_ws_txoutsupdate=function(e){}})),$((function(){console.log("Init page wallet");let e=function(){};ych.gui.pages.wallet=e,ych.gui.parts.wallet={},e.on_data_init=function(e){},e.on_show=function(t){e.update_expired_table()},e.on_login=function(t){e.profile=t},e.on_logout=function(){$("#page-account-div-txouts-expired").hide(),$("#page-account-table-expired").table_clear(),ych.gui.parts.wallet.balances.clean_table()},$("#topbar-button-wallet").click((function(e){e.preventDefault(),window.ych_navigate("#wallet")})),$("#page-wallet-button-back").click((function(e){e.preventDefault(),window.history.back()})),$("#page-account-table-expired").table_init({cols:["n","coin","txout","expired",{name:"amount",cls:"ytable-cell-r"},{name:"usd",cls:"ytable-cell-r"},{name:"ops",cls:"ytable-cell-c"},{name:"net-fee",cls:"ytable-cell-r"}],rows:1}),e.get_send_fees_by_inps_outs=function(e,t,n){t<1&&(t=1),n<1&&(n=1);const o=ych.data.coininfos[e],r=o.fee.txbytefee,a=o.fee.mempoolminfee;let i=10;i+=386*t,i+=34*n,i+=80,o.fee.txbyteround>1&&(i=Math.ceil(i/o.fee.txbyteround)*o.fee.txbyteround);let s=i*r*1e8+1;return s<1e8*a&&(s=1e8*a),[s,r]},e.update_expired_table=function(){$("#page-account-table-expired").table_clear();let t=0,n=0;if(null!=ych.data.profile){for(let o in ych.data.profile.txouts){let r=0,a=0n;if(o in ych.data.coininfos){let e=ych.data.coininfos[o];r=e.ext.priceext,a=e.fee.minamount}ych.data.profile.txouts[o].forEach((function(o,i){let s=o.coin;if(o.time.locked>0){let i=Number(o.amount)/1e8*r;n+=i;let c=0,l=0;[c,l]=e.get_send_fees_by_inps_outs(s,1,1),c>Number(o.amount)/10&&(c=Number(o.amount)/10);let u=c/1e8*r;$("#page-account-table-expired-"+t+"-n").text(t+1),$("#page-account-table-expired-"+t+"-coin").text(o.coin);let d=o.txid.substr(0,8)+":"+o.nout;if($("#page-account-table-expired-"+t+"-txout").html(ych.gui.format_txout_link2(o.coin,o.txid,o.nout,o.state)),$("#page-account-table-expired-"+t+"-amount").html(ych.gui.format_amount(o.amount)),$("#page-account-table-expired-"+t+"-usd").html(ych.gui.format_usd(i)),$("#page-account-table-expired-"+t+"-expired").html(ych.gui.format_date(o.time.locked)),$("#page-account-table-expired-"+t+"-net-fee").html(ych.gui.format_usd(u)),500==o.state)if(o.amount<=a)$("#page-account-table-expired-"+t+"-ops").html("<i>too small</i>");else{Date.now()/1e3>o.addr.lck1?$("#page-account-table-expired-"+t+"-ops").html("<a class='ytable-a' id='page-account-table-expired-"+t+"-a-act' href='/#account-exp-act-"+d+"'>activate2</a>"):$("#page-account-table-expired-"+t+"-ops").html("<a class='ytable-a' id='page-account-table-expired-"+t+"-a-act' href='/#account-exp-act-"+d+"'>activate1</a>")}else 700==o.state&&$("#page-account-table-expired-"+t+"-ops").text("PENDING");$("#page-account-table-expired-"+t+"-a-act").click((function(t){t.preventDefault(),e.activate_expired(o)})),t++,$("#page-account-table-expired").table_resize(t+1)}}))}$("#page-account-table-expired-"+t+"-coin").html("<b>TOTAL</b>"),$("#page-account-table-expired-"+t+"-usd").html("<b>"+ych.gui.format_usd(n)+"</b>"),$("#page-account-table-expired").table_resize(t+1),0==t?$("#page-account-div-txouts-expired").hide():$("#page-account-div-txouts-expired").show()}},e.activate_expired=function(t){ych.gui.call_with_pass1().then((n=>{if(!n.ok)return $("#page-account-text-act-err").show(),void $("#page-account-text-act-err").text(n.msg);e.activate_expired_with_pass(t)}))},e.activate_expired_with_pass=function(t){$("#page-account-text-act-err").hide();const n=t.coin;ych.init_coinjs(n);const o=coinjs.pubkeys2MultisigAddressWithBackup(t.addr.pub1,t.addr.pub2,t.addr.lck1,t.addr.lck2);let r=0,a=0;[r,a]=e.get_send_fees_by_inps_outs(n,1,1),r>Number(t.amount)/10&&(r=Number(t.amount)/10),r<1&&(r=1);const i=ych.address[n],s=t.amount-BigInt(Math.ceil(r));let c=coinjs.transaction();Date.now()/1e3>t.addr.lck1&&(c.lock_time=t.addr.lck1+1),c.addinput(t.txid,t.nout,Crypto.util.hexToBytes(o.redeemScript),null,t.amount),c.addoutput(i,s);const l=coinjs.privkey2wif(ych.prvkey1),u=c.transactionSig(0,l,131);ych.apicall({uri:"/u/recycle",data:{coin:n,txid:t.txid,nout:t.nout,addr:i,lockt:c.lock_time,amount:t.amount.toString()+"n",netfee:BigInt(Math.ceil(r)).toString()+"n",sig1:u},on_success:function(e){},on_error:function(e){$("#page-account-text-act-err").show(),$("#page-account-text-act-err").text(e)}})}})),$((function(){console.log("Init page recv");let e=function(){};ych.gui.pages.recv=e,ych.gui.parts.recv={},e.on_show=function(t){e.coin=t,e.update(t)},e.on_login=function(e){},e.on_logout=function(){$("#recv-table").table_clear(),$("#recv-table").table_col_hide("liquid"),$("#recv-table").table_col_hide("reserve"),ych.address={}},$("#page-recv-button-back").click((function(e){e.preventDefault(),window.history.back()})),$("#recv-table").table_init({cols:[{name:"n",cls:"ytable-cell-c"},"date",{name:"txout",cls:"ytable-cell-c"},{name:"amount",cls:"ytable-cell-r"},{name:"liquid",cls:"ytable-cell-r"},{name:"reserve",cls:"ytable-cell-r"},{name:"usd",cls:"ytable-cell-r"},{name:"status",cls:"ytable-cell-c"}]}),e.update_deposits_table=function(e,t){let n=!1;if(t in ych.data.coininfos){null!=ych.data.coininfos[t].peg&&(n=!0)}$("#recv-table").table_clear(),$("#recv-table").table_col_show("liquid",n),$("#recv-table").table_col_show("reserve",n),e.forEach((function(e,t){if($("#recv-table-"+t+"-n").text("D-"+e.index),$("#recv-table-"+t+"-date").html(ych.gui.format_date(e.date)),"INSTANT"==e.txid)$("#recv-table-"+t+"-txout").text(e.txid);else{e.txid.substr(0,8),e.vout;$("#recv-table-"+t+"-txout").html(ych.gui.format_txout_link1(e.coin,e.txid,e.vout,0))}$("#recv-table-"+t+"-amount").html("+"+ych.gui.format_amount(BigInt(e.amount))),e.liquid>0&&$("#recv-table-"+t+"-liquid").html("+"+ych.gui.format_amount(BigInt(e.liquid))),e.reserve>0&&$("#recv-table-"+t+"-reserve").html("+"+ych.gui.format_amount(BigInt(e.reserve))),$("#recv-table-"+t+"-usd").html(ych.gui.format_usd(e.usdext)),e.registered?$("#recv-table-"+t+"-status").text("DEPOSITED"):$("#recv-table-"+t+"-status").text("PENDING")}))},e.update=function(t){let n=[];if(""!=t&&t in ych.data.coininfos){const e=ych.data.coininfos[t];t in ych.data.profile.deposits&&(n=ych.data.profile.deposits[t],null!=e.peg&&(t==e.peg.L?n=ych.data.profile.deposits[e.peg.L]:t==e.peg.R&&(n=ych.data.profile.deposits[e.peg.R])))}null==n&&(n=[]),e.update_deposits_table(n,t)},e.show_error=function(e){$("#page-recv-evm-div-deposit-error-text").css("background-color","rgba(255,0,0,0.25)"),$("#page-recv-evm-div-deposit-error-text").text(e)},e.show_warn=function(e){$("#page-recv-evm-div-deposit-error-text").css("background-color","rgba(255,255,0,0.25)"),$("#page-recv-evm-div-deposit-error-text").text(e)},e.clear_error=function(){$("#page-recv-evm-div-deposit-error-text").css("background-color","rgba(0,0,0,0)"),$("#page-recv-evm-div-deposit-error-text").text(" ")},e.on_ws_depositaddress=function(t){const n=t.objects[0].coin;if(e.coin==n)for(let e in ych.gui.parts.recv){let t=ych.gui.parts.recv[e];if(callname="update",callname in t){(0,t[callname])(n)}}},e.on_ws_adddeposit=function(t){const n=t.objects[1].coin;n==e.coin&&e.update(n)},e.on_ws_regdeposit=function(t){const n=t.objects[1].coin;n==e.coin&&e.update(n)}})),$((function(){console.log("Init part recv-evm");let e=function(){};ych.gui.parts.recv.evm=e;let t=ych.gui.pages.recv;e.on_init=function(){$("#page-recv-evm-allow-dotslide").dot_slide("#recv-evm-allow","0.00000000",(function(t){e.allowance_to_set_max=!1,e.select_allowance_percent(t)})),$("#page-recv-evm-value-dotslide").dot_slide("#recv-evm-value","0.00000000",(function(t){e.select_deposit_percent(t)})),e.ready_stage=0},e.on_show=function(t){e.coin=t,e.account=0n,e.allowance_to_set=0n,e.allowance_to_set_max=!0,e.allowance_wei=0n,$("#page-recv-evm-text-set-allow").val("MAX"),e.deposit_ready=0n,e.deposit_to_set=0n,$("#page-recv-evm-text-quantity").val("0.00"),$("#part-recv-evm-span-coin").text(t),$("#part-recv-evm-span-desposit-addr-coin").text(t),$("#page-recv-evm-label-account").text(t),$("#page-recv-evm-label-set-allow").text(t),$("#page-recv-evm-label-ready").text(t),$("#page-recv-evm-label-quantity").text(t),$("#page-recv-evm-button-deposit").text("Deposit "+t),e.update(t,!0)},e.update=async function(t,n){const o=e.ready_stage;if(e.ready_stage=0,""==e.coin||null==e.coin)return $("#part-recv-evm-span-coin").text("-"),void $("#part-recv-evm-span-desposit-addr-coin").text("-");e.ready_stage=1;const r=ych.data.coininfos[e.coin];if("evm_t1"!=r.type&&"erc20_t1"!=r.type)return void $("#page-recv-div-addr-evm_t1").hide();if(e.ready_stage=2,!(e.coin in ych.address)||""==ych.address[e.coin])return void $("#page-recv-div-addr-evm_t1").hide();if(e.ready_stage=3,$("#page-recv-div-addr-evm_t1").show(),$("#part-recv-evm-span-coin-net").text(r.cfg.net+" Chain Id="+r.cfg.netid),$("#part-recv-evm-button-switch-net").text("Switch network to "+r.cfg.net+" Chain Id="+r.cfg.netid),void 0===window.ethereum)return $("#part-recv-evm-span-web3-detected").text("NO"),$("#page-recv-evm-span-curr-net").text("-"),void $("#part-recv-evm-div-web3-ready").hide();if(e.ready_stage=4,$("#part-recv-evm-div-web3-ready").show(),$("#part-recv-evm-span-web3-detected").text("YES"),$("#page-recv-evm-span-curr-net").text(parseInt(window.ethereum.chainId)),parseInt(window.ethereum.chainId,16)!=r.cfg.netid)return $("#part-recv-evm-button-switch-net").show(),void $("#part-recv-evm-div-net-ready").hide();e.ready_stage=5,$("#part-recv-evm-button-switch-net").hide(),$("#part-recv-evm-div-net-ready").show();let a=await e.get_ethereum_account_address();if(""==a)return $("#part-recv-evm-span-account-short").text("-"),$("#part-recv-evm-span-register-sender").text("-"),$("#part-recv-evm-button-connect-account").show(),void $("#part-recv-evm-div-account-ready").hide();e.ready_stage=6,$("#part-recv-evm-button-connect-account").hide();let i=a.substr(0,6)+"..."+a.substr(a.length-4,a.length);if($("#part-recv-evm-span-account-short").text(i),$("#part-recv-evm-span-register-sender").text(i),$("#part-recv-evm-span-unregister-sender").text(i),$("#part-recv-evm-div-account-ready").show(),"evm_t1"==r.type){$("#part-recv-evm-div-deposit-erc20").hide(),$("#part-recv-evm-div-senders").show();let t=!1;if(n||e.ready_stage!=o){const n=new _ethers.providers.Web3Provider(window.ethereum).getSigner();e.vault=new _ethers.Contract(r.cfg.con,ych.evm_abi_vault7,n);const o=await e.vault.users(a);if("0x0000000000000000000000000000000000000000"!=o&&o!=ych.address[e.coin])return $("#part-recv-evm-div-deposit-addr").hide(),$("#part-recv-evm-div-register-sender").hide(),$("#part-recv-evm-div-unregister-sender").show(),console.log("The account is bound to another user: "+o),void(t=!0);$("#part-recv-evm-div-unregister-sender").hide()}else if($("#part-recv-evm-div-unregister-sender").is(":visible"))return void(t=!0);let i=!1;ych.asset_extra[e.coin].senders.forEach((function(e,t){a==e.text&&0==e.expr&&(i=!0)}));let s=ych.asset_extra[e.coin].senders.length;if(s>0?($("#part-recv-evm-table-addrs").table_resize(s),ych.asset_extra[e.coin].senders.forEach((function(t,n){a==t.text?$("#part-recv-evm-table-addrs-"+n+"-n").text(n+1+" CURRENT"):$("#part-recv-evm-table-addrs-"+n+"-n").text(n+1),$("#part-recv-evm-table-addrs-"+n+"-sender").html(ych.gui.format_addr_link(e.coin,t.text)),$("#part-recv-evm-table-addrs-"+n+"-status").text(t.stat),$("#part-recv-evm-table-addrs-"+n+"-action").html("<a id='part-recv-evm-table-addrs-"+n+"-a' href='remove'>X</a>"),$("#part-recv-evm-table-addrs-"+n+"-a").click((function(n){n.preventDefault(),e.remove_sender_call(t.text)}))}))):($("#part-recv-evm-table-addrs").table_resize(1),$("#part-recv-evm-table-addrs-0-n").text(""),$("#part-recv-evm-table-addrs-0-sender").text("No registered senders"),$("#part-recv-evm-table-addrs-0-status").text(""),$("#part-recv-evm-table-addrs-0-a").text("")),!i)return $("#part-recv-evm-div-deposit-addr").hide(),void(t||$("#part-recv-evm-div-register-sender").show());$("#part-recv-evm-div-register-sender").hide(),$("#part-recv-evm-div-deposit-addr").show(),$("#part-recv-evm-span-deposit-addr").text(r.cfg.con)}if("erc20_t1"==r.type&&($("#part-recv-evm-div-deposit-addr").hide(),$("#part-recv-evm-div-register-sender").hide(),$("#part-recv-evm-div-unregister-sender").hide(),$("#part-recv-evm-div-senders").hide(),$("#part-recv-evm-div-deposit-erc20").show(),n||e.ready_stage!=o)){const t=r.cfg.unit,n=new _ethers.providers.Web3Provider(window.ethereum).getSigner();e.erc20=new _ethers.Contract(r.cfg.coin,ych.evm_abi_erc20,n);const o=await e.erc20.balanceOf(a),i=o.toString(),s=BigInt(i)/t;let c=r.ext.priceext;$("#page-recv-evm-allow-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(s)/1e8*c).toFixed(2)+"</span> "+ych.gui.format_amount(s)),e.account=s;const l=await e.erc20.allowance(a,r.cfg.con),u=l.toString(),d=BigInt(u)/t;e.allowance_wei=l;let h=s;l.gte(o)?($("#part-recv-evm-div-deposit-erc20-allowance").hide(),h=s):($("#part-recv-evm-div-deposit-erc20-allowance").show(),h=d),$("#page-recv-evm-value-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(h)/1e8*c).toFixed(2)+"</span> "+ych.gui.format_amount(h)),e.deposit_ready=h}},$("#part-recv-evm-table-addrs").table_init({cols:["n","sender",{name:"status",cls:"ytable-cell-c"},{name:"action",cls:"ytable-cell-c"}],rows:[]}),e.check_ethereum_netid=function(){e.update(e.coin,!1)},e.check_ethereum_netid_repeat=function(){e.check_ethereum_netid(),setTimeout((function(){e.check_ethereum_netid_repeat()}),5e3)},e.check_ethereum_netid_repeat(),$("#part-recv-evm-button-switch-net").click((function(n){n.preventDefault(),$("#part-recv-evm-button-switch-net").prop("disabled",!0);let o=ych.data.coininfos[t.coin];e.switch_ethereum_net("0x"+o.cfg.netid.toString(16))})),e.switch_ethereum_net=async function(t){await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:t}]}),$("#part-recv-evm-button-switch-net").prop("disabled",!1),setTimeout((function(){e.check_ethereum_netid()}),1e3)},$("#part-recv-evm-button-connect-account").click((function(t){t.preventDefault(),$("#part-recv-evm-button-connect-account").prop("disabled",!0),e.request_ethereum_account()})),e.get_ethereum_account_address=async function(){try{let e=await window.ethereum.request({method:"eth_accounts"});if(0==e.length)return"";if(""==e[0])return"";const t=new _ethers.providers.Web3Provider(window.ethereum);return t.getSigner().getAddress()}catch(e){}return""},e.request_ethereum_account=async function(){try{let e=await window.ethereum.request({method:"eth_requestAccounts"});if(0==e.length)return $("#part-recv-evm-span-account-short").text("<no_address>"),$("#part-recv-evm-span-register-sender").text("<no_address>"),void $("#part-recv-evm-button-connect-account").prop("disabled",!1);if(""==e[0])return $("#part-recv-evm-span-account-short").text("<no_address>"),$("#part-recv-evm-span-register-sender").text("<no_address>"),void $("#part-recv-evm-button-connect-account").prop("disabled",!1);const t=new _ethers.providers.Web3Provider(window.ethereum),n=t.getSigner().getAddress(),o=n.substr(0,6)+"..."+n.substr(n.length-4,n.length);$("#part-recv-evm-span-account-short").text(o),$("#part-recv-evm-span-register-sender").text(o)}catch(e){}$("#part-recv-evm-button-connect-account").prop("disabled",!1),e.update(e.coin,!0)},$("#part-recv-evm-button-register-sender").click((function(t){t.preventDefault(),$("#part-recv-evm-button-register-sender").prop("disabled",!0),e.register_contract_call()})),e.register_sender_call=async function(){t.clear_error(),ych.gui.call_with_pass1().then((n=>{n.ok?e.register_sender_call_with_pass():t.show_error(n.msg)}))},e.register_sender_call_with_pass=async function(){let n="",o=0n;try{let e=await window.ethereum.request({method:"eth_accounts"});if(0==e.length)return"";if(""==e[0])return"";const r=new _ethers.providers.Web3Provider(window.ethereum);o=await r.getBlockNumber()+1;const a=r.getSigner();if(n=await a.getAddress(),""==n)return void t.show_error("No selected account")}catch(e){t.show_error("Exception: "+e)}const r="register1",a=e.coin+r+ych.address[e.coin]+o.toString()+n+ych.pubkey1;ych.apicall({uri:"/u/address",digest:a,data:{coin:e.coin,call:r,user:ych.address[e.coin],blck:o,sender:n},on_success:function(e){$("#part-recv-evm-button-register-sender").prop("disabled",!1),t.clear_error()},on_error:function(e){$("#part-recv-evm-button-register-sender").prop("disabled",!1),t.show_error(e)}})},e.register_contract_call=async function(){t.clear_error(),ych.gui.call_with_pass1().then((n=>{n.ok?e.register_contract_call_with_pass():t.show_error(n.msg)}))},e.register_contract_call_with_pass=async function(){try{const n=new _ethers.providers.Web3Provider(window.ethereum),o=ych.data.coininfos[e.coin],r=n.getSigner();e.vault=new _ethers.Contract(o.cfg.con,ych.evm_abi_vault7,r);const a=await e.vault.ustate(),i=await r.getAddress(),s=Math.floor((new Date).getTime()/1e3)+o.cfg.tw,c=ych.address[e.coin],l=ych.evm_sign1(c,a,0n,i,s);await e.vault.register1(c,l,s).then((n=>{t.clear_error(),e.register_sender_call()}),(e=>{t.show_error("Error: "+e.reason)}))}catch(e){t.show_error("Exception happened"),console.log("exception:",e)}},$("#part-recv-evm-button-unregister-sender").click((function(t){t.preventDefault(),$("#part-recv-evm-button-unregister-sender").prop("disabled",!0),e.unregister1_sender_call()})),e.unregister1_sender_call=async function(){try{const n=new _ethers.providers.Web3Provider(window.ethereum),o=ych.data.coininfos[e.coin],r=n.getSigner();e.vault=new _ethers.Contract(o.cfg.con,ych.evm_abi_vault7,r);await e.vault.unregister1().then((n=>{console.log("result:",n),t.clear_error(),t.show_warn("Wait for the chain..."),e.wait_unregister1_repeat(n.hash)}),(e=>{t.show_error("Error: "+e.reason),$("#part-recv-evm-button-unregister-sender").prop("disabled",!1)}))}catch(e){console.log("exception:",e),t.show_error("Exception happened"),$("#part-recv-evm-button-unregister-sender").prop("disabled",!1)}},e.wait_unregister1_repeat=async function(n){const o=await(async e=>{const n=new _ethers.providers.Web3Provider(window.ethereum),o=await n.getTransactionReceipt(e);if(o&&o.blockNumber)return t.show_warn("Unregister1 is mined at "+o.blockNumber),o})(n);e.update(e.coin,!0),o?setTimeout((function(){t.clear_error()}),2e3):setTimeout((function(){e.wait_unregister1_repeat(n)}),5e3)},e.remove_sender_call=async function(n){t.clear_error(),ych.gui.call_with_pass1().then((o=>{o.ok?e.remove_sender_call_with_pass(n):t.show_error(o.msg)}))},e.remove_sender_call_with_pass=async function(n){try{const o=new _ethers.providers.Web3Provider(window.ethereum);let r=ych.data.coininfos[e.coin];const a=o.getSigner();e.vault=new _ethers.Contract(r.cfg.con,ych.evm_abi_vault7,a);const i=await e.vault.ustate(),s=await a.getAddress(),c=ych.address[e.coin],l=ych.evm_sign1(c,i,0n,s,0);await e.vault.unregister2(n,c,l).then((o=>{t.clear_error(),e.update(e.coin,!0),e.unregister2_sender_call(n)}),(e=>{console.log("sender_addr, user, sig",n,c,l),t.show_error("Error: "+e.reason)}))}catch(e){t.show_error("Exception happened"),console.log("exception:",e)}},e.unregister2_sender_call=async function(n){t.clear_error(),ych.gui.call_with_pass1().then((o=>{o.ok?e.unregister2_sender_call_with_pass(n):t.show_error(o.msg)}))},e.unregister2_sender_call_with_pass=async function(n){let o="",r=0n;try{let e=await window.ethereum.request({method:"eth_accounts"});if(0==e.length)return"";if(""==e[0])return"";const n=new _ethers.providers.Web3Provider(window.ethereum);r=await n.getBlockNumber()+1;const a=n.getSigner();if(o=await a.getAddress(),""==o)return void t.show_error("No selected account")}catch(e){t.show_error("Exception: "+e)}const a="unregister2",i=e.coin+a+ych.address[e.coin]+r.toString()+o+ych.pubkey1;ych.apicall({uri:"/u/address",digest:i,data:{coin:e.coin,call:a,user:ych.address[e.coin],blck:r,sender:o},on_success:function(e){t.clear_error()},on_error:function(e){t.show_error(e)}})},e.select_allowance_percent=function(n){t.clear_error();Number(e.account);const o=Number(e.account)/1e8*n/100;e.allowance_to_set=BigInt(Math.floor(.5+1e8*o)),$("#page-recv-evm-text-set-allow").val((Number(e.allowance_to_set)/1e8).toFixed(8))},$("#page-recv-evm-button-approve").click((function(t){t.preventDefault(),$("#page-recv-evm-button-approve").prop("disabled",!0),e.set_allowance_call()})),e.set_allowance_call=async function(){try{const n=new _ethers.providers.Web3Provider(window.ethereum),o=ych.data.coininfos[e.coin],r=n.getSigner();e.erc20=new _ethers.Contract(o.cfg.coin,ych.evm_abi_erc20,r);let a=e.allowance_to_set;isNaN($("#page-recv-evm-text-set-allow").val())||""==$("#page-recv-evm-text-set-allow").val()?e.allowance_to_set_max=!0:(a=BigInt(Math.floor(.5+1e8*parseFloat($("#page-recv-evm-text-set-allow").val()))),e.allowance_to_set_max=!1);let i=a*o.cfg.unit;e.allowance_to_set_max&&(i=_ethers.constants.MaxUint256);await e.erc20.approve(o.cfg.con,i).then((n=>{console.log("approve is OK"),$("#page-recv-evm-button-approve").prop("disabled",!1),t.clear_error(),t.show_warn("Wait for the chain..."),e.wait_allowance_set_repeat(_ethers.BigNumber.from(i))}),(e=>{$("#page-recv-evm-button-approve").prop("disabled",!1),t.show_error("Error: "+e.reason)}))}catch(e){$("#page-recv-evm-button-approve").prop("disabled",!1),t.show_error("Exception happened"),console.log("exception:",e)}},e.wait_allowance_set_repeat=function(n){e.update(e.coin,!0),n.eq(e.allowance_wei)?t.clear_error():setTimeout((function(){e.wait_allowance_set_repeat(n)}),5e3)},e.select_deposit_percent=function(n){t.clear_error();Number(e.deposit_ready);const o=Number(e.deposit_ready)/1e8*n/100;e.deposit_to_set=BigInt(Math.floor(.5+1e8*o)),$("#page-recv-evm-text-quantity").val((Number(e.deposit_to_set)/1e8).toFixed(8))},$("#page-recv-evm-button-deposit").click((function(t){t.preventDefault(),$("#page-recv-evm-button-deposit").prop("disabled",!0),e.deposit_erc20_call()})),e.deposit_erc20_call=async function(){t.clear_error(),ych.gui.call_with_pass1().then((n=>{n.ok?e.deposit_erc20_call_with_pass():t.show_error(n.msg)}))},e.deposit_erc20_call_with_pass=async function(){try{const n=new _ethers.providers.Web3Provider(window.ethereum),o=ych.data.coininfos[e.coin],r=n.getSigner();e.vault=new _ethers.Contract(o.cfg.con,ych.evm_abi_vault7,r);const a=await e.vault.ustate(),i=await r.getAddress();let s=e.deposit_to_set;if(isNaN($("#page-recv-evm-text-quantity").val())||""==$("#page-recv-evm-text-quantity").val())return $("#page-recv-evm-button-deposit").prop("disabled",!1),void t.show_error("Wrong amount");s=BigInt(Math.floor(.5+1e8*parseFloat($("#page-recv-evm-text-quantity").val())));const c=s*o.cfg.unit,l=ych.address[e.coin],u=ych.evm_sign1(l,a,c,i,0);await e.vault.deposit1(o.cfg.coin,c,l,u).then((n=>{console.log("result:",n),console.log("deposit is OK"),$("#page-recv-evm-button-deposit").prop("disabled",!1),t.clear_error(),t.show_warn("Wait for the chain..."),e.wait_deposit_repeat(n.hash)}),(e=>{$("#page-recv-evm-button-deposit").prop("disabled",!1),t.show_error("Error: "+e.reason)}))}catch(e){$("#page-recv-evm-button-deposit").prop("disabled",!1),t.show_error("Exception happened"),console.log("exception:",e)}},e.wait_deposit_repeat=async function(n){const o=await(async e=>{const n=new _ethers.providers.Web3Provider(window.ethereum),o=await n.getTransactionReceipt(e);if(o&&o.blockNumber)return t.show_warn("Deposit is mined at "+o.blockNumber),o})(n);e.update(e.coin,!0),o?setTimeout((function(){t.clear_error()}),2e3):setTimeout((function(){e.wait_deposit_repeat(n)}),5e3)},$("#part-recv-evm-button-copy-deposit-addr").click((function(t){t.preventDefault();let n=ych.data.coininfos[e.coin];navigator.clipboard.writeText(n.cfg.con)})),$("#page-recv-evm-button-max-allow").click((function(t){t.preventDefault(),e.allowance_to_set_max=!1,e.select_allowance_percent(100)})),$("#page-recv-evm-button-max-amount").click((function(t){t.preventDefault(),e.select_deposit_percent(100)})),e.on_ws_addressesupdate1=function(t){t.objects[0].coin==e.coin&&e.update(e.coin,!1)}})),$((function(){console.log("Init part recv-peg");let e=function(){};ych.gui.parts.recv.peg=e;ych.gui.pages.recv;e.on_show=function(t){e.coin=t,$("#page-recv-span-coin-peg").text(t),e.update(t)},e.on_logout=function(){$("#page-recv-span-addr-peg_t1").text("-"),$("#page-recv-span-addr-details-peg_t1").text("-")},e.update=function(t){if(""==e.coin)return $("#page-recv-span-addr-peg_t1").text("-"),void $("#page-recv-span-addr-details-peg_t1").text("-");let n=ych.data.coininfos[e.coin],o=(n.ext.priceext,n.ext.priceext*Number(n.fee.minamount)/1e8);"peg_t1"==n.type?($("#page-recv-div-addr-peg_t1").show(),$("#page-recv-span-addr-peg_t1").html(ych.address[e.coin]),$("#page-recv-span-addr-details-peg_t1").html('<div class="ysmall yleft"><br/>Minimum deposit: '+ych.gui.format_amount(n.fee.minamount)+", USD: "+ych.gui.format_usd(o)+"<br/></div>")):$("#page-recv-div-addr-peg_t1").hide()},$("#page-recv-button-addr-copy-peg_t1").click((function(t){t.preventDefault(),navigator.clipboard.writeText(ych.address[e.coin])}))})),$((function(){console.log("Init part recv-txout");let e=function(){};ych.gui.parts.recv.txout=e;ych.gui.pages.recv;e.on_show=function(t){e.coin=t,$("#page-recv-span-coin-txout").text(t),e.update(t)},e.on_logout=function(){$("#page-recv-span-addr-txout_t1").text("-"),$("#page-recv-span-addr-details-txout_t1").text("-")},e.update=function(t){if(""==e.coin)return $("#page-recv-span-addr-txout_t1").text("-"),void $("#page-recv-span-addr-details-txout_t1").text("-");let n=ych.data.coininfos[e.coin],o=(n.ext.priceext,n.ext.priceext*Number(n.fee.minamount)/1e8);"txout_t1"==n.type||"txout_t2"==n.type?($("#page-recv-div-addr-txout_t1").show(),0==ych.locktime1[e.coin]?($("#page-recv-span-addr-txout_t1").html(ych.address[e.coin]),$("#page-recv-span-addr-details-txout_t1").html('<div class="ysmall yleft"><br/>Minimum deposit: '+ych.gui.format_amount(n.fee.minamount)+", USD: "+ych.gui.format_usd(o)+"<br/><br/>Locktime1: none (user)<br/>Locktime2: none (exchange)</div>")):($("#page-recv-span-addr-txout_t1").html(ych.address[e.coin]),$("#page-recv-span-addr-details-txout_t1").html('<div class="ysmall yleft"><br/>Minimum deposit: '+ych.gui.format_amount(n.fee.minamount)+", USD: "+ych.gui.format_usd(o)+"<br/><br/>Locktime1: "+ych.gui.format_date(ych.locktime1[e.coin])+" (user)<br/>Locktime2: "+ych.gui.format_date(ych.locktime2[e.coin])+" (exchange)</div>"))):$("#page-recv-div-addr-txout_t1").hide()},$("#page-recv-button-addr-copy-txout_t1").click((function(t){t.preventDefault(),navigator.clipboard.writeText(ych.address[e.coin])}))})),$((function(){console.log("Init page send");let e=function(){};ych.gui.pages.send=e,ych.gui.parts.send={},e.on_show=function(t){e.coin=t,e.update()},e.on_logout=function(){},e.on_coininfo=function(e){},e.on_balance=function(e){e.coin},$("#page-send-button-back").click((function(e){e.preventDefault(),window.history.back()})),$("#page-send-button-send").click((function(t){t.preventDefault(),window.ych_navigate("#move-"+e.coin)})),$("#page-send-button-move").click((function(t){t.preventDefault(),window.ych_navigate("#move-"+e.coin)})),$("#page-send-button-withdraw").click((function(t){t.preventDefault(),window.ych_navigate("#withdraw-"+e.coin)})),e.update=function(){const t=e.coin;$("#page-send-button-send").text("Send "+t),$("#page-send-button-move").text("Transfer "+t),$("#page-send-button-withdraw").text("Withdraw "+t)}})),$((function(){console.log("Init page withdraw");let e=function(){};ych.gui.pages.withdraw=e,ych.gui.parts.withdraw={},e.on_init=function(){$("#page-withdraw-dotslide").dot_slide("#withdraw-value","0.00000000",(function(e){ych.gui.parts.withdraw.crypto.select_amount_percent(e)}))},e.on_show=function(t){const n=e.coin;e.coin=t,n!=t&&($("#page-withdraw-text-address").val(""),$("#page-withdraw-text-quantity").val("0.00"));const o=ych.data.coininfos[t],r="evm_t1"==o.type||"erc20_t1"==o.type;$("#page-withdraw-table-sends").table_col_show("timeout",r),e.coin=t,e.update()},e.on_logout=function(){$("#page-withdraw-table-sends").table_clear()},e.on_coininfo=function(e){},e.on_balance=function(t){let n=t.coin;if(n!=e.coin)return;const o=ych.data.coininfos[n].ext.priceext;$("#page-withdraw-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(t.free)/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(t.free))},$("#page-withdraw-table-sends").table_init({cols:[{name:"n",cls:"ytable-cell-c"},"date",{name:"txout",cls:"ytable-cell-c"},{name:"amount",cls:"ytable-cell-r"},{name:"usd",cls:"ytable-cell-r"},{name:"status",cls:"ytable-cell-c"},{name:"timeout",cls:"ytable-cell-c"}]}),e.update_table=function(t,n){if(n!=e.coin)return;let o=ych.data.coininfos[n];$("#page-withdraw-table-sends").table_clear(),t.forEach((function(e,t){if($("#page-withdraw-table-sends-"+t+"-n").text("W-"+e.uidx),$("#page-withdraw-table-sends-"+t+"-date").html(ych.gui.format_date(e.time.made)),$("#page-withdraw-table-sends-"+t+"-amount").html(ych.gui.format_amount(-e.vals.amount)),$("#page-withdraw-table-sends-"+t+"-usd").html(ych.gui.format_usd(e.vals.usdext)),e.time.stop>0&&($("#page-withdraw-table-sends-"+t+"-amount").html(ych.gui.format_amount_off(-e.vals.amount)),$("#page-withdraw-table-sends-"+t+"-usd").text("-")),"evm_t1"==o.type||"erc20_t1"==o.type)if(e.time.sign>0&&0==e.time.wait&&0==e.time.stop&&0==e.time.sent&&(""==e.txid||"PREPARING"==e.txid)){Math.floor((new Date).getTime()/1e3)<e.time.twin?($("#page-withdraw-table-sends-"+t+"-status").html('<button class="ui-button ui-widget ui-corner-all ybutton ybutton-micro ybutton-red ybutton-20" id="page-withdraw-table-sends-'+t+'-but-bcast">CLICK TO BROADCAST</button>'),$("#page-withdraw-table-sends-"+t+"-but-bcast").click((function(t){t.preventDefault(),ych.gui.parts.withdraw.evm.on_withdraw_bcast(e),ych.gui.parts.withdraw.evm.on_withdraw_bcast_go()}))):$("#page-withdraw-table-sends-"+t+"-status").text("TIMEOUT")}else $("#page-withdraw-table-sends-"+t+"-status").text(e.status);else $("#page-withdraw-table-sends-"+t+"-status").text(e.status);if(e.time.stop>0)$("#page-withdraw-table-sends-"+t+"-txout").text("");else if("INSTANT"==e.txid)$("#page-withdraw-table-sends-"+t+"-txout").text(e.txid);else{let n=e.txid;n.startsWith("0x")&&(n=n.substring(2)),$("#page-withdraw-table-sends-"+t+"-txout").html(ych.gui.format_txout_link1(e.coin,n,e.nout,0))}e.time.twin>0?$("#page-withdraw-table-sends-"+t+"-timeout").html(ych.gui.format_date(e.time.twin)):$("#page-withdraw-table-sends-"+t+"-timeout").text("")}))},$("#page-withdraw-button-back").click((function(e){e.preventDefault(),window.history.back()})),e.update=function(){const t=e.coin;$("#page-withdraw-label-quantity").text(t),$("#page-withdraw-label-total").text(t),$("#page-withdraw-label-free").text(t),$("#page-withdraw-label-fee").text(t),$("#page-withdraw-button-send").text("Send "+t);let n=[];if(null!=ych.data.profile&&t in ych.data.profile.withdraws&&(n=ych.data.profile.withdraws[t]),e.update_table(n,t),null!=ych.data.profile&&t in ych.data.profile.balances){const e=ych.data.profile.balances[t],n=ych.data.coininfos[t].ext.priceext;$("#page-withdraw-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(e.free)/1e8*n).toFixed(2)+"</span> "+ych.gui.format_amount(e.free))}else $("#page-withdraw-dotslide").dot_slide_max_html("")},e.on_ws_addwithdraw=function(t){const n=t.objects[1],o=n.coin;if(n.coin!=e.coin)return;const r=ych.data.profile.withdraws[o];e.update_table(r,o)},e.on_ws_regwithdraw=function(t){const n=t.objects[1],o=n.coin;if(n.coin!=e.coin)return;const r=ych.data.profile.withdraws[o];e.update_table(r,o);const a=ych.data.coininfos[n.coin];"evm_t1"!=a.type&&"erc20_t1"!=a.type||ych.gui.parts.withdraw.evm.on_withdraw_bcast(n)}})),$((function(){console.log("Init part withdraw-evm");let e=function(){};ych.gui.parts.withdraw.evm=e,e.on_show=function(t){e.coin=t,e.now_waiting=!1,e.now_sending=!1,$("#form-web3-span-coin").text(t),e.update()},e.update=async function(){if(""==e.coin||null==e.coin)return $("#form-web3-span-coin").text("-"),void $("#form-web3-evm-span-send-coin").text("-");const t=ych.data.coininfos[e.coin];t.ext.priceext,t.ext.priceext,Number(t.fee.minamount);if("evm_t1"!=t.type&&"erc20_t1"!=t.type)return $("#form-web3-div-addr-evm_t1").hide(),void $("#form-web3-button-bcast").prop("disabled",!0);if(!(e.coin in ych.address)||""==ych.address[e.coin])return $("#form-web3-div-addr-evm_t1").hide(),void $("#form-web3-button-bcast").prop("disabled",!0);if($("#form-web3-div-addr-evm_t1").show(),$("#form-web3-span-net-name").text(t.cfg.net+" Chain Id="+t.cfg.netid),$("#form-web3-but-switch-net").text("Switch network to "+t.cfg.net+" Chain Id="+t.cfg.netid),void 0===window.ethereum)return $("#form-web3-span-provider-detected").text("NO"),$("#form-web3-span-provider-chainid").text("-"),$("#form-web3-div-provider").hide(),void $("#form-web3-button-bcast").prop("disabled",!0);if($("#form-web3-div-provider").show(),$("#form-web3-span-provider-detected").text("YES"),$("#form-web3-span-provider-chainid").text(parseInt(window.ethereum.chainId)),parseInt(window.ethereum.chainId,16)!=t.cfg.netid)return $("#form-web3-but-switch-net").show(),$("#form-web3-div-account").hide(),void $("#form-web3-button-bcast").prop("disabled",!0);$("#form-web3-but-switch-net").hide(),$("#form-web3-div-account").show();let n=await e.get_ethereum_account_address();if(""==n)return $("#form-web3-span-account").text("-"),$("#form-web3-but-connect-account").show(),void $("#form-web3-button-bcast").prop("disabled",!0);$("#form-web3-but-connect-account").hide();let o=n.substr(0,6)+"..."+n.substr(n.length-4,n.length);$("#form-web3-span-account").text(o),$("#form-web3-button-bcast").prop("disabled",!1)},e.check_ethereum_netid=function(){e.update(e.coin)},e.check_ethereum_netid_repeat=function(){e.check_ethereum_netid(),setTimeout((function(){e.check_ethereum_netid_repeat()}),5e3)},e.check_ethereum_netid_repeat(),$("#form-web3-but-switch-net").click((function(t){t.preventDefault(),$("#form-web3-but-switch-net").prop("disabled",!0);const n=ych.data.coininfos[e.coin];e.switch_ethereum_net("0x"+n.cfg.netid.toString(16))})),e.switch_ethereum_net=async function(t){await window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:t}]}),$("#form-web3-but-switch-net").prop("disabled",!1),setTimeout((function(){e.check_ethereum_netid()}),1e3)},$("#form-web3-but-connect-account").click((function(t){t.preventDefault(),$("#form-web3-but-connect-account").prop("disabled",!0),e.request_ethereum_account()})),e.get_ethereum_account_address=async function(){try{let e=await window.ethereum.request({method:"eth_accounts"});if(0==e.length)return"";if(""==e[0])return"";const t=new _ethers.providers.Web3Provider(window.ethereum);return t.getSigner().getAddress()}catch(e){}return""},e.request_ethereum_account=async function(){try{let e=await window.ethereum.request({method:"eth_requestAccounts"});if(0==e.length)return $("#form-web3-span-account").text("<no_address>"),void $("#form-web3-but-connect-account").prop("disabled",!1);if(""==e[0])return $("#form-web3-span-account").text("<no_address>"),void $("#form-web3-but-connect-account").prop("disabled",!1);const t=new _ethers.providers.Web3Provider(window.ethereum),n=t.getSigner().getAddress(),o=n.substr(0,6)+"..."+n.substr(n.length-4,n.length);$("#form-web3-span-account").text(o)}catch(e){}$("#form-web3-but-connect-account").prop("disabled",!1)},e.clear_error=function(){$("#form-web3-box-err").css("background-color","rgba(0,0,0,0)"),$("#form-web3-box-err").text(" ")},e.show_error=function(e){$("#form-web3-box-err").css("background-color","rgba(255,0,0,0.25)"),$("#form-web3-box-err").text(e)},e.dialog_web3_wait=$("#form-web3-wait").dialog({autoOpen:!1,height:300,width:500,modal:!0,buttons:[{text:"Close",click:function(){console.log("xxxy"),e.now_waiting=!1,e.dialog_web3_wait.dialog("close")}}],close:function(){e.form_web3_wait[0].reset(),e.now_waiting=!1}}),e.form_web3_wait=e.dialog_web3_wait.find("form").on("submit",(function(t){t.preventDefault(),e.dialog_web3_wait.dialog("close"),e.now_waiting=!1})),e.on_withdraw_wait=async function(t){if(e.now_sending)return;if(e.now_waiting)return;const n=ych.data.coininfos[t.coin].ext.priceext;$("#form-web3-wait-div-receiver").text(t.addr),$("#form-web3-wait-span-quantity-coin").text(t.coin),$("#form-web3-wait-div-quantity").html(ych.gui.format_amount(t.vals.amount)),$("#form-web3-wait-div-usd").html(ych.gui.format_usd((Number(t.vals.amount)/1e8*n).toFixed(2))),e.now_waiting=!0,e.now_sending_withdraw=t,e.dialog_web3_wait.dialog("option","title","Wait. Preparing to broadcast: withdraw-"+t.gidx),e.dialog_web3_wait.dialog("open")},e.dialog_web3=$("#form-web3").dialog({autoOpen:!1,height:400,width:500,modal:!0,buttons:[{id:"form-web3-button-bcast",text:"Broadcast Transaction",class:"ui-button ui-widget ui-corner-all ybutton",click:function(){e.on_withdraw_bcast_go()}},{text:"Cancel the withdraw",click:function(){e.cancel_withdraw_go()}}],close:function(){e.form_web3[0].reset(),e.now_sending=!1}}),e.form_web3=e.dialog_web3.find("form").on("submit",(function(t){t.preventDefault(),e.dialog_web3.dialog("close"),e.now_sending=!1})),e.on_withdraw_bcast=async function(t){if(e.now_waiting&&(e.dialog_web3_wait.dialog("close"),e.now_waiting=!1),t.time.wait>0)return void(e.now_sending&&(e.dialog_web3.dialog("close"),e.now_sending=!1));if(t.time.sent>0||"PREPARING"!=t.txid&&""!=t.txid)return console.log("x1"),void(e.now_sending&&(e.dialog_web3.dialog("close"),e.now_sending=!1));if(Math.floor((new Date).getTime()/1e3)>t.time.twin)return console.log("x2"),void(e.now_sending&&(e.dialog_web3.dialog("close"),e.now_sending=!1));if(e.now_sending)return void console.log("x3");const n=ych.data.coininfos[t.coin].ext.priceext;$("#form-web3-div-receiver").text(t.addr),$("#form-web3-span-quantity-coin").text(t.coin),$("#form-web3-div-quantity").html(ych.gui.format_amount(t.vals.amount)),$("#form-web3-div-usd").html(ych.gui.format_usd((Number(t.vals.amount)/1e8*n).toFixed(2))),e.now_sending=!0,e.now_sending_withdraw=t,e.update(t.coin),e.dialog_web3.dialog("option","title","Ready to broadcast: withdraw-"+t.gidx),e.dialog_web3.dialog("open")},e.on_withdraw_bcast_go=async function(){const t=e.now_sending_withdraw;console.log("withdraw:",t);try{console.log("x1");const n=new _ethers.providers.Web3Provider(window.ethereum),o=ych.data.coininfos[e.coin],r=n.getSigner();e.vault=new _ethers.Contract(o.cfg.con,ych.evm_abi_vault7,r),console.log("x2");const a=ych.address[e.coin];console.log("x3");const i=o.cfg.unit,s=t.addr,c=t.inps[0].sig2;let l=[];t.inps.forEach((function(e,t){const n=e.addr,o=e.usea*i,r=e.sigr;let a=e.sigv*i,s=e.sig1;""==s&&(s="0x",a=0n);const c=[n,o,s,r,a];l.push(c)}));const u=t.time.twin;console.log("x4"),e.now_sending=!0,console.log("CALL:",o.cfg.coin,a,s,l,c,u);await e.vault.withdraw1(o.cfg.coin,a,s,l,c,u).then((n=>{console.log("res1:",n),ych.apicall({uri:"/u/withdraw_evm_txid",data:{coin:e.coin,gidx:t.gidx,txid:n.hash},on_success:function(t){e.clear_error(),e.dialog_web3.dialog("close"),e.now_sending=!1},on_error:function(t){e.show_error(t)}})}),(t=>{e.show_error("Error: "+t.reason),console.log(t)}))}catch(t){e.show_error("Exception happened"),console.log("exception:",t)}},e.cancel_withdraw_go=async function(){e.clear_error(),ych.gui.call_with_pass1().then((t=>{t.ok?e.cancel_withdraw_go_with_pass():e.show_error(t.msg)}))},e.cancel_withdraw_go_with_pass=async function(){const t=e.now_sending_withdraw;console.log("cancel_withdraw_go",t);const n=e.coin+t.gidx+ych.pubkey1;ych.apicall({uri:"/u/nowithdraw",digest:n,data:{coin:e.coin,gidx:t.gidx},on_success:function(t){e.dialog_web3.dialog("close"),e.now_sending=!1},on_error:function(t){e.show_error(t)}})}})),$((function(){console.log("Init part withdraw-crypto");let e=function(){};ych.gui.parts.withdraw.crypto=e,e.on_init=function(t){console.log("guictx",t),e.guictx=t},e.on_show=function(t){e.mode="reduce",e.free=0n,e.sendfee=0n,e.datatag=0n,e.datatag_calc=0n,e.op1=e.makeop(),e.op2=e.makeop(),e.op3=e.makeop();"txout_t1"==ych.data.coininfos[t].type&&(e.datatag_calc=1n),e.update_gui(t),e.coin=t,e.update()},e.on_coininfo=function(t){t.coin==e.coin&&e.update()},e.on_balance=function(t){t.coin==e.coin&&e.update()},e.on_txouts=function(t){t.coin==e.coin&&(e.debit_txouts_num=0,e.debit_txouts_val=0n,e.debit_txouts_credit=0n,e.debit_txouts_serv=[],e.debit_txouts_known=!1,e.debit_txouts_for_debit=0n,e.update())},e.trace=function(e,t){},e.stabilize_op=function(t){e.trace("stabilize_op",t);let n=0n;const o=ych.data.coininfos[e.coin];"txout_t1"==o.type&&(n=o.fee.minamount);let r=t.stabilize(o,n);return e.trace("stabilize_op end",t),null!=r?r:null},e.update=function(){if(null==ych.data.profile)return;e.datatag=0n,0n!=e.op2.amount_inp&&(e.datatag=e.datatag_calc),e.op2.reduce_mode="reduce"==e.mode,e.op3.reduce_mode=!0,e.update_txout_debit_virtual(),e.set_txouts(),e.show_ready_amount();let t=e.op1.select1(e.sendfee,e.op2);return null!=t?e.show_error_and_refresh(t):(t=e.select_txouts2(),null!=t?e.show_error_and_refresh(t):(t=e.stabilize_op(e.op2),null!=t?e.show_error_and_refresh(t):(e.validate_aux_addresses()&&("reduce"==e.mode&&$("#page-withdraw-text-quantity").val((Number(e.op2.amount_out)/1e8).toFixed(8)),e.validate_all_q()&&e.show_ready()),void e.refresh_gui())))},e.select_amount_percent=function(t){e.clear_error();const n=ych.data.coininfos[e.coin],o=(Number(e.free),Number(e.free)/1e8*t/100);e.op1.amount_inp=BigInt(Math.floor(.5+1e8*o)),e.op2.amount_inp=BigInt(Math.floor(.5+1e8*o)),e.datatag=0n,0n!=e.op2.amount_inp&&(e.datatag=e.datatag_calc),e.sendfee=BigInt(Math.floor(.5+o*n.fee.withfee*1e8)),e.mode="reduce",e.op2.reduce_mode=!0,e.op3.reduce_mode=!0,e.refresh_table_txouts1();let r=e.op1.select1(e.sendfee,e.op2);return null!=r?e.show_error_and_refresh(r):(r=e.select_txouts2(),null!=r?e.show_error_and_refresh(r):(r=e.stabilize_op(e.op2),null!=r?e.show_error_and_refresh(r):(e.validate_aux_addresses()&&($("#page-withdraw-text-quantity").val((Number(e.op2.amount_out)/1e8).toFixed(8)),e.validate_all_q()&&e.show_ready()),void e.refresh_gui())))},e.edit_quantity=function(){if(e.clear_error(),!e.validate_quantity())return;e.op1.amount_inp=e.guictx.get_input_amount(),e.op2.amount_inp=e.guictx.get_input_amount(),e.datatag=0n,0n!=e.op2.amount_inp&&(e.datatag=e.datatag_calc);const t=ych.data.coininfos[e.coin],n=Number(e.op1.amount_inp)/1e8;e.sendfee=BigInt(Math.floor(.5+n*t.fee.withfee*1e8)),e.mode="manual",e.op2.reduce_mode=!1,e.op3.reduce_mode=!0,e.refresh_table_txouts1();let o=e.op1.select1(e.sendfee,e.op2);return null!=o?e.show_error_and_refresh(o):(o=e.select_txouts2(),null!=o?e.show_error_and_refresh(o):(o=e.stabilize_op(e.op2),null!=o?e.show_error_and_refresh(o):(e.validate_aux_addresses()&&e.validate_all_q()&&e.show_ready(),void e.refresh_gui())))},e.update_txout_debit_virtual=function(){let t=0n,n=0n;if(e.coin in ych.data.profile.balances){const o=ych.data.profile.balances[e.coin];t=o.debit,n=o.ordersindebit}e.txout_debit_virtual={gidx:1,cidx:1,coin:e.coin,hold:2,state:500,addr:{vers:1,host:"",addr:ych.address[e.coin],pub1:ych.pubkey3,pub2:ych.pubkey2,lck1:0,lck2:0,pksc:"",rdsc:"00"},txid:ych.zerotxid,nout:0,free:t-n,orders:0n,amount:t-n,filled:0n,selected:0n};"peg_t1"==ych.data.coininfos[e.coin].type&&(e.txout_debit_virtual.amount=t,e.txout_debit_virtual.orders=0n,e.txout_debit_virtual.filled=n)},e.set_txouts=function(){e.set_txouts_user(e.op1),e.set_txouts_debit(e.op1),e.op1.make_id2idx(),e.free=0n,e.op1.txouts.forEach((function(t,n){e.free+=t.free})),e.set_txouts_user(e.op2),e.set_txouts_debit(e.op2),e.op2.make_id2idx()},e.set_txouts_user=function(t){e.coin in ych.data.profile.txouts?(t.txouts_user=JSON.parse(JSON.stringify(ych.data.profile.txouts[e.coin],((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),jsonBNparse),t.txouts_user=t.txouts_user.filter((e=>400==e.state)),t.txouts_user.sort((function(e,t){return Number(t.free-e.free)})),t.txouts=t.txouts_user):t.txouts_user=[]},e.set_txouts_debit=function(t){if(!(e.coin in ych.data.profile.balances))return;const n=ych.data.profile.balances[e.coin];if(n.debit<=0)return;t.txouts_debit=[];const o=ych.data.coininfos[e.coin];if("peg_t1"!=o.type&&"evm_t1"!=o.type&&"txout_t1"!=o.type&&"erc20_t1"!=o.type)return;0n!=n.debit-n.ordersindebit&&(t.txouts_debit=JSON.parse(JSON.stringify([e.txout_debit_virtual],((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),jsonBNparse),t.txouts=t.txouts.concat(t.txouts_debit))},e.select_txouts2=function(){if("reduce"==e.mode){let t=0n;e.op2.txouts.forEach((function(e){t+=e.free})),t<e.op2.amount_inp&&(e.op2.amount_inp=t)}let t=e.op2.select2(e.op2.amount_inp);return null!=t?t:("reduce"==e.mode?e.op2.reduce(e.datatag):e.op2.change-=e.datatag,null)},e.validate_inputs_outputs_q=function(){e.clear_error();let t=0n;e.op2.selected.forEach((function(e,n){t+=e.amount}));let n=e.op2.amount_out+e.op2.change+e.op2.credit+e.datatag+e.op2.netfee;return t==n||(e.show_error("Can not configure inputs(6), change the quantity"),!1)},e.validate_quantity=function(){return e.clear_error(),!isNaN($("#page-withdraw-text-quantity").val())&&""!=$("#page-withdraw-text-quantity").val()||(e.show_error("Quantity is not a number"),!1)},e.validate_quantity_q=function(){return!isNaN($("#page-withdraw-text-quantity").val())&&""!=$("#page-withdraw-text-quantity").val()},e.validate_address1=function(t,n){if(""==t)return!1;const o=ych.data.coininfos[e.coin];if("txout_t1"==o.type){ych.init_coinjs(e.coin);try{let o=coinjs.addressDecode(t);if(0==o)return n&&e.show_error("Address is not recognized(1)"),!1;if("other"==o.type)return n&&e.show_error("Address is not recognized(2)"),!1}catch(e){return!1}}if("peg_t1"==o.type){ych.init_coinjs(e.coin);try{let o=coinjs.addressDecode(t);if(0==o)return n&&e.show_error("Address is not recognized(1)"),!1;if("bech32"==o.type)return n&&e.show_error("Address type bech32 is not supported"),!1;if("other"==o.type)return n&&e.show_error("Address is not recognized(2)"),!1}catch(e){return!1}}return!!("evm_t1"!=o.type&&"erc20_t1"!=o.type||_ethers.utils.isAddress(t))||(n&&e.show_error("Address is not recognized"),!1)},e.validate_address=function(){e.clear_error();let t=$("#page-withdraw-text-address").val();return!!e.validate_address1(t,!0)&&(e.validate_all_q()&&e.show_ready(),!0)},e.validate_address_q=function(){let t=$("#page-withdraw-text-address").val();return e.validate_address1(t,!1)},e.validate_totals_q=function(){if(e.op2.amount_inp<=0n)return!1;if(e.op2.amount_out<=0n)return!1;let t=0n;e.op2.selected.forEach((function(e,n){t+=e.amount}));let n=e.op2.amount_out+e.op2.change+e.op2.credit+e.datatag+e.op2.netfee;return t==n},e.validate_aux_addresses=function(){{let t=ych.address[e.coin];if(!e.validate_address1(t,!0))return!1}if("txout_t1"==ych.data.coininfos[e.coin].type){let t=coinjs.pubkeys2MultisigAddressWithBackup(ych.pubkey3,ych.pubkey2,0,0);if(!e.validate_address1(t.address,!0))return!1}return!0},e.validate_all_q=function(){return!!e.validate_inputs_outputs_q()&&(!!e.validate_quantity_q()&&(!!e.validate_address_q()&&!!e.validate_totals_q()))},$("#page-withdraw-text-address").on("input",e.validate_address),$("#page-withdraw-text-quantity").on("input",e.edit_quantity),e.make_tx=function(t){e.addr_send=$("#page-withdraw-text-address").val(),e.addr_change=ych.address[e.coin],e.addr_credit="";if("txout_t1"==ych.data.coininfos[e.coin].type){ych.init_coinjs(e.coin);let o=null;coinjs.maxrbf>0&&(o=coinjs.maxrbf-1);let r=coinjs.transaction();for(let e=0;e<t.selected.length;e++){let n=t.selected[e],a=coinjs.pubkeys2MultisigAddressWithBackup(n.addr.pub1,n.addr.pub2,n.addr.lck1,n.addr.lck2),i=o;2==n.hold&&(i=n.nseq),r.addinput(n.txid,n.nout,Crypto.util.hexToBytes(a.redeemScript),i,n.amount)}t.amount_out>0n&&r.addoutput(e.addr_send,t.amount_out),t.change>0n&&r.addoutput(e.addr_change,t.change);let a=coinjs.pubkeys2MultisigAddressWithBackup(ych.pubkey3,ych.pubkey2,0,0);e.addr_credit=a.address,t.credit>0n&&r.addoutput(e.addr_credit,t.credit);let i=[];t.selected.forEach((function(e){let t=Crypto.util.hexToBytes(e.txid).reverse();for(let e=0;e<t.length;e++)i.push(t[e]);let n=coinjs.numToBytes(e.nout);for(let e=0;e<n.length;e++)i.push(n[e])})),i.push("L".charCodeAt(0));for(let t=0;t<e.addr_send.length;t++)i.push(e.addr_send.charCodeAt(t));let s=coinjs.numToBytes(Number(t.amount_out));for(let e=0;e<s.length;e++)i.push(s[e]);console.log("Notary buf:",Crypto.util.bytesToHex(i));var n=Crypto.SHA256(Crypto.SHA256(i,{asBytes:!0}),{asBytes:!0});let c="XCH:0:"+Crypto.util.bytesToHex(n.reverse());console.log("Notary:",c),r.adddata(Crypto.util.bytesToHex(ych.str2bytes(c)),1),t.rawtx=r.serialize(),t.tx=r}},$("#page-withdraw-button-preview").click((function(t){t.preventDefault(),e.make_tx(e.op2),$("#form-tx-preview-textarea-rawtx").val(e.op2.rawtx),ych.gui.forms["send-crypto-preview1"].exec()})),$("#page-withdraw-button-send").click((function(t){t.preventDefault(),e.clear_error(),ych.gui.call_with_pass1().then((t=>{t.ok?e.make_withdraw(e.op1,e.op2):e.show_error(t.msg)}))})),e.make_withdraw=function(t,n){const o=ych.data.coininfos[e.coin];e.make_tx(n),ych.init_coinjs();const r=coinjs.privkey2wif(ych.prvkey1),a=Math.floor((new Date).getTime()/1e3)+o.cfg.tw,i=BigInt(a);let s=[],c=[],l="",u="";if("txout_t1"==o.type){for(let n=0;n<t.selected.length;n++){const o=t.selected[n];l+=o.txid+":"+o.nout,l+=o.filled.toString(),l+=o.selected.toString();const[r,a]=ych.sign_txout(o);if(null!=a)return void e.show_error(a);s.push(r)}console.log(n.tx);for(let t=0;t<n.selected.length;t++){const o=n.selected[t];u+=o.txid+":"+o.nout,u+=o.filled.toString(),u+=o.selected.toString();let a="",i="",s=0n;ych.init_coinjs(e.coin);const l=1;a=n.tx.transactionSig(t,r,l);const d=n.tx.transactionHash(t,l);console.log(t,"S:",a.slice(0,10),"P:",ych.pubkey1.slice(0,10),"H:",d.slice(0,10));let h={};h.txid=o.txid,h.nout=o.nout,h.amnt=o.amount,h.fill=o.filled,h.usea=o.selected,h.sigf=a,h.sign=i,h.sigv=s,c.push(h)}}if("peg_t1"==o.type)for(let e=0;e<n.selected.length;e++){const t=n.selected[e];u+=t.txid+":"+t.nout,u+=t.filled.toString(),u+=t.selected.toString();let o="",r="",a=0n,i={};i.txid=t.txid,i.nout=t.nout,i.amnt=t.amount,i.fill=t.filled,i.usea=t.selected,i.sigf=o,i.sign=r,i.sigv=a,c.push(i)}if("evm_t1"==o.type||"erc20_t1"==o.type){const r=o.cfg.unit;for(let n=0;n<t.selected.length;n++){const o=t.selected[n];l+=o.txid+":"+o.nout,l+=o.filled.toString(),l+=o.selected.toString();const a="0x"+o.txid,i=o.orders+o.filled+o.selected,c=i*r,u=[ych.evm_sign1(ych.address[e.coin],a,c,ych.evm_zeroaddr,o.nout+1)];let d={};d.txid=o.txid,d.nout=o.nout,d.amnt=o.amount,d.fill=o.filled,d.usea=o.selected,d.sigf="",d.sigv=i,d.sigs=u,s.push(d)}console.log("op2 inputs:",n.selected);let d=null,h=null,p=0,f=0;if(n.selected.forEach((function(e,t){e.txid==ych.zerotxid?(f++,h=e):(p++,d=e)})),p>1)return void e.show_error("More than one state: unfinished chain operations, try later");if(f>1)return void e.show_error("More than one debit, error");n.selected.forEach((function(t,n){u+=t.txid+":"+t.nout,u+=t.filled.toString(),u+=t.selected.toString();let o="",s="",l=0n;if(t.txid==ych.zerotxid);else{l=t.selected;const n=t.selected*r,c="0x"+t.txid;o=ych.evm_sign1(ych.address[e.coin],c,n,e.addr_send,a),console.log(ych.address[e.coin],c,n,e.addr_send,a);const u=(0,ych.evm_next_state1)(c,e.addr_send,n,i);console.log("state2:",u);const d=(t.orders+t.filled)*r;s=ych.evm_sign1(ych.address[e.coin],u,d,ych.evm_zeroaddr,t.nout+1)}let d={};d.txid=t.txid,d.nout=t.nout,d.amnt=t.amount,d.fill=t.filled,d.usea=t.selected,d.sigf=o,d.sign=s,d.sigv=l,d.sigs=[],c.push(d)}))}let d=e.coin+e.addr_send+e.addr_credit+e.addr_change+n.amount_out.toString()+n.debit.toString()+n.credit.toString()+n.change.toString()+n.netfee.toString()+e.sendfee.toString()+l+u+ych.pubkey1;const h=e.coin,p=e.addr_send,f=n.amount_out;ych.apicall({uri:"/u/withdraw",digest:d,data:{coin:e.coin,addr_send:e.addr_send,addr_credit:e.addr_credit,addr_change:e.addr_change,value_send:n.amount_out,value_debit:n.debit,value_credit:n.credit,value_change:n.change,value_netfee:n.netfee,value_sendfee:e.sendfee,usetxouts1:s,usetxouts2:c,twin:i},on_success:function(t){if("txouts"==t.step){console.log("txouts STEP"),e.set_txouts_user(e.op3),e.op3.txouts_debit=t.txouts,e.op3.txouts=e.op3.txouts.concat(e.op3.txouts_debit),e.op3.make_id2idx(),console.log("part.op3 x0",e.op3);let n=e.op3.select3(e.op2.amount_out);if(null!=n)return e.show_error_and_refresh(n);if(console.log("part.op3 x1",e.op3),e.op3.change>0n?e.op3.change-=e.datatag:e.op3.reduce(e.datatag),console.log("part.op3 x2",e.op3),n=e.stabilize_op(e.op3),console.log("part.op3 stabilize_op err:",n),null!=n)return e.show_error_and_refresh(n);console.log("part.op3 x3",e.op3),e.refresh_gui(),ych.gui.forms["send-adj"].exec().then((t=>{console.log("res:",t),t.ok&&e.make_withdraw(e.op1,e.op3)}))}else if(e.clear_error(),$("#page-withdraw-text-address").val(""),$("#page-withdraw-text-quantity").val("0.0"),e.edit_quantity(),"evm_t1"==o.type||"erc20_t1"==o.type){let e={};e.gidx=t.gidx,e.coin=h,e.addr=p,e.vals={},e.vals.amount=f,ych.gui.parts.withdraw.evm.on_withdraw_wait(e)}},on_error:function(t){e.show_error(t)}})}})),$((function(){console.log("Init part withdraw-crypto-op"),ych.gui.parts.withdraw.crypto.makeop=function(){let e={reduce_mode:!1,amount_inp:0n,amount_out:0n,txouts:[],txouts_user:[],txouts_debit:[],txout_id_to_idx:{},selected:[],unselected:[],netfee:0n,debit:0n,change:0n,credit:0n,num_inps:0,num_outs:0,tx:{},rawtx:"",select1:function(t,n){if(e.selected=[],e.txouts.forEach((function(e){e.selected=0n})),1==e.txouts_debit.length){let n=e.txouts_debit[0];if(n.free>0n){let o=n.free;o>t&&(o=t),n.selected=o,e.selected.push(n),t-=o}}if(t>0n){let n=[...e.txouts_user];n.sort((function(e,t){return Number(e.free-t.free)}));{let e=0n;if(n.forEach((function(t,n){e+=t.free})),e<t)return console.log("txouts_free < amount",e,t),"Not enough available for withdraw"}let o=0n;for(;o<t;)for(let r=0;r<n.length;r++){let a=n[r];if(r+1==n.length){e.selected.push(a);let i=a.free;o+i>t&&(i=t-o),a.selected=i,o+=a.free,n=n.slice(0,r);break}if(o+a.free>=t){e.selected.push(a);let i=a.free;o+i>t&&(i=t-o),a.selected=i,o+=a.free,n.splice(r,1);break}if(o>=t)break}}return e.make_unselected(),e.use2credit(n),null},make_id2idx:function(){e.txout_id_to_idx={},e.txouts.forEach((function(t,n){const o=t.txid+":"+t.nout;e.txout_id_to_idx[o]=n}))},make_unselected:function(){let t={};e.selected.forEach((function(n){let o=n.txid+":"+n.nout;t[o]=!0,e.credit+=n.filled;const r=n.amount-n.selected-n.filled;e.change+=r})),e.unselected=[],e.txouts.forEach((function(n){n.txid+":"+n.nout in t||e.unselected.push(n)}))},use2credit:function(t){return e.selected.forEach((function(e,n){const o=e.txid+":"+e.nout;if(!(o in t.txout_id_to_idx))return;const r=t.txout_id_to_idx[o];let a=t.txouts[r];a.txid==ych.zerotxid?(a.free=e.free-e.selected,a.amount=e.amount-e.selected):(a.free=e.free-e.selected,a.filled=e.filled+e.selected)})),null},select2:function(t){e.selected=[],e.amount_inp=t,e.amount_out=t,e.debit=0n,e.credit=0n,e.change=0n,e.netfee=0n,e.txouts.forEach((function(e){e.selected=0n}));let n=[...e.txouts_user];n.sort((function(e,t){return Number(e.free-t.free)}));let o=0n,r=t,a=0n;n.forEach((function(e){a+=e.free})),r>a&&(o=r-a,r=a);let i=!1;if(o>0n){let t=o;if(1==e.txouts_debit.length){let n=e.txouts_debit[0];if(n.free>0n){let o=n.free;o>t&&(o=t),n.selected=o,e.selected.push(n),t-=o,i=!0}}if(t>0n)return"Not enough available for withdraw"}let s=r,c=0n;for(;c<s;){for(let t=0;t<n.length;t++){let o=n[t];if(t+1==n.length){e.selected.push(o);let r=o.free;c+r>s&&(r=s-c),o.selected=r,c+=o.free,n=n.slice(0,t);break}if(c+o.free>=s){e.selected.push(o);let r=o.free;c+r>s&&(r=s-c),o.selected=r,c+=o.free,n.splice(t,1);break}if(c>=s)break}if(0==n.length)break}return c<s?"Not enough available for withdraw":(e.make_unselected(),null)},select3:function(t){e.selected=[],e.amount_inp=t,e.amount_out=t,e.debit=0n,e.credit=0n,e.change=0n,e.netfee=0n,e.txouts.forEach((function(e){e.selected=0n}));let n=[...e.txouts_user];n.sort((function(e,t){return Number(e.free-t.free)}));let o=0n,r=t,a=0n;n.forEach((function(e){a+=e.free})),r>a&&(o=r-a,r=a);let i=r,s=0n;for(;s<i;){for(let t=0;t<n.length;t++){let o=n[t];if(t+1==n.length){e.selected.push(o);let r=o.free;s+r>i&&(r=i-s),o.selected=r,s+=o.free,n=n.slice(0,t);break}if(s+o.free>=i){e.selected.push(o);let r=o.free;s+r>i&&(r=i-s),o.selected=r,s+=o.free,n.splice(t,1);break}if(s>=i)break}if(0==n.length)break}if(s<i)return"Not enough available for withdraw";for(n=[...e.txouts_debit],n.sort((function(e,t){return Number(e.free-t.free)})),i=o,s=0n;s<i;){for(let t=0;t<n.length;t++){let o=n[t];if(t+1==n.length){e.selected.push(o);let r=o.free;s+r>i&&(r=i-s),o.selected=r,s+=o.free,n=n.slice(0,t);break}if(s+o.free>=i){e.selected.push(o);let r=o.free;s+r>i&&(r=i-s),o.selected=r,s+=o.free,n.splice(t,1);break}if(s>=i)break}if(0==n.length)break}return s<i?"Not enough available for withdraw":(e.make_unselected(),null)},add_more:function(t){let n=[],o=null;e.unselected.forEach((function(e){e.txid!=ych.zerotxid?n.push(e):o=e}));let r=[],a=0n;for(n.sort((function(e,t){return Number(e.amount-e.filled-(t.amount-t.filled))}));a<t;){for(let o=0;o<n.length;o++){let i=n[o],s=i.amount-i.filled;if(o+1==n.length){e.selected.push(i),r.push(i),i.selected=0n,a+=s,n=n.slice(0,o);break}if(a+s>=t){e.selected.push(i),r.push(i),i.selected=0n,a+=s,n.splice(o,1);break}if(a>=t)break}if(0==n.length)break}if(a<t&&null!=o){let t=o,n=t.amount-t.filled;e.selected.push(o),r.push(o),o.selected=0n,a+=n}if(a<t)return"Not enough available to select";let i={};return e.selected.forEach((function(e){let t=e.txid+":"+e.nout;i[t]=!0})),r.forEach((function(t){e.credit+=t.filled;const n=t.amount-t.selected-t.filled;e.change+=n})),e.unselected=[],e.txouts.forEach((function(t){t.txid+":"+t.nout in i||e.unselected.push(t)})),null},reduce:function(t){e.amount_out-=t;let n=e.selected;n.sort((function(e,t){return Number(e.selected-t.selected)}));for(let e=0;e<n.length;e++){let o=n[e],r=t;if(r>o.selected&&(r=o.selected),o.selected-=r,0n==(t-=r))break}},stabilize_changes:function(t){if(0n==t)return!0;if((0n==e.credit||e.credit>=t)&&(0n==e.change||e.change>=t))return!0;const n=e.change+e.credit;if(e.credit>0n&&t<=n&&n<t+t)return e.debit=e.change,e.credit=n,e.change=0n,!0;if(e.credit>0n&&e.credit<t&&n>=t+t){let n=t-e.credit;return e.debit+=n,e.credit+=n,e.change-=n,!0}return e.change>0n&&e.change<t&&n>=t+t&&(e.debit+=e.change,e.credit+=e.change,e.change=0n,!0)},stabilize_change:function(t,n){if(e.stabilize_changes(t))return null;let o=t-(e.change+e.credit),r=0n;if(e.unselected.forEach((function(e){r+=e.amount-e.filled})),o<=r){let n=e.add_more(o);if(null!=n)return n;if(e.stabilize_changes(t))return null}else if(n&&e.amount_out>o){e.reduce(o),e.change+=o;if(e.stabilize_changes(t))return null}return"Can not configure inputs(1), change the quantity"},compute_netfee:function(t){if(0n!=e.amount_inp)if("peg_t1"!=t.type)if("txout_t1"!=t.type)e.netfee=0n;else{const n=t.fee.txbytefee;e.num_inps=e.selected.length,e.num_outs=1,e.change>0n&&e.num_outs++,e.credit>0n&&e.num_outs++,e.num_outs++;let o=386*e.num_inps+34*(e.num_outs-1)+80;t.fee.txbyteround>1&&(o=Math.ceil(o/t.fee.txbyteround)*t.fee.txbyteround),e.netfee=BigInt(Math.floor(o*n*1e8+.5));const r=t.fee.mempoolminfee,a=BigInt(Math.floor(1e8*r+.5));e.netfee<a&&(e.netfee=a)}else e.netfee=10000000n;else e.netfee=0n},stabilize_netfee:function(t,n){let o=0n;"txout_t1"==t.type&&(o=t.fee.minamount);let r=0n,a=0n,i=0n;for(let s=0;s<10;s++){if(e.change+=r,e.credit+=a,e.debit+=i,r=0n,a=0n,i=0n,null!=e.stabilize_change(o,n))break;e.compute_netfee(t);let s=e.netfee,c=s;if(e.debit>0n&&e.credit>0n){let t=e.credit;if(t>e.debit&&(t=e.debit),t>c&&(t=c),e.credit-t>0n&&e.credit-t<o&&(t=e.credit-o),c-=t,a+=t,e.credit-=t,i+=t,e.debit-=t,0n==c)return null}if(e.change>0n&&e.change>=c){if(r+=c,e.change-=c,c=0n,null!=e.stabilize_change(o,n))break;if(e.compute_netfee(t),s!=e.netfee)continue;return null}e.change>0n&&e.change<c&&(r+=e.change,c-=e.change,e.change=0n);let l=0n;if(e.unselected.forEach((function(e,t){l+=e.amount-e.filled})),c<=l){if(e.add_more(c),r+=c,e.change-=c,c=0n,!e.stabilize_changes(o))break;if(e.compute_netfee(t),s!=e.netfee)continue;return null}if(n&&e.amount_out>c){if(e.reduce(c),c=0n,!e.stabilize_changes(o))break;if(e.compute_netfee(t),s!=e.netfee)continue;return null}}return"Can not configure inputs(3), change the quantity"},stabilize:function(t,n){let o=e.stabilize_change(n,e.reduce_mode);return null!=o?o:(o=e.stabilize_netfee(t,e.reduce_mode),null!=o?o:null)}};return e}})),$((function(){console.log("Init part withdraw-crypto-gui");const e=ych.gui.parts.withdraw.crypto;$("#page-withdraw-button-preview").prop("disabled",!0),$("#page-withdraw-button-send").prop("disabled",!0),$("#page-send-part-crypto-table-txouts1").table_init({cols:["n",{name:"txout",cls:"ytable-cell-c"},{name:"amount",cls:"ytable-cell-r"},{name:"free",cls:"ytable-cell-r"},{name:"orders",cls:"ytable-cell-r"},{name:"indebt",cls:"ytable-cell-r"},{name:"use",cls:"ytable-cell-r"}],rows:1}),$("#page-send-part-crypto-table-txouts2").table_init({cols:["n",{name:"txout",cls:"ytable-cell-c"},{name:"amount",cls:"ytable-cell-r"},{name:"free",cls:"ytable-cell-r"},{name:"orders",cls:"ytable-cell-r"},{name:"indebt",cls:"ytable-cell-r"},{name:"use",cls:"ytable-cell-r"}],rows:1}),$("#page-send-part-crypto-table-txouts3").table_init({cols:["n",{name:"txout",cls:"ytable-cell-c"},{name:"amount",cls:"ytable-cell-r"},{name:"free",cls:"ytable-cell-r"},{name:"orders",cls:"ytable-cell-r"},{name:"indebt",cls:"ytable-cell-r"},{name:"use",cls:"ytable-cell-r"}],rows:1}),$("#page-send-to-crypto-outs-table").table_init({cols:["n",{name:"amount",cls:"ytable-cell-r"},"to"],rows:10}),e.update_gui=function(t){let n=e.coin;$("#page-withdraw-label-quantity").text(t),$("#page-withdraw-label-sendfee").text(t),$("#page-withdraw-label-netfee").text(t),$("#page-withdraw-label-total").text(t),$("#page-withdraw-label-free").text(t),$("#page-withdraw-button-send").text("Sign and Send "+t),$("#form-send-adj-span-quantity-coin").text(t),$("#form-send-adj-span-sendfee-coin").text(t),$("#form-send-adj-span-netfee-coin").text(t),$("#form-send-adj-span-total-coin").text(t),n!=t&&($("#page-withdraw-text-address").val(""),$("#page-withdraw-text-quantity").val("0.00"));const o=ych.data.coininfos[t];"evm_t1"!=o.type&&"erc20_t1"!=o.type||($("#page-withdraw-button-preview").hide(),$("#page-withdraw-label-netfee").text("-"),$("#page-send-part-crypto-table-txouts1-head-state").text("State")),"peg_t1"==o.type&&($("#page-withdraw-button-preview").hide(),$("#page-send-part-crypto-table-txouts1-head-state").text("Txout1")),"txout_t1"==o.type&&(ych.gui.prefs_txouts_debug?$("#page-withdraw-button-preview").show():$("#page-withdraw-button-preview").hide(),$("#page-send-part-crypto-table-txouts1-head-state").text("Txout1"))},e.show_ready_amount=function(){const t=ych.data.coininfos[e.coin].ext.priceext;$("#page-withdraw-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(e.free)/1e8*t).toFixed(2)+"</span> "+ych.gui.format_amount(e.free))},e.refresh_table_txouts1=function(){$("#page-send-part-crypto-table-txouts1").table_clear();let t=0;e.op1.txouts.forEach((function(e,n){t++})),$("#page-send-part-crypto-table-txouts1").table_resize(t),e.op1.txouts.forEach((function(t,n){$("#page-send-part-crypto-table-txouts1-"+n+"-txout").html(ych.gui.format_txout_link2(e.coin,t.txid,t.nout,t.state)),$("#page-send-part-crypto-table-txouts1-"+n+"-amount").html(ych.gui.format_amount_or_empty(t.amount)),$("#page-send-part-crypto-table-txouts1-"+n+"-free").html(ych.gui.format_amount_or_empty(t.free)),$("#page-send-part-crypto-table-txouts1-"+n+"-orders").html(ych.gui.format_amount_or_empty(t.orders)),$("#page-send-part-crypto-table-txouts1-"+n+"-indebt").html(ych.gui.format_amount_or_empty(t.filled))}))},e.refresh_table_txouts2=function(){$("#page-send-part-crypto-table-txouts2").table_clear();let t=0;e.op2.txouts.forEach((function(e,n){t++})),$("#page-send-part-crypto-table-txouts2").table_resize(t+2),e.op2.txouts.forEach((function(t,n){$("#page-send-part-crypto-table-txouts2-"+n+"-txout").html(ych.gui.format_txout_link2(e.coin,t.txid,t.nout,t.state)),$("#page-send-part-crypto-table-txouts2-"+n+"-amount").html(ych.gui.format_amount_or_empty(t.amount)),$("#page-send-part-crypto-table-txouts2-"+n+"-free").html(ych.gui.format_amount_or_empty(t.free)),$("#page-send-part-crypto-table-txouts2-"+n+"-orders").html(ych.gui.format_amount_or_empty(t.orders)),$("#page-send-part-crypto-table-txouts2-"+n+"-indebt").html(ych.gui.format_amount_or_empty(t.filled))}))},e.refresh_table_txouts3=function(){$("#page-send-part-crypto-table-txouts3").table_clear();let t=0;e.op3.txouts.forEach((function(e,n){t++})),$("#page-send-part-crypto-table-txouts3").table_resize(t+2),e.op3.txouts.forEach((function(t,n){$("#page-send-part-crypto-table-txouts3-"+n+"-txout").html(ych.gui.format_txout_link2(e.coin,t.txid,t.nout,t.state)),$("#page-send-part-crypto-table-txouts3-"+n+"-amount").html(ych.gui.format_amount_or_empty(t.amount)),$("#page-send-part-crypto-table-txouts3-"+n+"-free").html(ych.gui.format_amount_or_empty(t.free)),$("#page-send-part-crypto-table-txouts3-"+n+"-orders").html(ych.gui.format_amount_or_empty(t.orders)),$("#page-send-part-crypto-table-txouts3-"+n+"-indebt").html(ych.gui.format_amount_or_empty(t.filled))}))},e.update_table_outputs=function(){let t=0,n=1,o="";$("#page-send-to-crypto-outs-table-"+t+"-n").text(n),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(e.op2.amount_out)),$("#page-send-to-crypto-outs-table-"+t+"-to").text("Receiver");ych.data.coininfos[e.coin].fee.minamount;t=1,0n!=e.op2.change?(n++,o=n):o="",$("#page-send-to-crypto-outs-table-"+t+"-n").text(o),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(e.op2.change)),$("#page-send-to-crypto-outs-table-"+t+"-to").text("Change"),t=2,0n!=e.op2.credit?(n++,o=n):o="",$("#page-send-to-crypto-outs-table-"+t+"-n").text(o),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(e.op2.credit)),$("#page-send-to-crypto-outs-table-"+t+"-to").text("Credit"),t=3,0n!=e.datatag?(n++,o=n):o="",$("#page-send-to-crypto-outs-table-"+t+"-n").text(o),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(e.datatag)),$("#page-send-to-crypto-outs-table-"+t+"-to").text("Data tag"),t=4,$("#page-send-to-crypto-outs-table-"+t+"-n").html("&nbsp;"),$("#page-send-to-crypto-outs-table-"+t+"-amount").text(""),$("#page-send-to-crypto-outs-table-"+t+"-to").text(""),t=5;let r=e.op2.amount_out+e.op2.change+e.op2.credit+e.datatag;$("#page-send-to-crypto-outs-table-"+t+"-n").text(""),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(r)),$("#page-send-to-crypto-outs-table-"+t+"-to").html("<b>All outputs</b>"),t=6,$("#page-send-to-crypto-outs-table-"+t+"-n").text(""),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(e.op2.netfee)),$("#page-send-to-crypto-outs-table-"+t+"-to").text("Network fee"),t=7;let a=e.op2.amount_out+e.op2.change+e.op2.credit+e.datatag+e.op2.netfee;$("#page-send-to-crypto-outs-table-"+t+"-n").text(""),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(a)),$("#page-send-to-crypto-outs-table-"+t+"-to").html("<b>Total</b>"),t=8,$("#page-send-to-crypto-outs-table-"+t+"-n").html("&nbsp;"),$("#page-send-to-crypto-outs-table-"+t+"-amount").text(""),$("#page-send-to-crypto-outs-table-"+t+"-to").text(""),t=9,$("#page-send-to-crypto-outs-table-"+t+"-n").text(""),$("#page-send-to-crypto-outs-table-"+t+"-amount").html(ych.gui.format_amount_or_empty(e.op2.debit)),$("#page-send-to-crypto-outs-table-"+t+"-to").text("Debit change"),e.update_table_outputs_show_err()},e.update_table_outputs_show_err=function(){let t=ych.data.coininfos[e.coin].fee.minamount;i=1,0n!=e.op2.change&&e.op2.change<t?$("#page-send-to-crypto-outs-table").table_row_add_class(i,"ytable-cell-warn-red"):$("#page-send-to-crypto-outs-table").table_row_remove_class(i,"ytable-cell-warn-red"),i=2,0n!=e.op2.credit&&e.op2.credit<t?$("#page-send-to-crypto-outs-table").table_row_add_class(i,"ytable-cell-warn-red"):$("#page-send-to-crypto-outs-table").table_row_remove_class(i,"ytable-cell-warn-red")},e.update_table_selected1=function(){if(0n==e.op1.amount_inp)return void e.op1.txouts.forEach((function(t,n){let o=t.txid+":"+t.nout,r=e.op1.txout_id_to_idx[o];$("#page-send-part-crypto-table-txouts1").table_row_remove_class(r,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts1-"+r+"-n").text(""),$("#page-send-part-crypto-table-txouts1-"+r+"-use").text("")}));let t={};e.op1.selected.forEach((function(n,o){let r=n.txid+":"+n.nout,a=e.op1.txout_id_to_idx[r];t[r]=!0,$("#page-send-part-crypto-table-txouts1-"+a+"-use").html(ych.gui.format_amount_or_empty(n.selected))}));let n=1;e.op1.txouts.forEach((function(o,r){let a=o.txid+":"+o.nout,i=e.op1.txout_id_to_idx[a];a in t?($("#page-send-part-crypto-table-txouts1-"+i+"-n").text(n),n++):($("#page-send-part-crypto-table-txouts1-"+i+"-n").text(""),$("#page-send-part-crypto-table-txouts1-"+i+"-use").text("")),a in t?$("#page-send-part-crypto-table-txouts1").table_row_remove_class(i,"ytable-cell-grey-out"):$("#page-send-part-crypto-table-txouts1").table_row_add_class(i,"ytable-cell-grey-out")}))},e.update_table_selected2=function(){if(0n==e.op2.amount_inp)return void e.op2.txouts.forEach((function(t,n){let o=t.txid+":"+t.nout,r=e.op2.txout_id_to_idx[o];$("#page-send-part-crypto-table-txouts2").table_row_remove_class(r,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts2-"+r+"-n").text(""),$("#page-send-part-crypto-table-txouts2-"+r+"-use").text("")}));let t={};e.op2.selected.forEach((function(n,o){let r=n.txid+":"+n.nout,a=e.op2.txout_id_to_idx[r];t[r]=!0,$("#page-send-part-crypto-table-txouts2-"+a+"-use").html(ych.gui.format_amount_or_empty(n.selected))}));let n=1;e.op2.txouts.forEach((function(o,r){let a=o.txid+":"+o.nout,i=e.op2.txout_id_to_idx[a];a in t?($("#page-send-part-crypto-table-txouts2-"+i+"-n").text(n),n++):($("#page-send-part-crypto-table-txouts2-"+i+"-n").text(""),$("#page-send-part-crypto-table-txouts2-"+i+"-use").text("")),a in t?$("#page-send-part-crypto-table-txouts2").table_row_remove_class(i,"ytable-cell-grey-out"):$("#page-send-part-crypto-table-txouts2").table_row_add_class(i,"ytable-cell-grey-out")}));let o=e.op2.txouts.length;{$("#page-send-part-crypto-table-txouts2").table_row_add_class(o,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts2-"+o+"-txout").html("&nbsp;"),$("#page-send-part-crypto-table-txouts2-"+o+"-amount").text(""),$("#page-send-part-crypto-table-txouts2-"+o+"-free").text("Netfee:"),$("#page-send-part-crypto-table-txouts2-"+o+"-orders").text("Change:"),$("#page-send-part-crypto-table-txouts2-"+o+"-indebt").text("Credit:"),$("#page-send-part-crypto-table-txouts2-"+o+"-use").text("Receiver:"),o++;let t=0n;e.op2.selected.forEach((function(e,n){t+=e.amount})),$("#page-send-part-crypto-table-txouts2").table_row_remove_class(o,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts2-"+o+"-txout").html("<b>All inputs</b>"),$("#page-send-part-crypto-table-txouts2-"+o+"-amount").html(ych.gui.format_amount_or_empty(t)),$("#page-send-part-crypto-table-txouts2-"+o+"-free").html(ych.gui.format_amount_or_empty(e.op2.netfee)),$("#page-send-part-crypto-table-txouts2-"+o+"-orders").html(ych.gui.format_amount_or_empty(e.op2.change)),$("#page-send-part-crypto-table-txouts2-"+o+"-indebt").html(ych.gui.format_amount_or_empty(e.op2.credit)),$("#page-send-part-crypto-table-txouts2-"+o+"-use").html(ych.gui.format_amount_or_empty(e.op2.amount_out))}},e.update_table_selected3=function(){if(0n==e.op3.amount_inp)return void e.op3.txouts.forEach((function(t,n){let o=t.txid+":"+t.nout,r=e.op3.txout_id_to_idx[o];$("#page-send-part-crypto-table-txouts3").table_row_remove_class(r,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts3-"+r+"-n").text(""),$("#page-send-part-crypto-table-txouts3-"+r+"-use").text("")}));let t={};e.op3.selected.forEach((function(n,o){let r=n.txid+":"+n.nout,a=e.op3.txout_id_to_idx[r];t[r]=!0,$("#page-send-part-crypto-table-txouts3-"+a+"-use").html(ych.gui.format_amount_or_empty(n.selected))}));let n=1;e.op3.txouts.forEach((function(o,r){let a=o.txid+":"+o.nout,i=e.op3.txout_id_to_idx[a];a in t?($("#page-send-part-crypto-table-txouts3-"+i+"-n").text(n),n++):($("#page-send-part-crypto-table-txouts3-"+i+"-n").text(""),$("#page-send-part-crypto-table-txouts3-"+i+"-use").text("")),a in t?$("#page-send-part-crypto-table-txouts3").table_row_remove_class(i,"ytable-cell-grey-out"):$("#page-send-part-crypto-table-txouts3").table_row_add_class(i,"ytable-cell-grey-out")}));let o=e.op3.txouts.length;{$("#page-send-part-crypto-table-txouts3").table_row_add_class(o,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts3-"+o+"-txout").html("&nbsp;"),$("#page-send-part-crypto-table-txouts3-"+o+"-amount").text(""),$("#page-send-part-crypto-table-txouts3-"+o+"-free").text("Netfee:"),$("#page-send-part-crypto-table-txouts3-"+o+"-orders").text("Change:"),$("#page-send-part-crypto-table-txouts3-"+o+"-indebt").text("Credit:"),$("#page-send-part-crypto-table-txouts3-"+o+"-use").text("Receiver:"),o++;let t=0n;e.op3.selected.forEach((function(e,n){t+=e.amount})),$("#page-send-part-crypto-table-txouts3").table_row_remove_class(o,"ytable-cell-grey-out"),$("#page-send-part-crypto-table-txouts3-"+o+"-txout").html("<b>All inputs</b>"),$("#page-send-part-crypto-table-txouts3-"+o+"-amount").html(ych.gui.format_amount_or_empty(t)),$("#page-send-part-crypto-table-txouts3-"+o+"-free").html(ych.gui.format_amount_or_empty(e.op3.netfee)),$("#page-send-part-crypto-table-txouts3-"+o+"-orders").html(ych.gui.format_amount_or_empty(e.op3.change)),$("#page-send-part-crypto-table-txouts3-"+o+"-indebt").html(ych.gui.format_amount_or_empty(e.op3.credit)),$("#page-send-part-crypto-table-txouts3-"+o+"-use").html(ych.gui.format_amount_or_empty(e.op3.amount_out))}},e.update_fee_text=function(){const t=ych.data.coininfos[e.coin],n=t.ext.priceext,o=(t.fee.minamount,e.sendfee);if("txout_t1"==t.type){let r=t.fee.txbytefee,a=e.op2.num_inps,i=e.op2.num_outs;const s=t.fee.withfee;$("#page-withdraw-head-sendfee").text("Withdraw Fee "+(100*s).toFixed(3)+"%:"),$("#page-withdraw-text-sendfee").html("≈$"+(Number(o)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(o)),$("#page-withdraw-head-netfee").text("Network "+(1e8*r).toFixed(2)+" Sat/B:"),$("#page-withdraw-text-netfee").html("≈$"+(Number(e.op2.netfee)/1e8*n).toFixed(2)+" ("+a+"-"+i+") "+ych.gui.format_amount(e.op2.netfee)),$("#page-withdraw-text-total").html("≈$"+(Number(e.op2.amount_out+o+e.op2.netfee+e.datatag)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.op2.amount_out+o+e.op2.netfee+e.datatag)),a=e.op3.num_inps,i=e.op3.num_outs,$("#form-send-adj-div-quantity").html("≈$"+(Number(e.op3.amount_out)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.op3.amount_out)),$("#form-send-adj-div-sendfee").html("≈$"+(Number(e.sendfee)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.sendfee)),$("#page-withdraw-tr-netfee").show(),$("#form-send-adj-div-netfee").html("≈$"+(Number(e.op3.netfee)/1e8*n).toFixed(2)+" ("+a+"-"+i+") "+ych.gui.format_amount(e.op3.netfee)),$("#form-send-adj-div-total").html("≈$"+(Number(e.op3.amount_out+o+e.op3.netfee+e.datatag)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.op3.amount_out+o+e.op3.netfee+e.datatag))}if("evm_t1"==t.type||"erc20_t1"==t.type){const r=t.fee.withfee;$("#page-withdraw-head-sendfee").text("Withdraw Fee "+(100*r).toFixed(3)+"%:"),$("#page-withdraw-text-sendfee").html("≈$"+(Number(o)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(o)),$("#page-withdraw-tr-netfee").hide(),$("#page-withdraw-head-netfee").text("Network:"),$("#page-withdraw-text-netfee").html("(estimated by Web3 Provider)"),$("#page-withdraw-text-total").html("≈$"+(Number(e.op2.amount_out+o)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.op2.amount_out+o))}if("peg_t1"==t.type){const r=t.fee.withfee;$("#page-withdraw-head-sendfee").text("Withdraw Fee "+(100*r).toFixed(3)+"%:"),$("#page-withdraw-text-sendfee").html("≈$"+(Number(o)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(o)),$("#page-withdraw-tr-netfee").show(),$("#page-withdraw-head-netfee").text("Network (fixed):"),$("#page-withdraw-text-netfee").html("≈$"+(Number(e.op2.netfee)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.op2.netfee)),$("#page-withdraw-text-total").html("≈$"+(Number(e.op2.amount_out+o+e.op2.netfee)/1e8*n).toFixed(2)+" "+ych.gui.format_amount(e.op2.amount_out+o+e.op2.netfee))}},e.clear_error=function(){$("#page-withdraw-box-err").css("background-color","rgba(0,0,0,0)"),$("#page-withdraw-box-err").text(" ")},e.show_error=function(e){$("#page-withdraw-button-preview").prop("disabled",!0),$("#page-withdraw-button-send").prop("disabled",!0),$("#page-withdraw-box-err").css("background-color","rgba(255,0,0,0.25)"),$("#page-withdraw-box-err").text(e)},e.show_ready=function(){$("#page-withdraw-button-preview").prop("disabled",!1),$("#page-withdraw-button-send").prop("disabled",!1),e.clear_error()},e.refresh_gui=function(){e.refresh_table_txouts1(),e.refresh_table_txouts2(),e.refresh_table_txouts3(),e.update_table_selected1(),e.update_table_selected2(),e.update_table_selected3(),e.update_table_outputs(),e.update_fee_text()},e.show_error_and_refresh=function(t){e.refresh_gui(),e.show_error(t)},$("#page-withdraw-button-max").click((function(t){t.preventDefault(),e.select_amount_percent(100)}))})),$((function(){console.log("Init page move");let e=function(){};ych.gui.pages.move=e,ych.gui.parts.move={},e.on_init=function(){$("#page-move-dotslide").dot_slide("#transfer-value","0.00000000",(function(e){ych.gui.parts.move.instant.select_amount_percent(e)}))},e.on_show=function(t){let n=e.coin;e.coin=t,n!=t&&($("#page-move-text-address").val(""),$("#page-move-text-quantity").val("0.00"));const o=ych.data.coininfos[t],r="evm_t1"==o.type||"erc20_t1"==o.type;$("#page-move-table-sends").table_col_show("timeout",r),e.update()},e.on_logout=function(){$("#page-move-table-sends").table_clear()},e.on_coininfo=function(e){},e.on_balance=function(t){let n=t.coin;if(n!=e.coin)return;const o=ych.data.coininfos[n].ext.priceext;$("#page-move-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(t.free)/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(t.free))},$("#page-move-table-sends").table_init({cols:[{name:"n",cls:"ytable-cell-c"},"date",{name:"txout",cls:"ytable-cell-c"},{name:"amount",cls:"ytable-cell-r"},{name:"usd",cls:"ytable-cell-r"},{name:"status",cls:"ytable-cell-c"},{name:"timeout",cls:"ytable-cell-c"}]}),e.update_table=function(t,n){if(n!=e.coin)return;let o=ych.data.coininfos[n];$("#page-move-table-sends").table_clear(),t.forEach((function(e,t){if($("#page-move-table-sends-"+t+"-n").text("W-"+e.uidx),$("#page-move-table-sends-"+t+"-date").html(ych.gui.format_date(e.time.made)),$("#page-move-table-sends-"+t+"-amount").html(ych.gui.format_amount(-e.vals.amount)),$("#page-move-table-sends-"+t+"-usd").html(ych.gui.format_usd(e.vals.usdext)),e.time.stop>0&&($("#page-move-table-sends-"+t+"-amount").html(ych.gui.format_amount_off(-e.vals.amount)),$("#page-move-table-sends-"+t+"-usd").text("-")),"evm_t1"==o.type||"erc20_t1"==o.type)if(e.time.sign>0&&0==e.time.wait&&0==e.time.stop&&0==e.time.sent&&(""==e.txid||"PREPARING"==e.txid)){Math.floor((new Date).getTime()/1e3)<e.time.twin?($("#page-move-table-sends-"+t+"-status").html('<button class="ui-button ui-widget ui-corner-all ybutton ybutton-micro ybutton-red ybutton-20" id="page-move-table-sends-'+t+'-but-bcast">CLICK TO BROADCAST</button>'),$("#page-move-table-sends-"+t+"-but-bcast").click((function(t){t.preventDefault(),ych.gui.parts.withdraw.evm.on_withdraw_bcast(e),ych.gui.parts.withdraw.evm.on_withdraw_bcast_go()}))):$("#page-move-table-sends-"+t+"-status").text("TIMEOUT")}else $("#page-move-table-sends-"+t+"-status").text(e.status);else $("#page-move-table-sends-"+t+"-status").text(e.status);if(e.time.stop>0)$("#page-move-table-sends-"+t+"-txout").text("");else if("INSTANT"==e.txid)$("#page-move-table-sends-"+t+"-txout").text(e.txid);else{let n=e.txid;n.startsWith("0x")&&(n=n.substring(2)),$("#page-move-table-sends-"+t+"-txout").html(ych.gui.format_txout_link1(e.coin,n,e.nout,0))}e.time.twin>0?$("#page-move-table-sends-"+t+"-timeout").html(ych.gui.format_date(e.time.twin)):$("#page-move-table-sends-"+t+"-timeout").text("")}))},$("#page-move-button-back").click((function(e){e.preventDefault(),window.history.back()})),e.update=function(){const t=e.coin;$("#page-move-label-quantity").text(t),$("#page-move-label-total").text(t),$("#page-move-label-free").text(t),$("#page-move-label-fee").text(t),$("#page-move-button-send").text("Send "+t);let n=[];if(null!=ych.data.profile&&t in ych.data.profile.withdraws&&(n=ych.data.profile.withdraws[t]),e.update_table(n,t),null!=ych.data.profile&&t in ych.data.profile.balances){const e=ych.data.profile.balances[t],n=ych.data.coininfos[t].ext.priceext;$("#page-move-dotslide").dot_slide_max_html('<span class="ysemi">≈$'+(Number(e.free)/1e8*n).toFixed(2)+"</span> "+ych.gui.format_amount(e.free))}else $("#page-move-dotslide").dot_slide_max_html("")},e.on_ws_addwithdraw=function(t){const n=t.objects[1],o=n.coin;if(n.coin!=e.coin)return;const r=ych.data.profile.withdraws[o];e.update_table(r,o)},e.on_ws_regwithdraw=function(t){const n=t.objects[1],o=n.coin;if(n.coin!=e.coin)return;const r=ych.data.profile.withdraws[o];e.update_table(r,o)}})),$((function(){console.log("Init part move-instant");let e=function(){};ych.gui.parts.move.instant=e,e.on_show=function(t){e.coin=t,e.update_fees()},$("#page-move-button-send").prop("disabled",!0),e.clear_error=function(){$("#page-move-box-err").css("background-color","rgba(0,0,0,0)"),$("#page-move-box-err").text(" ")},e.show_error=function(e){$("#page-move-box-err").css("background-color","rgba(255,0,0,0.25)"),$("#page-move-box-err").text(e)},e.on_coininfo=function(t){t.coin==e.coin&&e.update_fees()},e.select_amount_percent=function(t){e.clear_error();const n=ych.data.coininfos[e.coin],o=ych.data.profile.balances[e.coin],r=n.fee.sendfee,a=Number(o.free)/1e8*t/100/(1+r);$("#page-move-text-quantity").val(a.toFixed(8)),e.update_fees()},e.update_fees=function(){const t=e.coin;let n=0n;isNaN($("#page-move-text-quantity").val())||""==$("#page-move-text-quantity").val()||(n=Math.floor(.5+1e8*parseFloat($("#page-move-text-quantity").val())));const o=ych.data.coininfos[t],r=o.ext.priceext,a=o.fee.sendfee,i=Math.floor(.5+n*a),s=n+i;return $("#page-move-head-fee").text("Send Fee "+(100*a).toFixed(3)+"%:"),$("#page-move-text-fee").html('<span class="ysemi">≈$'+(i/1e8*r).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(i))),$("#page-move-text-total").html('<span class="ysemi">≈$'+(s/1e8*r).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(s))),i},e.validate_fields=function(){if(isNaN($("#page-move-text-quantity").val())||""==$("#page-move-text-quantity").val())return $("#page-move-text-total").text("-"),void $("#page-move-button-withdraw").prop("disabled",!0);const t=e.coin,n=ych.data.coininfos[t],o=n.ext.priceext,r=n.fee.sendfee;n.fee.minorder;let a=Math.floor(.5+1e8*parseFloat($("#page-move-text-quantity").val())),i=Math.floor(.5+a*r),s=a+i;if(e.clear_error(),$("#page-move-text-fee").html('<span class="ysemi">≈$'+(i/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(i))),$("#page-move-text-total").html('<span class="ysemi">≈$'+(s/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(s))),s>ych.data.profile.balances[t].free)return $("#page-move-button-send").prop("disabled",!0),void e.show_error("Total is over available coins");let c=$("#page-move-text-address").val();if(!ych.gui.check_email(c))return $("#page-move-button-send").prop("disabled",!0),void e.show_error("Address is not recognized");$("#page-move-button-send").prop("disabled",!1),e.clear_error()},$("#page-move-text-address").on("input",e.validate_fields),$("#page-move-text-quantity").on("input",e.validate_fields),$("#page-move-button-send").click((function(t){t.preventDefault(),e.clear_error(),ych.gui.call_with_pass1().then((t=>{t.ok?e.make_send():e.show_error(t.msg)}))})),e.make_send=function(){const t=e.coin;if(""==ych.address[t])return void e.show_error("Not available the change address");const n=$("#page-move-text-address").val(),o=ych.data.coininfos[t],r=o.fee.sendfee,a=(o.fee.minamount,o.fee.minorder,ych.gui.get_input_amount("page-move-text-quantity")),i=BigInt(Math.floor(.5+Number(a)*r)),s=a+i;let c=0n,l=s,u=ych.data.profile.balances[t];if(s>u.free)return void e.show_error("Not enough coins");if(u.debit>0){let t=u.debit-u.ordersindebit;if(t<0)return void e.show_error("Error debt usage is negative");t>=s?(c=s,l=0n):t>0&&(c=t,l=s-t)}let d=[];if(l>0){console.log("total_via_txouts",l);let n=JSON.parse(JSON.stringify(ych.data.profile.txouts[t],((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),jsonBNparse);ych.init_coinjs(t);const r=n.filter((e=>350==e.state||400==e.state||800==e.state));if(n=n.filter((e=>400==e.state)),n.sort((function(e,t){return Number(e.free-t.free)})),"txout_t1"==o.type){const[t,o,r,a]=ych.txout_select_inps(n,l);if(o<0n||o<l)return void e.show_error("send: not enough available coins in txouts to use "+l);console.log("selected txouts:",t,o,r,a);for(let n=0;n<t.length;n++){const o=t[n],[r,a]=ych.sign_txout(o);if(null!=a)return void e.show_error(a);d.push(r)}}if("evm_t1"==o.type||"erc20_t1"==o.type){const t=o.cfg.unit,n=l;for(let o=0;o<r.length;o++){const a=r[o],i="0x"+a.txid,s=a.orders+a.filled+n,c=s*t,l=[ych.evm_sign1(ych.address[e.coin],i,c,ych.evm_zeroaddr,a.nout+1)];let u={};u.txid=a.txid,u.nout=a.nout,u.amnt=a.amount,u.fill=a.filled,u.usea=n,u.sigf="",u.sigv=s,u.sigs=l,d.push(u)}}}let h="";d.forEach((function(e,t){h+=e.txid+":"+e.nout,h+=e.fill.toString(),h+=e.usea.toString()}));const p=t+n+a.toString()+i.toString()+c.toString()+h+ych.pubkey1;ych.apicall({uri:"/u/send",digest:p,data:{coin:t,addr:n,amount:a,fee:i,usedebit:c,usetxouts:d},on_success:function(t){e.clear_error(),$("#page-move-text-address").val(""),$("#page-move-text-quantity").val("0.0")},on_error:function(t){e.show_error(t)}})},$("#page-move-button-max").click((function(t){t.preventDefault(),e.select_amount_percent(100)}))})),$((function(){console.log("Init part balances");let e=function(){};ych.gui.parts.wallet.balances=e,e.on_show=function(){e.update()},e.update=function(){},e.init_table=function(){let e=ych.data.coins.slice();e.push("Total"),$("#page-account-table-balances").table_init({cols:["asset",{name:"sum",cls:"ytable-cell-r"},{name:"usd",cls:"ytable-cell-r"},{name:"free",cls:"ytable-cell-r"},{name:"orders",cls:"ytable-cell-r"},{name:"clearance",cls:"ytable-cell-r"},{name:"deposits",cls:"ytable-cell-r"},{name:"withdraws",cls:"ytable-cell-r"},{name:"ops",cls:"ytable-cell-c"}],rows:e}),ych.data.coins.forEach((function(e,t){$("#page-account-table-balances-"+e+"-ops").html("<a class='ytable-a' id='page-account-table-balances-"+e+"-recv-a' href='/#recv-"+e+"'>deposit</a>/<a class='ytable-a' id='page-account-table-balances-"+e+"-send-a' href='/#send-"+e+"'>send</a>"),$("#page-account-table-balances-"+e+"-recv-a").click((function(t){t.preventDefault(),window.ych_navigate("#recv-"+e)})),$("#page-account-table-balances-"+e+"-send-a").click((function(t){t.preventDefault(),window.ych_navigate("#send-"+e)}))})),$("#page-account-table-balances-Total-asset").html("<b>TOTAL</b>")},e.show_sync=function(e,t){null!=t.peg&&(t.coin==t.peg.L&&(e.cycle!=t.peg.cycle?($("#page-account-table-balances").table_row_add_class(t.peg.L,"ytable-cell-out-of-sync"),$("#page-account-table-balances").table_row_add_class(t.peg.R,"ytable-cell-out-of-sync")):e.free<0?$("#page-account-table-balances").table_row_add_class(t.peg.L,"ytable-cell-out-of-sync"):$("#page-account-table-balances").table_row_remove_class(t.peg.L,"ytable-cell-out-of-sync")),t.coin==t.peg.R&&e.cycle==t.peg.cycle&&(e.free<0?$("#page-account-table-balances").table_row_add_class(t.peg.R,"ytable-cell-out-of-sync"):$("#page-account-table-balances").table_row_remove_class(t.peg.R,"ytable-cell-out-of-sync")))},e.clean_table=function(){$("#page-account-table-balances").table_col_hide("orders"),$("#page-account-table-balances").table_col_hide("deposits"),$("#page-account-table-balances").table_col_hide("withdraws"),$("#page-account-table-balances").table_col_hide("clearance"),$("#page-account-table-balances").table_clear()},e.update_balance=function(t){e.update_in_table(t,"page-account-table-balances",t.coin,t.coin),e.update_table_cols("page-account-table-balances",ych.data.profile.balances),e.update_total(),ych.data_update("balance",t)},e.update_total=function(){let e=0;for(let t in ych.data.profile.balances){let n=0;if(t in ych.data.coininfos){n=ych.data.coininfos[t].ext.priceext}e+=Number(ych.data.profile.balances[t].sum)/1e8*n}$("#page-account-table-balances-Total-usd").html("<b>"+ych.gui.format_usd_or_empty(e)+"</b>")},e.update_table_cols=function(e,t){let n=!1,o=!1,r=!1,a=!1;for(let e in t){let t=ych.data.profile.balances[e];void 0!==t&&void 0!==t.free&&(0!=t.orders&&(n=!0),0!=t.deposits&&(r=!0),0!=t.withdraws&&(o=!0),0!=t.clearance&&(a=!0))}$("#"+e).table_col_show("orders",n),$("#"+e).table_col_show("deposits",r),$("#"+e).table_col_show("withdraws",o),$("#"+e).table_col_show("clearance",a)},e.update_in_table=function(t,n,o,r){let a=0;if(o in ych.data.coininfos){let n=ych.data.coininfos[o];e.show_sync(t,n),a=n.ext.priceext}$("#"+n+"-"+r+"-asset").text(o),$("#"+n+"-"+r+"-sum").html(ych.gui.format_amount(t.sum));let i=Number(t.sum)/1e8*a;$("#"+n+"-"+r+"-usd").html(ych.gui.format_usd_or_empty(i)),$("#"+n+"-"+r+"-free").html(ych.gui.format_amount_or_empty(t.free-t.offtrade)),$("#"+n+"-"+r+"-orders").html(ych.gui.format_amount_or_empty(t.orders)),$("#"+n+"-"+r+"-clearance").html(ych.gui.format_amount_or_empty(t.clearance)),$("#"+n+"-"+r+"-deposits").html(ych.gui.format_amount_or_empty(t.deposits)),$("#"+n+"-"+r+"-withdraws").html(ych.gui.format_amount_or_empty(t.withdraws)),o in ych.address&&""!=ych.address[o]?($("#"+n+"-"+r+"-ops").html("<a class='ytable-a' id='"+n+"-"+r+"-recv-a' href='/#recv-"+o+"'>deposit</a>/<a class='ytable-a' id='"+n+"-"+r+"-send-a' href='/#send-"+o+"'>send</a>"),$("#"+n+"-"+r+"-recv-a").click((function(e){e.preventDefault(),window.ych_navigate("#recv-"+o)})),$("#"+n+"-"+r+"-send-a").click((function(e){e.preventDefault(),window.ych_navigate("#send-"+o)}))):$("#"+n+"-"+r+"-ops").html("-")}})),$((function(){console.log("Init page register");let e=function(){};ych.gui.pages.register=e,e.on_show=function(t){$("#page-register-text-invite").focus(),null!=t&&""!=t&&($("#page-register-div-get-inv").hide(),$("#page-register-text-pass1").focus(),e.register_via_redeem(t))},$("#page-register-button-back").click((function(t){t.preventDefault(),e.cleanup(!1),window.history.back()})),e.register_via_redeem=function(t){$("#page-register-text-invite").val(t),$("#page-register-text-email").focus(),ych.apicall({uri:"/u/redeem",data:{code:t},on_success:function(t){$("#page-register-div-got-inv").show(),$("#page-register-text-email").val(t.email),""==t.email?$("#page-register-text-email").focus():(e.cleanup(!0),$("#page-register-text-pass1").focus()),$("#page-register-box-err").text(""),$("#page-register-box-err").hide()},on_error:function(t){$("#page-register-box-err").show(),$("#page-register-box-err").text(t),e.cleanup(!1)}})},e.cleanup=function(e){$("#page-register-box-pass-quality").css("background-color","rgba(255,0,0,0.25)"),$("#page-register-box-pass-quality").text("Password quality: -"),$("#page-register-box-email-quality").css("background-color","rgba(255,0,0,0.25)"),$("#page-register-box-email-quality").text("Email: -"),$("#page-register-box-pass-match").css("background-color","rgba(255,0,0,0.25)"),$("#page-register-box-pass-match").text("Passwords match: -"),$("#page-register-text-email").attr("readonly",e),$("#page-register-text-email").val(""),$("#page-register-text-pass1").val(""),$("#page-register-text-pass2").val(""),$("#page-register-text-invite").val(""),$("#page-register-text-invite").focus(),$("#page-register-button-register").prop("disabled",!0)},e.cleanup(!1),e.pass_score=function(e){let t=0;if(!e)return t;let n=new Object;for(let o=0;o<e.length;o++)n[e[o]]=(n[e[o]]||0)+1,t+=5/n[e[o]];let o={digits:/\d/.test(e),lower:/[a-z]/.test(e),upper:/[A-Z]/.test(e),nonWords:/\W/.test(e)};variationCount=0;for(let e in o)variationCount+=1==o[e]?1:0;return t+=10*(variationCount-1),parseInt(t)},e.pass_quality=function(t){var n=e.pass_score(t);return n>90&&t.length>=12?"Strong":n>60?"Almost good":n>=30?"Weak":"Bad"},e.validate=function(){let t=ych.gui.cleanup_email($("#page-register-text-email").val()),n=$("#page-register-text-pass1").val(),o=$("#page-register-text-pass2").val(),r=ych.gui.check_email(t),a="Password quality: "+e.pass_quality(n),i=e.pass_score(n),s=n==o;i<=30?$("#page-register-box-pass-quality").css("background-color","rgba(255,0,0,0.25)"):i<=60?$("#page-register-box-pass-quality").css("background-color","rgba(255,255,0,0.25)"):i<=90?$("#page-register-box-pass-quality").css("background-color","rgba(255,240,128,0.35)"):$("#page-register-box-pass-quality").css("background-color","rgba(0,255,0,0.25)"),r?($("#page-register-box-email-quality").text("Email: OK"),$("#page-register-box-email-quality").css("background-color","rgba(0,255,0,0.25)")):($("#page-register-box-email-quality").text("Email: Incorrect"),$("#page-register-box-email-quality").css("background-color","rgba(255,0,0,0.25)")),s?($("#page-register-box-pass-match").text("Passwords match: OK"),$("#page-register-box-pass-match").css("background-color","rgba(0,255,0,0.25)")):($("#page-register-box-pass-match").text("Passwords match: NO"),$("#page-register-box-pass-match").css("background-color","rgba(255,0,0,0.25)")),$("#page-register-box-pass-quality").text(a),$("#page-register-button-register").prop("disabled",!r||!s||i<=80),""==n&&($("#page-register-box-pass-match").text("Password match: -"),$("#page-register-box-pass-match").css("background-color","rgba(255,0,0,0.25)"),$("#page-register-box-pass-quality").text("Password quality: -"),$("#page-register-box-pass-quality").css("background-color","rgba(255,0,0,0.25)"))},$("#page-register-text-email").on("input",e.validate),$("#page-register-text-pass1").on("input",e.validate),$("#page-register-text-pass2").on("input",e.validate),$("#page-register-text-invite").on("keyup",(function(e){"Enter"!==e.key&&13!==e.keyCode||$("#page-register-text-email").focus()})),$("#page-register-text-email").on("keyup",(function(e){"Enter"!==e.key&&13!==e.keyCode||$("#page-register-text-pass1").focus()})),$("#page-register-text-pass1").on("keyup",(function(e){"Enter"!==e.key&&13!==e.keyCode||$("#page-register-text-pass2").focus()})),$("#page-register-text-pass2").on("keyup",(function(t){if("Enter"===t.key||13===t.keyCode){if($("#page-register-button-register").prop("disabled"))return;e.register_call()}})),e.register_call=function(){$("#page-register-box-err").hide(),$("#page-register-box-err").text(""),$("#page-register-button-register").prop("disabled",!0);const t=$("#page-register-text-invite").val().trim(),n=ych.gui.cleanup_email($("#page-register-text-email").val()),o=$("#page-register-text-pass1").val(),[r,a]=($("#page-register-text-pass2").val(),ych.user_keys_v1(n,o)),i=t+n+a;ych.apicall({uri:"/u/register",uprvk:r,digest:i,data:{invt:t,user:n,upub:a},on_success:function(t){e.cleanup(!1),window.ych_navigate("#registered")},on_error:function(t){$("#page-register-box-err").show(),$("#page-register-box-err").text(t),e.validate()}})},$("#page-register-button-register").click((function(t){t.preventDefault(),e.register_call()}))})),$((function(){console.log("Init page registered");ych.gui.pages.registered=function(){},$("#page-registered-button-back").click((function(e){e.preventDefault(),window.ych_navigate("#")}))})),$((function(){console.log("Init page confirm1");let e=function(){};ych.gui.pages.confirm1=e,e.on_init=function(){$("#page-confirm1-button-back").click((function(e){e.preventDefault(),window.ych_navigate("#")})),$("#page-confirm1-button-submit").click((function(t){t.preventDefault(),e.confirm_login_call()}))},e.on_show=function(t){e.get_login_call(t)},e.get_login_call=function(e){window.ych_confirm_account_login="",window.ych_confirm_account_email_code=e,$("#page-confirm1-button-submit").prop("disabled",!0),ych.apicall({uri:"/u/confirmg",data:{code:e},on_success:function(e){$("#page-confirm1-text-err").hide(),$("#page-confirm1-text-pass").focus(),$("#page-confirm1-button-submit").prop("disabled",!1),window.ych_confirm_account_login=e.login},on_error:function(e){$("#page-confirm1-text-err").text(e),$("#page-confirm1-text-err").show()}})},e.confirm_login_call=function(){const e=window.ych_confirm_account_email_code,t=window.ych_confirm_account_login,n=$("#page-confirm1-text-pass").val(),[o,r]=ych.user_keys_v1(t,n),a=e+r;ych.apicall({uri:"/u/confirme",uprvk:o,digest:a,data:{code:e},on_success:function(e){$("#page-confirm1-text-pass").val(""),$("#page-confirm2-image-qr").attr("src","data:image/png;base64,"+e.qr),$("#page-confirm2-link-qr").attr("href",e.url);const t=e.url.split("secret=");2==t.length&&$("#page-confirm2-key-text").text(t[1]),e.mob?($("#page-confirm2-text-mobile").css("background-color","rgba(0,255,0,0.25)"),$("#page-confirm2-text-mobile").show()):$("#page-confirm2-text-mobile").hide(),window.ych_confirm_account_pass=n,window.ych_navigate("#confirm2")},on_error:function(e){$("#page-confirm1-text-err").text(e),$("#page-confirm1-text-err").show()}})}})),$((function(){console.log("Init page confirm2");let e=function(){};ych.gui.pages.confirm2=e,e.on_init=function(){$("#page-confirm2-button-back").click((function(e){e.preventDefault(),window.ych_navigate("#")})),$("#page-confirm2-text-totp").on("keyup",(function(t){"Enter"!==t.key&&13!==t.keyCode||(t.preventDefault(),e.register_totp_call())})),$("#page-confirm2-button-totp").click((function(t){t.preventDefault(),e.register_totp_call()}))},e.register_totp_call=function(){$("#page-confirm2-text-err").hide(),$("#page-confirm2-button-totp").prop("disabled",!0);const e=window.ych_confirm_account_email_code,t=$("#page-confirm2-text-totp").val();$("#page-confirm2-text-totp").val("");const n=window.ych_confirm_account_login,o=window.ych_confirm_account_pass,[r,a]=ych.user_keys_v1(n,o),i=e+t+a;ych.apicall({uri:"/u/confirma",uprvk:r,digest:i,data:{code:e,auth:t},on_success:function(e){window.ych_navigate("#confirm3")},on_error:function(e){$("#page-confirm2-text-err").show(),$("#page-confirm2-text-err").text(e),$("#page-confirm2-button-totp").prop("disabled",!1)}})}})),$((function(){console.log("Init page confirm3");let e=function(){};ych.gui.pages.confirm3=e,e.on_init=function(){$("#page-confirm3-button-back").click((function(e){e.preventDefault(),window.ych_navigate("#")})),$("#page-confirm3-button-login").click((function(e){e.preventDefault(),window.ych_navigate("#login")}))}})),$((function(){console.log("Init page unconfirmed");ych.gui.pages.unconfirmed=function(){},$("#page-unconfirmed-button-back").click((function(e){e.preventDefault(),window.ych_navigate("#")}))})),$((function(){console.log("Init login");let e=function(){};ych.gui.pages.login=e,e.on_init=function(){$("#page-login-text-user").on("input",e.validate_fields),$("#page-login-text-pass").on("input",e.validate_fields),$("#page-login-text-totp").on("input",e.validate_fields),$("#page-login-button-back").click((function(e){e.preventDefault(),window.history.back()})),$("#page-login-button-login").click((function(t){t.preventDefault(),e.login_call()})),$("#page-login-text-user").on("keyup",(function(e){"Enter"!==e.key&&13!==e.keyCode||$("#page-login-text-pass").focus()})),$("#page-login-text-pass").on("keyup",(function(e){"Enter"!==e.key&&13!==e.keyCode||$("#page-login-text-totp").focus()})),$("#page-login-text-totp").on("keyup",(function(t){if("Enter"===t.key||13===t.keyCode){if($("#page-login-button-login").prop("disabled"))return;e.login_call()}})),e.cleanup()},e.on_show=function(e){$("#page-login-text-user").focus()},window.ych_gui_on_login=function(e,t){ych.data_update("login",t),t.assets.forEach((function(e,t){const n=e.coin;""!=e.address&&(ych.address[n]=e.address)}));for(let e in t.balances){const n=t.balances[e];ych.gui.update_balance(n)}t.assets.forEach((function(e,t){const n=e.coin,o=ych.data.coininfos[n];if(""!=e.address?(ych.address[n]=e.address,ych.locktime1[n]=e.locktime1,ych.locktime2[n]=e.locktime2):n in ych.address||(ych.address[n]=e.address,ych.locktime1[n]=e.locktime1,ych.locktime2[n]=e.locktime2),null!=e.extra&&(ych.asset_extra[n]=e.extra),"txout_t1"==o.type){ych.init_coinjs(n);const t=coinjs.pubkeys2MultisigAddressWithBackup(ych.pubkey1,ych.pubkey2,e.locktime1,e.locktime2),o=t.address;t.redeemScript;o!=e.address&&""!=e.address&&console.log(n+" address mismatch, server:"+e.address+", client:"+o)}if(ych.data_update("txouts",{coin:n,txouts:ych.data.profile.txouts}),"market"in ych.gui.parts&&"txouts"in ych.gui.parts.market&&(ych.gui.parts.market.txouts.update_debit_credit(n),ych.gui.current_market in ych.data.markets)){const t=ych.data.markets[ych.gui.current_market];t.coina==n&&ych.gui.parts.market.txouts.update_txouts_a(e.txoutspage),t.coinb==n&&ych.gui.parts.market.txouts.update_txouts_b(e.txoutspage)}}))},window.ych_gui_on_logout=function(){document.cookie="jwt=; expires=Thu, 01 Jan 1970 00:00:01 GMT;SameSite=Strict",ych.data.profile=void 0,ych.data_update("logout",{}),window.ych_ws_init()},e.cleanup=function(){$("#page-login-button-login").prop("disabled",!0),$("#page-login-text-user").val(""),$("#page-login-text-pass").val(""),$("#page-login-text-totp").val(""),$("#page-login-text-user").focus()},e.validate_fields=function(){const e=$("#page-login-text-user").val(),t=($("#page-login-text-pass").val(),$("#page-login-text-totp").val(),ych.gui.check_email(e));$("#page-login-button-login").prop("disabled",!t)},e.login_call=function(t){$("#page-login-box-err").hide(),$("#page-login-box-err").text(""),$("#page-login-button-login").prop("disabled",!0);const n=ych.gui.cleanup_email($("#page-login-text-user").val()),o=$("#page-login-text-pass").val(),r=$("#page-login-text-totp").val(),[a,i]=ych.user_keys_v1(n,o),s=n+i+r;ych.apicall({uri:window.ych_login_path,uprvk:a,digest:s,data:{user:n,upub:i,code:r},on_success:function(t){if(console.log(t),"unconfirmed"==t.access)return e.cleanup(),void window.ych_navigate("#unconfirmed");document.cookie="jwt="+t.access+";SameSite=Strict",window.location.hash="";let o="";const r=ych.get_cookie("jwt"),s=r.split(".");if(3==s.length){const e=s[1].replace("-","+").replace("_","/"),t=JSON.parse(window.atob(e));"uid"in t&&(o=t.uid)}if(""==o)return $("#page-login-box-err").show(),$("#page-login-box-err").text("Login token not recognized"),void console.log(r);e.cleanup(),window.ych_navigate("#"),ych.user=n,ych.pubkey1=i,ych.prvkey1=a,window.ych_gui_on_init(t)},on_error:function(t){$("#page-login-box-err").show(),$("#page-login-box-err").text(t),e.validate_fields()}})}})),$((function(){console.log("Init page markets");let e=function(){};ych.gui.pages.market=e,ych.gui.parts.market={},e.buys_up_side_down=!1,e.on_init=function(){$("#page-market-but-box-buy-sell-valign").on("click",(function(t){t.preventDefault(),e.hide_buysell_box()})),$("#page-market-but-box-buy-sell-halign").on("click",(function(t){t.preventDefault(),e.show_buysell_box()})),$("#part-orderform").hide(),$("#part-t-txouts").hide(),$("#part-w-txouts").hide(),$("#part-ordersbar").hide(),$("#market-trades-table").table_init({cols:[{name:"price",cls:"ytable-cell-r"},{name:"amounta",cls:"ytable-cell-r"},{name:"amountb",cls:"ytable-cell-r"},{name:"date",cls:"ytable-cell-r"}]}),$("#user-trades-table").table_init({cols:[{name:"price",cls:"ytable-cell-r"},{name:"amounta",cls:"ytable-cell-r"},{name:"amountb",cls:"ytable-cell-r"},{name:"date",cls:"ytable-cell-r"}]}),$("#user-orders-row-div").hide(),$("#page-market-box-buysell-radio-user").on("change",(function(t){t.preventDefault(),e.sync_valign_radio_user_market("user")})),$("#page-market-radio-valign-user").on("change",(function(t){t.preventDefault(),e.sync_buysell_radio_user_market("user")})),$("#page-market-box-buysell-radio-market").on("change",(function(t){t.preventDefault(),e.sync_valign_radio_user_market("market")})),$("#page-market-radio-valign-market").on("change",(function(t){t.preventDefault(),e.sync_buysell_radio_user_market("market")})),$("#page-market-but-box-buy").on("change",(function(t){t.preventDefault(),e.show_buy_in_box()})),$("#page-market-but-box-sell").on("change",(function(t){t.preventDefault(),e.show_sell_in_box()}))},e.on_data_init=function(t){for(let n in t.markets)if(n==ych.gui.current_market){const o=t.buys[n],r=t.sells[n],a=t.trades[n];ych.gui.parts.market.vols.update_buyvolumes(o);let i=0;o.length&&(i=o[0].price),ych.gui.parts.market.buy.fill_buyprice("makesell-offer-text",i),ych.gui.parts.market.vols.update_sellvolumes(r);let s=0;r.length&&(s=r[0].price),ych.gui.parts.market.sell.fill_sellprice("makebuy-offer-text",s),e.update_markettrades(a)}},e.on_show=function(t,n){0!=$("#page-market").width()?e.on_show_ready(t,n):setTimeout((function(){e.on_show(t,n)}),10)},e.on_show_ready=function(t,n){const o=t+"-"+n;if(!(o in ych.data.markets))return void window.ych_onnavigate("#unknown");ych.gui.current_market=o;let r=ych.data.markets[ych.gui.current_market];e.change(r.coina,r.coinb),ych.gui.parts.market.chart.setup(t,n);const a=$("#page-market").width();a<800&&$("#page-market-but-box-buy-sell-halign").hide(),null!=ych.data.profile&&a>800&&(e.show_buysell_box(),e.show_buy_in_box()),setTimeout((function(){e.check_buys_up_side_down_and_update()}),1e3)},e.show_buysell_box=function(){$("#part-orderform").hide(),$("#part-ordersbar").hide();let e=0;{const t=$("#page-market-prober1").width(),n=200,o=$("#page-market-prober2").width(),r=$("#page-market-prober3").width();e=t+n,e+=o>r?o:r,e+=20}$("#page-market-td-buy-sell").removeClass("page-market-td-buy-sell-off"),$("#page-market-part-makebuy-int").detach().appendTo("#page-market-box-buy-div-int"),$("#page-market-part-makesell-int").detach().appendTo("#page-market-box-sell-div-int"),$("#page-market-td-buy-sell").addClass("page-market-td-buy-sell-on"),$("#page-market-td-buy-sell").width(e),window.dispatchEvent(new Event("resize"))},e.hide_buysell_box=function(){$("#page-market-td-buy-sell").removeClass("page-market-td-buy-sell-on"),$("#page-market-part-makebuy-int").detach().appendTo("#page-market-part-makebuy"),$("#page-market-part-makesell-int").detach().appendTo("#page-market-part-makesell"),$("#page-market-td-buy-sell").addClass("page-market-td-buy-sell-off"),window.dispatchEvent(new Event("resize")),null!=ych.data.profile&&($("#part-orderform").show(),$("#part-ordersbar").show())},ych.gui.check_buys_up_side_down=function(){const t=document.getElementById("buy-volumes-table"),n=document.getElementById("sell-volumes-table");if(null==t||null==t)return!1;if(null==n||null==n)return!1;const o=t.getBoundingClientRect().x,r=n.getBoundingClientRect().x,a=e.buys_up_side_down,i=Math.abs(o-r)<10;return i!=a&&(e.buys_up_side_down=i,!0)},e.check_buys_up_side_down_and_update=function(){ych.gui.check_buys_up_side_down()&&ych.gui.current_market in ych.data.buys&&ych.gui.parts.market.vols.update_buyvolumes(ych.data.buys[ych.gui.current_market])},e.on_resize=function(){e.check_buys_up_side_down_and_update()},e.on_login=function(t){const n=$("#page-market").width();n<800&&$("#page-market-but-box-buy-sell-halign").hide(),null!=ych.data.profile&&n>800?(e.show_buysell_box(),e.show_buy_in_box()):($("#part-orderform").show(),$("#part-ordersbar").show()),ych.gui.prefs_txouts_debug?($("#part-t-txouts").show(),$("#part-w-txouts").show()):($("#part-t-txouts").hide(),$("#part-w-txouts").hide());for(let e in t.buys){const n=t.buys[e];e==ych.gui.current_market&&ych.gui.parts.market.orders.update_buyorders(n)}for(let e in t.sells){const n=t.sells[e];e==ych.gui.current_market&&ych.gui.parts.market.orders.update_sellorders(n)}for(let n in t.trades){const o=t.trades[n];n==ych.gui.current_market&&e.update_usertrades(o)}},e.on_logout=function(){$("#part-orderform").hide(),$("#part-t-txouts").hide(),$("#part-w-txouts").hide(),$("#part-ordersbar").hide(),$("#page-market-td-buy-sell").addClass("page-market-td-buy-sell-off"),e.hide_buysell_box()},e.on_market=function(e){if(e.name!=ych.gui.current_market)return;ych.is_logged();e.service?$("#part-closed").show():e.open?$("#part-closed").hide():$("#part-closed").show()},e.on_balance=function(e){let t=e.coin;ych.gui.current_market.endsWith("-"+t)&&$("#makebuy-span-dotslide").dot_slide_max_html(ych.gui.format_amount(e.free)),ych.gui.current_market.startsWith(t+"-")&&$("#makesell-span-dotslide").dot_slide_max_html(ych.gui.format_amount(e.free)),ych.gui.parts.market.txouts.update_debit_credit(t)},e.change=function(t,n){let o=ych.gui.current_market;o!=t+"-"+n&&ych.gui.parts.market.trades.save(o),ych.gui.current_market=t+"-"+n,ych.gui.parts.market.chart.chart_inited&&ych.gui.parts.market.chart.update();let r=0,a=0;if(ych.gui.current_market in ych.data.buys){let e=ych.data.buys[ych.gui.current_market];e.length&&(a=e[0].price)}if(ych.gui.current_market in ych.data.sells){let e=ych.data.sells[ych.gui.current_market];e.length&&(r=e[0].price)}let i=ych.buy_fee(t,n),s=ych.sell_fee(t,n);if($("#makebuy-button").text("Buy "+t),$("#makesell-button").text("Sell "+t),$("#makebuy-price-label").text(n),$("#makesell-price-label").text(n),$("#makebuy-quantity-label").text(t),$("#makesell-quantity-label").text(t),$("#makesell-get-label").text(n),$("#makesell-fee-fee").text("Fee "+(100*s).toFixed(3)+"%:"),$("#makesell-fee-label").text(t),$("#makesell-total-label").text(t),$("#makesell-free-label").text(t),$("#makesell-offer-label").text(n),$("#makebuy-get-label").text(t),$("#makebuy-fee-fee").text("Fee "+(100*i).toFixed(3)+"%:"),$("#makebuy-fee-label").text(n),$("#makebuy-total-label").text(n),$("#makebuy-free-label").text(n),$("#makebuy-offer-label").text(n),$("#buy-volumes-table-hcell-coinA").text(t),$("#buy-volumes-table-hcell-coinB").text(n),$("#sell-volumes-table-hcell-coinA").text(t),$("#sell-volumes-table-hcell-coinB").text(n),$("#market-trades-table-hcell-coinA").text(t),$("#market-trades-table-hcell-coinB").text(n),$("#buy-orders-table-hcell-coinA").text(t),$("#buy-orders-table-hcell-coinB").text(n),$("#sell-orders-table-hcell-coinA").text(t),$("#sell-orders-table-hcell-coinB").text(n),$("#user-trades-table-hcell-coinA").text(t),$("#user-trades-table-hcell-coinB").text(n),ych.gui.parts.market.sell.fill_sellprice("makebuy-offer-text",r),ych.gui.parts.market.buy.fill_buyprice("makesell-offer-text",a),$("#txouts-acoin-title").text(t),$("#txouts-bcoin-title").text(n),ych.gui.parts.market.trades.restore(ych.gui.current_market),ych.data.markets[ych.gui.current_market].open&&!ych.data.markets[ych.gui.current_market].service){ych.is_logged()&&(e.clear_error_buy(),e.clear_error_sell(),ych.gui.parts.market.buy.validate_buy_fields(),ych.gui.parts.market.sell.validate_sell_fields()),$("#part-closed").hide()}else $("#part-closed").show();if(ych.gui.check_buys_up_side_down(),ych.gui.parts.market.vols.update_buyvolumes(ych.data.buys[ych.gui.current_market]),ych.gui.parts.market.vols.update_sellvolumes(ych.data.sells[ych.gui.current_market]),e.update_markettrades(ych.data.trades[ych.gui.current_market]),null!=ych.data.profile){ych.gui.current_market in ych.data.profile.buys||(ych.data.profile.buys[ych.gui.current_market]=[]),ych.gui.current_market in ych.data.profile.sells||(ych.data.profile.sells[ych.gui.current_market]=[]),ych.gui.current_market in ych.data.profile.trades||(ych.data.profile.trades[ych.gui.current_market]=[]),ych.gui.parts.market.orders.update_buyorders(ych.data.profile.buys[ych.gui.current_market]),ych.gui.parts.market.orders.update_sellorders(ych.data.profile.sells[ych.gui.current_market]),e.update_usertrades(ych.data.profile.trades[ych.gui.current_market]),t in ych.data.profile.txouts||(ych.data.profile.txouts[t]=[]),n in ych.data.profile.txouts||(ych.data.profile.txouts[n]=[]),ych.gui.parts.market.txouts.update_txouts_a(ych.data.profile.txouts[t]),ych.gui.parts.market.txouts.update_txouts_b(ych.data.profile.txouts[n]);const o=ych.data.profile.balances[t],r=ych.data.profile.balances[n];void 0!==o&&void 0!==o.free&&($("#makesell-span-dotslide").dot_slide_max_html(ych.gui.format_amount(o.free)),ych.gui.parts.market.txouts.update_debit_credit(o.coin),ych.gui.update_balance(o)),void 0!==r&&void 0!==r.free&&($("#makebuy-span-dotslide").dot_slide_max_html(ych.gui.format_amount(r.free)),ych.gui.parts.market.txouts.update_debit_credit(r.coin),ych.gui.update_balance(r))}},e.sync_order_tab=!1,e.sync_valign_radio_user_market=function(t){e.sync_order_tab||(e.sync_order_tab=!0,"user"==t&&($("#page-market-radio-valign-user").prop("checked",!0).trigger("change"),$("#page-market-radio-valign-market").prop("checked",!1)),"market"==t&&($("#page-market-radio-valign-market").prop("checked",!0).trigger("change"),$("#page-market-radio-valign-user").prop("checked",!1)),e.blur_order_tab(),"user"==t&&e.show_user_orders(),"market"==t&&e.show_market_orders(),e.sync_order_tab=!1)},e.sync_buysell_radio_user_market=function(t){e.sync_order_tab||(e.sync_order_tab=!0,"user"==t&&($("#page-market-box-buysell-radio-user").prop("checked",!0).trigger("change"),$("#page-market-box-buysell-radio-market").prop("checked",!1)),"market"==t&&($("#page-market-box-buysell-radio-market").prop("checked",!0).trigger("change"),$("#page-market-box-buysell-radio-user").prop("checked",!1)),e.blur_order_tab(),"user"==t&&e.show_user_orders(),"market"==t&&e.show_market_orders(),e.sync_order_tab=!1)},e.show_user_orders=function(){$("#market-orders-row-div").hide(),$("#user-orders-row-div").show()},e.show_market_orders=function(){$("#user-orders-row-div").hide(),$("#market-orders-row-div").show();ych.gui.check_buys_up_side_down()&&ych.gui.parts.market.vols.update_buyvolumes(ych.data.buys[ych.gui.current_market])},e.blur_order_tab=function(){setTimeout((function(){$("#page-market-radio-valign-user").trigger("blur"),$("#page-market-radio-valign-market").trigger("blur"),$("#page-market-box-buysell-radio-user").trigger("blur"),$("#page-market-box-buysell-radio-market").trigger("blur")}),50)},e.show_buy_in_box=function(){e.sync_buysell_tab||(e.sync_buysell_tab=!0,$("#page-market-box-sell-div-int").hide(),$("#page-market-box-buy-div-int").show(),$("#makebuy-quantity-text").focus(),$("#page-market-box-buy-sell-tabs").removeClass("page-market-td-buy-sell-box-sell"),$("#page-market-box-buy-sell-tabs").addClass("page-market-td-buy-sell-box-buy"),$("#page-market-box-buy-sell-topbar2-left").removeClass("page-market-td-buy-sell-box-sell"),$("#page-market-box-buy-sell-topbar2-right").removeClass("page-market-td-buy-sell-box-sell"),$("#page-market-box-buy-sell-topbar2-left").addClass("page-market-td-buy-sell-box-buy"),$("#page-market-box-buy-sell-topbar2-right").addClass("page-market-td-buy-sell-box-buy"),$("#page-market-but-box-buy").prop("checked",!0).trigger("change"),$("#page-market-but-box-sell").prop("checked",!1),e.sync_buysell_tab=!1)},e.show_sell_in_box=function(){e.sync_buysell_tab||(e.sync_buysell_tab=!0,$("#page-market-box-buy-div-int").hide(),$("#page-market-box-sell-div-int").show(),$("#makesell-quantity-text").focus(),$("#page-market-box-buy-sell-tabs").removeClass("page-market-td-buy-sell-box-buy"),$("#page-market-box-buy-sell-tabs").addClass("page-market-td-buy-sell-box-sell"),$("#page-market-box-buy-sell-topbar2-left").removeClass("page-market-td-buy-sell-box-buy"),$("#page-market-box-buy-sell-topbar2-right").removeClass("page-market-td-buy-sell-box-buy"),$("#page-market-box-buy-sell-topbar2-left").addClass("page-market-td-buy-sell-box-sell"),$("#page-market-box-buy-sell-topbar2-right").addClass("page-market-td-buy-sell-box-sell"),$("#page-market-but-box-sell").prop("checked",!0).trigger("change"),$("#page-market-but-box-buy").prop("checked",!1),e.sync_buysell_tab=!1)},e.update_markettrades=function(e){if($("#market-trades-table").table_clear(),null==e)return;e.forEach((function(e,t){1==e.type?ych.gui.parts.market.buy.fill_buyprice("market-trades-table-"+t+"-price",e.sellprice):2==e.type&&ych.gui.parts.market.sell.fill_sellprice("market-trades-table-"+t+"-price",e.buyprice),$("#market-trades-table-"+t+"-amountb").html(ych.gui.format_amount(BigInt(e.amountb))),$("#market-trades-table-"+t+"-amounta").html(ych.gui.format_amount(BigInt(e.amounta))),$("#market-trades-table-"+t+"-date").html(ych.gui.format_date(e.date))}));const t=e.length;if(t<ych.gui.pagesize)for(let e=t;e<ych.gui.pagesize;e++)$("#market-trades-table-"+e+"-amountb").html('<span class="yamount-B">&#8239;</span>')},e.update_usertrades=function(e){$("#user-trades-table").table_clear(),e.forEach((function(e,t){1==e.type?ych.gui.parts.market.buy.fill_buyprice("user-trades-table-"+t+"-price",e.buyprice):2==e.type&&ych.gui.parts.market.sell.fill_sellprice("user-trades-table-"+t+"-price",e.sellprice),$("#user-trades-table-"+t+"-amountb").html(ych.gui.format_amount(BigInt(e.amountb))),$("#user-trades-table-"+t+"-amounta").html(ych.gui.format_amount(BigInt(e.amounta))),$("#user-trades-table-"+t+"-date").html(ych.gui.format_date(e.date))}));const t=e.length;if(t<ych.gui.pagesize)for(let e=t;e<ych.gui.pagesize;e++)$("#user-trades-table-"+e+"-amountb").html('<span class="yamount-B">&#8239;</span>')},e.clear_error_buy=function(){$("#makebuy-error-text").css("background-color","rgba(0,0,0,0)"),$("#makebuy-error-text").text(" ")},e.clear_error_sell=function(){$("#makesell-error-text").css("background-color","rgba(0,0,0,0)"),$("#makesell-error-text").text(" ")},e.show_error_buy=function(e){$("#makebuy-error-text").css("background-color","rgba(255,0,0,0.25)"),$("#makebuy-error-text").text(e)},e.show_error_sell=function(e){$("#makesell-error-text").css("background-color","rgba(255,0,0,0.25)"),$("#makesell-error-text").text(e)},e.on_ws_markettradesupdate=function(t){const n=t.objects[0];n.coina+"-"+n.coinb==ych.gui.current_market&&e.update_markettrades(n.page)},e.on_ws_usertradesupdate=function(t){const n=t.objects[0];n.coina+"-"+n.coinb==ych.gui.current_market&&e.update_usertrades(n.page)}})),$((function(){console.log("Init page backup");let e=function(){};ych.gui.pages.backup=e,e.on_init=function(){$("#page-backup-button-back").on("click",(function(e){e.preventDefault(),window.history.back()})),$("#page-backup-text-email").on("input",e.validate_fields),$("#page-backup-text-password").on("input",e.validate_fields),$("#page-backup-text-coin").on("input",e.validate_fields),$("#page-backup-text-toaddress").on("input",e.validate_fields),$("#page-backup-text-quantity").on("input",e.validate_fields),$("#page-backup-text-fee").on("input",e.validate_fields),$("#page-backup-text-amount").on("input",e.validate_fields),$("#page-backup-text-address").on("input",e.validate_fields),$("#page-backup-text-txout").on("input",e.validate_fields),$("#page-backup-text-upubk").on("input",e.validate_fields),$("#page-backup-text-dpubk").on("input",e.validate_fields),$("#page-backup-text-locktime1").on("input",e.validate_fields),$("#page-backup-text-locktime2").on("input",e.validate_fields),$("#page-backup-textarea-redeem").on("input",e.validate_fields),$("#page-backup-file-backup").on("input",e.load),$("#page-backup-button-create").on("click",(function(t){t.preventDefault(),e.create_backup()}))},e.on_data_init=function(e){let t="";ych.data.coins.forEach((function(e,n){const o=ych.data.coininfos[e];t+='<option value="'+o.coin+'" />'})),$("#page-backup-combo-coin").html(t)},e.on_logout=function(){},e.clear_error=function(){$("#page-backup-box-err").removeClass("make-withdraw-error-ok"),$("#page-backup-box-err").removeClass("make-withdraw-error-err"),$("#page-backup-box-err").text(" ")},e.show_error=function(e){$("#page-backup-box-err").removeClass("make-withdraw-error-ok"),$("#page-backup-box-err").addClass("make-withdraw-error-err"),$("#page-backup-box-err").text(e)},e.validate_fields=function(){const t=$("#page-backup-text-email").val();if(!ych.gui.check_email(t))return void e.show_error("Email is not recognized");const n=$("#page-backup-text-password").val();if(""==n)return void e.show_error("Password is provided");const[o,r]=ych.user_keys_v1(t,n),a=$("#page-backup-text-coin").val();if(!(a in ych.data.coininfos))return void e.show_error("Choose valid coin ("+a+")");ych.init_coinjs(a);let i=$("#page-backup-text-toaddress").val();if(!coinjs.addressDecode(i))return void e.show_error("Address (destination) is not valid");if(isNaN($("#page-backup-text-quantity").val()))return void e.show_error("Amount is not valid");let s=parseFloat($("#page-backup-text-quantity").val());if(isNaN($("#page-backup-text-fee").val()))return void e.show_error("Fee is not valid");let c=parseFloat($("#page-backup-text-fee").val());if(c<1e-5)return void e.show_error("Fee is less than 0.00001 (min relay fee)");if(isNaN($("#page-backup-text-amount").val()))return void e.show_error("Backup Amount is not valid");let l=parseFloat($("#page-backup-text-amount").val());if(Math.abs(s+c-l)>1e-8)return void e.show_error("Amount+Fee is not equal Backup Amount");let u=$("#page-backup-text-address").val();if(!coinjs.addressDecode(u))return void e.show_error("Account Address is not valid");let d=$("#page-backup-text-txout").val();if(!d.includes(":"))return void e.show_error("Txout expected in format txhash:nout");let h=d.split(":");if(2!=h.length)return void e.show_error("Txout expected in format txhash:nout");let p=h[0],f=(h[1],Crypto.util.hexToBytes(p));if(32!=f.length)return void e.show_error("Txhash expected to be 64 length");let m=!0;for(let e=0;e<32;e++)if(isNaN(f[e])){m=!1;break}if(!m)return void e.show_error("Txhash can not be decoded");let g=$("#page-backup-text-upubk").val();if(""==g)return void e.show_error("Your pubkey can not be empty");if(g!=r)return void e.show_error("Your pubkey does not match Email/Password");let y=Crypto.util.hexToBytes(g),_=!0;for(let e=0;e<32;e++)if(isNaN(y[e])){_=!1;break}if(!_)return void e.show_error("Your pubkey can not be decoded");let b=$("#page-backup-text-dpubk").val();if(""==b)return void e.show_error("DEX pubkey can not be empty");let v=Crypto.util.hexToBytes(b),w=!0;for(let e=0;e<32;e++)if(isNaN(v[e])){w=!1;break}if(!w)return void e.show_error("DEX pubkey can not be decoded");let x=parseInt($("#page-backup-text-locktime1").val());if(isNaN(x))return void e.show_error("Locktime1 can not be read");let k=parseInt($("#page-backup-text-locktime2").val());if(isNaN(k))return void e.show_error("Locktime2 can not be read");let T=coinjs.pubkeys2MultisigAddressWithBackup(g,b,x,k);if(console.log("multi",T),T.address!=u)return void e.show_error("Account address does not match Multisig address from redeem script");let C=$("#page-backup-textarea-redeem").val();C=C.replace(/\s+/g,""),C=C.replaceAll("\n",""),C=C.replaceAll("\r",""),T.redeemScript==C?(e.clear_error(),$("#page-backup-box-err").text("Ready to create a backup transaction")):e.show_error("Redeem Script does not match provided")},e.load=function(){console.log("load");let t=document.getElementById("page-backup-file-backup").files[0],n=new FileReader;n.onload=function(){let t=this.result,n=new Uint8Array(t),o=String.fromCharCode.apply(null,n).split(".");"v1"==o[0]?(console.log(o.length),console.log(o),10==o.length?($("#page-backup-text-coin").val(o[1]),$("#page-backup-text-amount").val(parseFloat(o[2])/1e8),$("#page-backup-text-address").val(o[3]),$("#page-backup-text-txout").val(o[4]),$("#page-backup-text-upubk").val(o[5]),$("#page-backup-text-dpubk").val(o[6]),$("#page-backup-text-locktime1").val(o[7]),$("#page-backup-text-locktime2").val(o[8]),$("#page-backup-textarea-redeem").val(o[9]),e.validate_fields()):console.log("Backup file format not recognized(2)")):console.log("Backup file format not recognized")},n.readAsArrayBuffer(t)},e.create_backup=function(){const t=$("#page-backup-text-txout").val();if(!t.includes(":"))return void e.show_error("Txout expected in format txhash:nout");let n=t.split(":");if(2!=n.length)return void e.show_error("Txout expected in format txhash:nout");const o=n[0],r=parseInt(n[1]),a=$("#page-backup-text-toaddress").val(),i=parseFloat($("#page-backup-text-quantity").val()),s=parseFloat($("#page-backup-text-amount").val()),c=$("#page-backup-text-upubk").val(),l=$("#page-backup-text-dpubk").val(),u=parseInt($("#page-backup-text-locktime1").val()),d=parseInt($("#page-backup-text-locktime2").val()),h=coinjs.pubkeys2MultisigAddressWithBackup(c,l,u,d),p=$("#page-backup-text-email").val(),f=$("#page-backup-text-password").val(),[m,g]=ych.user_keys_v1(p,f);let y=coinjs.transaction();y.nTime=Date.now()/1e3|0,y.lock_time=u+1,y.addinput(o,r,Crypto.util.hexToBytes(h.redeemScript),null,s),y.addoutput(a,i);const _=coinjs.privkey2wif(m),b=y.transactionSig(0,_,1);var v=coinjs.script();v.writeBytes(Crypto.util.hexToBytes(b)),v.writeOp(81),v.writeOp(0),v.writeBytes(Crypto.util.hexToBytes(h.redeemScript)),y.ins[0].script=v,$("#page-backup-textarea-rawtx").val(y.serialize())}})),$((function(){console.log("Init page broadcast");let e=function(){};ych.gui.pages.broadcast=e,e.on_init=function(){$("#page-broadcast-button-back").on("click",(function(e){e.preventDefault(),window.history.back()})),$("#page-broadcast-button-push").on("click",(function(t){t.preventDefault(),e.do_broadcast()}))},e.on_data_init=function(e){},e.on_show=function(e){$("#page-broadcast-text-coin").text(e)},e.on_logout=function(){},e.do_broadcast=function(){const e=$("#page-broadcast-text-coin").text(),t=$("#page-broadcast-textarea-rawtx").val();ych.apicall({uri:"/u/broadcast",data:{coin:e,rawtx:t},on_success:function(e){$("#page-broadcast-box-err").text(e.error)},on_error:function(e){$("#page-broadcast-box-err").text(e)}})}})),$((function(){console.log("Init dialog pass");let e=function(){};ych.gui.forms.pass1=e,e.inited=!1,e.validate=function(){const t=$("#form-pass1-inp-password").val();e.div.dialog("close");const[n,o]=ych.user_keys_v1(ych.user,t);o==ych.pubkey1?(ych.prvkey1=n,e.div.onready(e.div.onready_arg)):(ych.prvkey1="",e.div.onfail())},e.init=function(){e.inited=!0,e.div=$("#form-pass1").dialog({appendTo:"#yall",autoOpen:!1,height:300,width:400,modal:!0,buttons:{Validate:e.validate,Cancel:function(){e.div.dialog("close")}},close:function(){e.div_form[0].reset()}}),e.div_form=e.div.find("form").on("submit",(function(t){t.preventDefault(),e.validate(),e.div.dialog("close")}))},ych.gui.call_with_pass1=function(){return e.inited||e.init(),new Promise(((t,n)=>{""==ych.prvkey1?(e.div.onready=function(){t({ok:!0,msg:""})},e.div.onfail=function(){t({ok:!1,msg:"public key mismatch"})},e.div.dialog("open")):t({ok:!0,msg:""})}))}})),$((function(){console.log("Init dialog send-adj");let e=function(){};ych.gui.forms["send-adj"]=e,e.validate=function(){e.div.dialog("close"),console.log("todo onready"),e.div.onready()},e.div=$("#form-send-adj").dialog({appendTo:"#yall",autoOpen:!1,height:300,width:500,modal:!0,buttons:{Confirm:e.validate,Cancel:function(){e.div.dialog("close"),console.log("todo onfail1"),e.div.onfail()}},close:function(){e.div_form[0].reset()}}),e.div_form=e.div.find("form").on("submit",(function(t){t.preventDefault(),e.validate(),e.div.dialog("close")})),e.exec=function(){return new Promise(((t,n)=>{e.div.onready=function(){t({ok:!0,msg:""})},e.div.onfail=function(){t({ok:!1,msg:"cancel"})},e.div.dialog("open")}))}})),$((function(){console.log("Init dialog send-preview");let e=function(){};ych.gui.forms["send-crypto-preview1"]=e,e.div=$("#form-tx-preview").dialog({appendTo:"#yall",autoOpen:!1,height:300,width:600,modal:!0,buttons:{Close:function(){e.div.dialog("close")}},close:function(){e.div_form[0].reset()}}),e.div_form=e.div.find("form").on("submit",(function(t){t.preventDefault(),e.div.dialog("close")})),e.exec=function(){e.div.dialog("open")}})),$((function(){console.log("Init dialog order-chk");let e=function(){};ych.gui.forms["order-chk"]=e,e.validate=function(){e.div.dialog("close"),e.div.onready()},e.div=$("#form-order-chk").dialog({appendTo:"#yall",autoOpen:!1,height:400,width:600,modal:!0,buttons:{Confirm:e.validate,Cancel:function(){e.div.dialog("close"),e.div.onfail()}},close:function(){e.div_form[0].reset()}}),e.div_form=e.div.find("form").on("submit",(function(t){t.preventDefault(),e.validate(),e.div.dialog("close")})),e.exec=function(t){const n=ych.data.coininfos[t.coina],o=ych.data.coininfos[t.coinb],r=n.ext.priceext,a=o.ext.priceext;return $("#form-order-chk-span-warn").text(t.text),$("#form-order-chk-div-price").html(ych.gui.format_amount(t.price)),$("#form-order-chk-div-amounta").html("&nbsp;&nbsp;&nbsp;≈$"+(Number(t.amounta)/1e8*r).toFixed(2)+" "+ych.gui.format_amount(t.amounta)),$("#form-order-chk-div-amountb").html("&nbsp;&nbsp;&nbsp;≈$"+(Number(t.amountb)/1e8*a).toFixed(2)+" "+ych.gui.format_amount(t.amountb)),$("#form-order-chk-span-price-coin").text(t.coinb),$("#form-order-chk-span-amounta-coin").text(t.coina),$("#form-order-chk-span-amountb-coin").text(t.coinb),$("#form-order-chk-span-ext-price-coin").text(t.coinb),$("#form-order-chk-span-ext-amounta-coin").text(t.coina),$("#form-order-chk-span-ext-amountb-coin").text(t.coinb),$("#form-order-chk-span-amounta-text").text(t.coina+" Amount:"),$("#form-order-chk-span-amountb-text").text(t.coinb+" Amount:"),$("#form-order-chk-span-ext-amounta-text").text(t.coina+" Amount:"),$("#form-order-chk-span-ext-amountb-text").text(t.coinb+" Amount:"),$("#form-order-chk-span-ext-price-text").html("<b>"+t.ext_name+"</b> price at <b>"+ych.gui.format_date(t.ext_time)+"</b>"),$("#form-order-chk-div-ext-price").html(ych.gui.format_amount(t.ext_price)),$("#form-order-chk-div-ext-amounta").html("&nbsp;&nbsp;&nbsp;≈$"+(Number(t.ext_amounta)/1e8*r).toFixed(2)+" "+ych.gui.format_amount(t.ext_amounta)),$("#form-order-chk-div-ext-amountb").html("&nbsp;&nbsp;&nbsp;≈$"+(Number(t.ext_amountb)/1e8*a).toFixed(2)+" "+ych.gui.format_amount(t.ext_amountb)),$("#form-order-chk-div-loss").html("&nbsp;&nbsp;&nbsp;≈$"+(Number(t.ext_over)/1e8*a).toFixed(2)),$("#form-order-chk-span-loss-text").text(t.ext_text),$("#form-order-chk-box-err").html(t.warn),t.ext_fp>=50?$("#form-order-chk-box-err").css("background-color","rgba(255,128,0,0.25)"):$("#form-order-chk-box-err").css("background-color","rgba(255,255,0,0.25)"),new Promise(((t,n)=>{e.div.onready=function(){t({ok:!0,msg:""})},e.div.onfail=function(){t({ok:!1,msg:"cancel"})},e.div.dialog("open")}))}})),$((function(){console.log("Init part market-chart");let e=function(){};ych.gui.parts.market.chart=e;let t={t:"2019-01-01T00:00:00.000000Z",o:0,h:0,l:0,c:0,v:0};e.chart_inited=!1,e.chart_datas={},e.chart_periods=[60,300,900,1800,3600,14400,86400,604800],e.on_init=function(){},e.on_data_init=function(){for(market in ych.data.markets)e.chart_datas[market]={},e.chart_periods.forEach((function(n,o){e.chart_datas[market][n]={},e.chart_datas[market][n].data=[t],e.chart_datas[market][n].loaded=!1}))},e.on_show=function(){},e.setup=function(t,n){e.chart_inited||(e.dojichart=new DojiChart.core.Chart(document.getElementById("chartarea"),{fieldMap:{time:"t",open:"o",high:"h",low:"l",close:"c",volume:"v",ext:"e"},crosshair:!0}),e.candle_layer=new DojiChart.layer.CandleLayer({}),e.price_panel=new DojiChart.panel.TimeValuePanel({primaryLayer:e.candle_layer,height:250,grid:!0,valueGridLayerConfig:{lineColor:"#80808040"},timeGridLayerConfig:{lineColor:"#80808040"}}),e.ext_layer=new DojiChart.layer.indicator.SimpleExtLayer({period:1,color:"orange"}),e.price_panel.addLayer(e.ext_layer),e.dojichart.addComponent("price",e.price_panel),e.time_labels_panel=new DojiChart.panel.TimeLabelsPanel,e.dojichart.addComponent("timelabels",e.time_labels_panel),e.volume_panel=new DojiChart.panel.TimeValuePanel({height:100,primaryAtBack:!0,primaryLayer:new DojiChart.layer.indicator.VolumeLayer({layerIndex:1,barColor:"#84A7B3",barWidth:5,minHeightPx:1})}),e.dojichart.addComponent("volume",e.volume_panel,!0),ych.gui.is_dark?(e.candle_layer.wickColor="white",e.candle_layer._config.wickColor="white"):(e.candle_layer.wickColor="black",e.candle_layer._config.wickColor="black"),e.chart_inited=!0,e.update())},$('[name="chart-interval-name"]').on("change",(function(){e.update()})),e.interval_to_period=function(e){return"M1"==e?60:"M5"==e?300:"M15"==e?900:"M30"==e?1800:"H1"==e?3600:"H4"==e?14400:"D"==e?86400:"W"==e?604800:60},e.load_data=function(t,n){$.ajax({type:"GET",url:"/u/chart/"+t+"/"+n,dataType:"json",success:function(o){e.chart_datas[t][n].loaded=!0,e.chart_datas[t][n].data=o,e.update()},error:function(e,t,n){console.log("chart load error:",n)}})},e.update=function(){let t=ych.gui.current_market;if(""==t)return;let n=$('[name="chart-interval-name"]:checked').val(),o=e.interval_to_period(n);t in e.chart_datas||(e.chart_datas[t]={}),o in e.chart_datas[t]||(e.chart_datas[t][o]={},e.chart_datas[t][o].data=[]);let r=e.chart_datas[t][o];r.loaded||e.load_data(t,o),e.dojichart.loadData(r.data,t,n)},$("#chart-scroll-start").click((function(t){t.preventDefault(),e.dojichart.scroll(0,!1)})),$("#chart-scroll-end").click((function(t){t.preventDefault(),e.dojichart.scroll(0,!0)})),e.on_scroll_event=function(t){t.preventDefault();let n=$(t.target).data("value"),o=e.dojichart.getOffset();e.dojichart.scroll(o+parseInt(n),!1)},$("#chart-scroll-back100").click(e.on_scroll_event),$("#chart-scroll-forward100").click(e.on_scroll_event),$("#chart-scroll-back10").click(e.on_scroll_event),$("#chart-scroll-forward10").click(e.on_scroll_event),e.on_ws_newcandle=function(t){const n=t.objects[0],o=t.objects[1],r=$('[name="chart-interval-name"]:checked').val(),a=e.interval_to_period(r);let i=!1;e.chart_periods.forEach((function(t,r){if(t in n){let r=n[t].coina+"-"+n[t].coinb;r in e.chart_datas||(e.chart_datas[r]={}),t in e.chart_datas[r]||(e.chart_datas[r][t]={},e.chart_datas[r][t].data=[]);let s=e.chart_datas[r][t].data;s.length>0&&s[s.length-1].tt==o[t].tt&&(s[s.length-1]=o[t]),s.length>1&&s[s.length-2].tt==o[t].tt&&(s[s.length-2]=o[t]),s.length>0&&s[s.length-1].tt==n[t].tt?s[s.length-1]=n[t]:s.push(n[t]),a==t&&(i=!0)}})),i&&e.update()},e.on_ws_updatecandle=function(t){let n=t.objects[0],o=$('[name="chart-interval-name"]:checked').val(),r=e.interval_to_period(o),a=!1;n.forEach((function(t){let n=t.coina+"-"+t.coinb;if(n in e.chart_datas&&t.p in e.chart_datas[n]){let o=e.chart_datas[n][t.p].data;if(0==o.length)return;o.length>0&&o[o.length-1].tt==t.tt&&(o[o.length-1]=t),o.length>1&&o[o.length-2].tt==t.tt&&(o[o.length-2]=t)}r==t.p&&(a=!0)})),a&&e.update()}})),$((function(){console.log("Init part market-vols");let e=ych.gui.pages.market,t=function(){};ych.gui.parts.market.vols=t,t.on_show=function(e,n){"sum_a_buy_coin"in t||(t.sum_a_buy_coin="a"),"sum_a_sell_coin"in t||(t.sum_a_sell_coin="a")},t.on_coininfo=function(e){if(null==ych.gui.current_market)return;if(!(ych.gui.current_market in ych.data.markets))return;const n=ych.data.markets[ych.gui.current_market].coina,o=ych.data.markets[ych.gui.current_market].coinb;e.coin!=n&&e.coin!=o||t.update()},t.update=function(){t.update_buyvolumes(ych.data.buys[ych.gui.current_market]),t.update_sellvolumes(ych.data.sells[ych.gui.current_market])},$("#buy-volumes-table-but-flip").click((function(e){e.preventDefault(),"a"==t.sum_a_buy_coin?t.sum_a_buy_coin="b":"b"==t.sum_a_buy_coin&&(t.sum_a_buy_coin="a"),t.update_buyvolumes(ych.data.buys[ych.gui.current_market])})),$("#sell-volumes-table-but-flip").click((function(e){e.preventDefault(),"a"==t.sum_a_sell_coin?t.sum_a_sell_coin="b":"b"==t.sum_a_sell_coin&&(t.sum_a_sell_coin="a"),t.update_sellvolumes(ych.data.sells[ych.gui.current_market])})),$("#buy-volumes-table").table_init({cols:[{name:"price",cls:"ytable-cell-r"},{name:"amounta",cls:"ytable-cell-r"},{name:"amountb",cls:"ytable-cell-r"},{name:"total",cls:"ytable-cell-r"}]}),$("#sell-volumes-table").table_init({cols:[{name:"price",cls:"ytable-cell-r"},{name:"amounta",cls:"ytable-cell-r"},{name:"amountb",cls:"ytable-cell-r"},{name:"total",cls:"ytable-cell-r"}]}),t.fill_coina_nb=function(e,t){let n=ych.gui.format_amount(t);$("#"+e).html("<a class='amounta-a' id='"+e+"-a' href='"+window.location.hash+"'>"+n+"</a>"),$("#"+e+"-a").click((function(e){e.preventDefault(),ych.is_logged()&&($("#makebuy-quantity-text").val((Number(t)/1e8).toFixed(8)),$("#makesell-quantity-text").val((Number(t)/1e8).toFixed(8)),ych.gui.parts.market.buy.validate_buy_fields(),ych.gui.parts.market.sell.validate_sell_fields())}))},t.update_buyvolumes=function(n){if("a"==t.sum_a_buy_coin?$("#buy-volumes-table-but-flip").text("≡A"):"b"==t.sum_a_buy_coin&&$("#buy-volumes-table-but-flip").text("≡B"),$("#buy-volumes-table").table_clear(),null==n)return;let o=0n,r=0n;n.forEach((function(n,a){let i=a;e.buys_up_side_down&&(i=ych.gui.pagesize-a-1),o+=n.amounta,r+=n.amountb,"b"==t.sum_a_buy_coin?$("#buy-volumes-table-"+i+"-total").html(ych.gui.format_amount(BigInt(r))):t.fill_coina_nb("buy-volumes-table-"+i+"-total",BigInt(o)),$("#buy-volumes-table-"+i+"-amountb").html(ych.gui.format_amount(BigInt(n.amountb))),t.fill_coina_nb("buy-volumes-table-"+i+"-amounta",BigInt(n.amounta)),ych.gui.parts.market.buy.fill_buyprice("buy-volumes-table-"+i+"-price",n.price,!0)}));const a=n.length;if(a<ych.gui.pagesize)for(let t=a;t<ych.gui.pagesize;t++){let n=t;e.buys_up_side_down&&(n=ych.gui.pagesize-t-1),$("#buy-volumes-table-"+n+"-amountb").html('<span class="yamount-B">&#8239;</span>')}},t.update_sellvolumes=function(e){if("a"==t.sum_a_sell_coin?$("#sell-volumes-table-but-flip").text("≡A"):"b"==t.sum_a_sell_coin&&$("#sell-volumes-table-but-flip").text("≡B"),$("#sell-volumes-table").table_clear(),null==e)return;let n=0n,o=0n;e.forEach((function(e,r){n+=e.amounta,o+=e.amountb;"b"==t.sum_a_sell_coin?$("#sell-volumes-table-"+r+"-total").html(ych.gui.format_amount(BigInt(o))):t.fill_coina_nb("sell-volumes-table-"+r+"-total",BigInt(n)),$("#sell-volumes-table-"+r+"-amountb").html(ych.gui.format_amount(BigInt(e.amountb))),t.fill_coina_nb("sell-volumes-table-"+r+"-amounta",BigInt(e.amounta)),ych.gui.parts.market.sell.fill_sellprice("sell-volumes-table-"+r+"-price",e.price,!0)}));const r=e.length;if(r<ych.gui.pagesize)for(let e=r;e<ych.gui.pagesize;e++)$("#sell-volumes-table-"+e+"-amountb").html('<span class="yamount-B">&#8239;</span>')},t.on_ws_buysupdate=function(e){const n=e.objects[0];if(n.coina+"-"+n.coinb!=ych.gui.current_market)return;t.update_buyvolumes(n.buyspage);let o=0;n.buyspage.length&&(o=n.buyspage[0].price),ych.gui.parts.market.buy.fill_buyprice("makesell-offer-text",o)},t.on_ws_sellsupdate=function(e){const n=e.objects[0];if(n.coina+"-"+n.coinb!=ych.gui.current_market)return;t.update_sellvolumes(n.sellspage);let o=0;n.sellspage.length&&(o=n.sellspage[0].price),ych.gui.parts.market.sell.fill_sellprice("makebuy-offer-text",o)}})),$((function(){console.log("Init part market-orders");let e=ych.gui.pages.market,t=function(){};ych.gui.parts.market.orders=t,t.on_show=function(){},$("#buy-orders-table").table_init({cols:[{name:"index",cls:"ytable-cell-c"},{name:"price",cls:"ytable-cell-r"},{name:"amounta",cls:"ytable-cell-r"},{name:"amountb",cls:"ytable-cell-r"},{name:"action",cls:"ytable-cell-c"}]}),$("#sell-orders-table").table_init({cols:[{name:"index",cls:"ytable-cell-c"},{name:"price",cls:"ytable-cell-r"},{name:"amounta",cls:"ytable-cell-r"},{name:"amountb",cls:"ytable-cell-r"},{name:"action",cls:"ytable-cell-c"}]}),t.fill_coina=function(e,t){let n="";n=ych.gui.format_amount(t),$("#"+e).html("<a class='amounta-a' id='"+e+"-a' href='"+window.location.hash+"'>"+n+"</a>"),$("#"+e+"-a").click((function(e){e.preventDefault(),ych.is_logged()&&($("#makebuy-quantity-text").val((Number(t)/1e8).toFixed(8)),$("#makesell-quantity-text").val((Number(t)/1e8).toFixed(8)),ych.gui.parts.market.buy.validate_buy_fields(),ych.gui.parts.market.sell.validate_sell_fields())}))},t.buyorderprice=function(e){let t='<span class="yamount">',n=(e/1e8).toFixed(8),o=n.match(/^0(\.)?0*/g);if(null!=o){t+='<span class="ysemi">'+o[0]+"</span>",t+='<span class="ycol080b">'+n.substr(o[0].length)+"</span>"}else t+='<span class="ycol080b">'+n+"</span>";return t+="</span>",t},t.fill_buyorderprice=function(e,n){let o=t.buyorderprice(n);$("#"+e).html("<a class='buyorderprice-a' id='"+e+"-a' href='"+window.location.hash+"'>"+o+"</a>"),$("#"+e+"-a").click((function(e){e.preventDefault(),ych.is_logged()&&($("#makebuy-price-text").val((n/1e8).toFixed(8)),$("#makesell-price-text").val((n/1e8).toFixed(8)),ych.gui.parts.market.buy.validate_buy_fields(),ych.gui.parts.market.sell.validate_sell_fields())}))},t.update_buyorders=function(n){$("#buy-orders-table").table_clear(),n.forEach((function(n,o){let r=o;e.buys_up_side_down&&(r=ych.gui.pagesize-o-1),$("#buy-orders-table-"+r+"-index").html("B-"+ych.gui.format_paused(n.index)),t.fill_buyorderprice("buy-orders-table-"+r+"-price",n.price),$("#buy-orders-table-"+r+"-amountb").html(ych.gui.format_paused(ych.gui.format_amount(BigInt(n.amountb-n.filledb)))),t.fill_coina("buy-orders-table-"+r+"-amounta",BigInt(n.amounta-n.filleda)),$("#buy-orders-table-"+r+"-action").html("<a id='buy-orders-table-"+r+"-a' href='cancel'>X</a>"),$("#buy-orders-table-"+r+"-a").click((function(e){e.preventDefault(),t.remove_buy_call_with_pass(n.coina,n.coinb,n.index)}))}));const o=n.length;if(o<ych.gui.pagesize)for(let t=o;t<ych.gui.pagesize;t++){let n=t;e.buys_up_side_down&&(n=ych.gui.pagesize-t-1),$("#buy-orders-table-"+n+"-amountb").html('<span class="yamount-B">&#8239;</span>')}},t.sellorderprice=function(e){let t='<span class="yamount">',n=(e/1e8).toFixed(8),o=n.match(/^0(\.)?0*/g);if(null!=o){t+='<span class="ysemi">'+o[0]+"</span>",t+='<span class="ycol800b">'+n.substr(o[0].length)+"</span>"}else t+='<span class="ycol800b">'+n+"</span>";return t+="</span>",t},t.fill_sellorderprice=function(e,n){let o=t.sellorderprice(n);$("#"+e).html("<a class='sellorderprice-a' id='"+e+"-a' href='"+window.location.hash+"'>"+o+"</a>"),$("#"+e+"-a").click((function(e){e.preventDefault(),ych.is_logged()&&($("#makebuy-price-text").val((n/1e8).toFixed(8)),$("#makesell-price-text").val((n/1e8).toFixed(8)),ych.gui.parts.market.buy.validate_buy_fields(),ych.gui.parts.market.sell.validate_sell_fields())}))},t.update_sellorders=function(e){$("#sell-orders-table").table_clear(),e.forEach((function(e,n){$("#sell-orders-table-"+n+"-index").html("S-"+ych.gui.format_paused(e.index)),t.fill_sellorderprice("sell-orders-table-"+n+"-price",e.price),$("#sell-orders-table-"+n+"-amountb").html(ych.gui.format_paused(ych.gui.format_amount(BigInt(e.amountb-e.filledb)))),t.fill_coina("sell-orders-table-"+n+"-amounta",BigInt(e.amounta-e.filleda)),$("#sell-orders-table-"+n+"-action").html("<a id='sell-orders-table-"+n+"-a' href='cancel'>X</a>"),$("#sell-orders-table-"+n+"-a").click((function(n){n.preventDefault(),t.remove_sell_call_with_pass(e.coina,e.coinb,e.index)}))}));const n=e.length;if(n<ych.gui.pagesize)for(let e=n;e<ych.gui.pagesize;e++)$("#sell-orders-table-"+e+"-amountb").html('<span class="yamount-B">&#8239;</span>')},t.remove_buy_call_with_pass=function(n,o,r){ych.gui.call_with_pass1().then((a=>{a.ok?t.remove_buy_call(n,o,r):e.show_error_buy(a.msg)}))},t.remove_buy_call=function(t,n,o){const r=t+n+o.toString()+ych.pubkey1;ych.apicall({uri:"/u/nobuy",digest:r,data:{coina:t,coinb:n,index:o},on_success:function(){e.clear_error_buy()},on_error:function(t){e.show_error_buy(t)}})},t.remove_sell_call_with_pass=function(n,o,r){ych.gui.call_with_pass1().then((a=>{a.ok?t.remove_sell_call(n,o,r):e.show_error_sell(a.msg)}))},t.remove_sell_call=function(t,n,o){const r=t+n+o.toString()+ych.pubkey1;ych.apicall({uri:"/u/nosell",digest:r,data:{coina:t,coinb:n,index:o},on_success:function(){e.clear_error_sell()},on_error:function(t){e.show_error_sell(t)}})},t.on_ws_userbuysupdate=function(e){const n=e.objects[0];n.coina+"-"+n.coinb==ych.gui.current_market&&t.update_buyorders(n.buyspage)},t.on_ws_usersellsupdate=function(e){const n=e.objects[0];n.coina+"-"+n.coinb==ych.gui.current_market&&t.update_sellorders(n.sellspage)}})),$((function(){console.log("Init part market-txouts");let e=function(){};ych.gui.parts.market.txouts=e,e.on_show=function(){},$("#txouts-a-table").table_init({cols:[{name:"txout",cls:"ytable-cell-c"},{name:"free",cls:"ytable-cell-r"},{name:"orders",cls:"ytable-cell-r"},{name:"indebt",cls:"ytable-cell-r"}]}),$("#txouts-b-table").table_init({cols:[{name:"txout",cls:"ytable-cell-c"},{name:"free",cls:"ytable-cell-r"},{name:"orders",cls:"ytable-cell-r"},{name:"indebt",cls:"ytable-cell-r"}]}),$("#txouts-a-table").table_insert_custom_row(0,"debit"),$("#txouts-a-table").table_insert_custom_row(1,"credit"),$("#txouts-b-table").table_insert_custom_row(0,"debit"),$("#txouts-b-table").table_insert_custom_row(1,"credit"),$("#txouts-a-table-debit-txout").text("Debit"),$("#txouts-a-table-credit-txout").text("Credit"),$("#txouts-b-table-debit-txout").text("Debit"),$("#txouts-b-table-credit-txout").text("Credit"),e.update_txouts_a=function(e){if($("#txouts-a-table").table_clear(),null==e)return;let t=0;e.forEach((function(e,n){e.time.locked>0||t++})),$("#txouts-a-table").table_resize(t);let n=0;e.forEach((function(e,t){e.time.locked>0||($("#txouts-a-table-"+n+"-txout").html(ych.gui.format_txout_link2(e.coin,e.txid,e.nout,e.state)),$("#txouts-a-table-"+n+"-free").html(ych.gui.format_amount_or_empty(e.free)),$("#txouts-a-table-"+n+"-orders").html(ych.gui.format_amount_or_empty(e.orders)),$("#txouts-a-table-"+n+"-indebt").html(ych.gui.format_amount_or_empty(-e.filled)),n++)}))},e.update_txouts_b=function(e){if($("#txouts-b-table").table_clear(),null==e)return;let t=0;e.forEach((function(e,n){e.time.locked>0||t++})),$("#txouts-b-table").table_resize(t);let n=0;e.forEach((function(e,t){e.time.locked>0||($("#txouts-b-table-"+n+"-txout").html(ych.gui.format_txout_link2(e.coin,e.txid,e.nout,e.state)),$("#txouts-b-table-"+n+"-free").html(ych.gui.format_amount_or_empty(e.free)),$("#txouts-b-table-"+n+"-orders").html(ych.gui.format_amount_or_empty(e.orders)),$("#txouts-b-table-"+n+"-indebt").html(ych.gui.format_amount_or_empty(-e.filled)),n++)}))},e.update_debit_credit=function(e){if(!(ych.gui.current_market in ych.data.markets))return;const t=ych.data.markets[ych.gui.current_market],n=ych.data.profile.balances[e];if(t.coina==e){0==n.ordersindebit?$("#txouts-a-table-debit-orders").text("-"):$("#txouts-a-table-debit-orders").html("+"+ych.gui.format_amount(n.ordersindebit));let e=n.debit-n.ordersindebit;$("#txouts-a-table-debit-free").html(ych.gui.format_amount_or_empty(e)),$("#txouts-a-table-credit-indebt").html(ych.gui.format_amount_or_empty(n.credit))}if(t.coinb==e){0==n.ordersindebit?$("#txouts-b-table-debit-orders").text("-"):$("#txouts-b-table-debit-orders").html("+"+ych.gui.format_amount(n.ordersindebit));let e=n.debit-n.ordersindebit;$("#txouts-b-table-debit-free").html(ych.gui.format_amount_or_empty(e)),$("#txouts-b-table-credit-indebt").html(ych.gui.format_amount_or_empty(n.credit))}},e.on_ws_txoutsupdate=function(t){if(!(ych.gui.current_market in ych.data.markets))return;const n=t.objects[0],o=t.objects[1];e.update_debit_credit();const r=ych.data.markets[ych.gui.current_market];r.coina==n&&e.update_txouts_a(o),r.coinb==n&&e.update_txouts_b(o)}})),$((function(){console.log("Init part market-trades");ych.gui.pages.market;let e=function(){};ych.gui.parts.market.trades=e,e.on_init=function(){e.saved={}},e.on_show=function(){},e.save=function(t){""!=$("#makebuy-price-text").val()&&""!=$("#makesell-price-text").val()&&(e.saved[t]={},e.saved[t].on=!0,e.saved[t].buyprice=$("#makebuy-price-text").val(),e.saved[t].buyquantity=$("#makebuy-quantity-text").val(),e.saved[t].buytotal=$("#makebuy-total-text").text(),e.saved[t].buyfee=$("#makebuy-fee-text").text(),e.saved[t].sellprice=$("#makesell-price-text").val(),e.saved[t].sellquantity=$("#makesell-quantity-text").val(),e.saved[t].selltotal=$("#makesell-total-text").text(),e.saved[t].sellfee=$("#makesell-fee-text").text())},e.restore=function(t){if("saved"in e||(e.saved={}),t in e.saved){let n=e.saved[t];$("#makebuy-price-text").val(n.buyprice),$("#makebuy-quantity-text").val(n.buyquantity),$("#makebuy-total-text").text(n.buytotal),$("#makebuy-fee-text").text(n.buyfee),$("#makesell-price-text").val(n.sellprice),$("#makesell-quantity-text").val(n.sellquantity),$("#makesell-total-text").text(n.selltotal),$("#makesell-fee-text").text(n.sellfee)}else{if(t in ych.data.markets){const e=ych.data.markets[t],n=e.coina,o=e.coinb,r=ych.data.coininfos[n],a=ych.data.coininfos[o],i=r.ext.priceext,s=a.ext.priceext;if(s>0){const e=i/s;$("#makebuy-price-text").val(e.toFixed(8)),$("#makesell-price-text").val(e.toFixed(8))}else $("#makebuy-price-text").val("0.00000001"),$("#makesell-price-text").val("0.00000001")}$("#makebuy-quantity-text").val("0"),$("#makebuy-total-text").text("0.00000000"),$("#makebuy-fee-text").text("0.00000000"),$("#makesell-quantity-text").val("0"),$("#makesell-total-text").text("0.00000000"),$("#makesell-fee-text").text("0.00000000")}}})),$((function(){console.log("Init part market-buy");let e=ych.gui.pages.market,t=function(){};ych.gui.parts.market.buy=t,$("#makebuy-button").prop("disabled",!0),t.on_init=function(){$("#makebuy-span-dotslide").dot_slide("#buy-value","0.00000000",(function(e){if(!ych.is_logged())return;const n=parseFloat($("#makebuy-price-text").val());if(n<1e-8)return;const o=ych.data.markets[ych.gui.current_market].coina,r=ych.data.markets[ych.gui.current_market].coinb,a=ych.buy_fee(o,r),i=ych.data.profile.balances[r].free,s=Math.floor(Number(i)/(1+a));let c=Math.floor(s/n*e/100);100==e&&(c=Math.floor(s/n)),$("#makebuy-quantity-text").val((c/1e8).toFixed(8)),t.validate_buy_fields()}))},t.on_show=function(){},t.buyprice=function(e){let t='<span class="yamount">',n=(Number(e)/1e8).toFixed(8),o=n.match(/^0(\.)?0*/g);if(null!=o){t+='<span class="ycol888">'+o[0]+"</span>",t+='<span class="ycol080b">'+n.substr(o[0].length)+"</span>"}else t+='<span class="ycol080b">'+n+"</span>";return t+="</span>",t},t.fill_buyprice=function(e,n,o){let r="";if(null!=o){const e=ych.data.markets[ych.gui.current_market].coina,t=ych.data.markets[ych.gui.current_market].coinb;let o=(Number(n)/1e8).toFixed(8),a=0;if(e in ych.data.coininfos&&t in ych.data.coininfos){const n=ych.data.coininfos[e].ext.priceext,i=ych.data.coininfos[t].ext.priceext;0!=n&&0!=i&&(a=n/i,a<o&&(r='<span class="ytb">_</span>'))}}let a=r+t.buyprice(n);$("#"+e).html("<a class='buyprice-a' id='"+e+"-a' href='"+window.location.hash+"'>"+a+"</a>"),$("#"+e+"-a").click((function(e){e.preventDefault(),ych.is_logged()&&($("#makebuy-price-text").val((Number(n)/1e8).toFixed(8)),$("#makesell-price-text").val((Number(n)/1e8).toFixed(8)),t.validate_buy_fields(),ych.gui.parts.market.sell.validate_sell_fields())}))},t.validate_buy_fields=function(){if(isNaN($("#makebuy-price-text").val())||isNaN($("#makebuy-quantity-text").val()))return $("#makebuy-total-text").text("-"),void $("#makebuy-button").prop("disabled",!0);const t=ych.data.markets[ych.gui.current_market].coina,n=ych.data.markets[ych.gui.current_market].coinb;let o=0;if(n in ych.data.coininfos){o=ych.data.coininfos[n].ext.priceext}const r=ych.buy_fee(t,n),a=ych.data.coininfos[n].fee.minorder,i=Math.floor(.5+1e8*parseFloat($("#makebuy-quantity-text").val())),s=Math.floor(.5+parseFloat($("#makebuy-quantity-text").val())*parseFloat($("#makebuy-price-text").val())*1e8),c=Math.floor(.5+s*r),l=s+c;if($("#makebuy-fee-text").html('<span class="ysemi">≈$'+(c/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(c))),$("#makebuy-total-text").html('<span class="ysemi">≈$'+(l/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(l))),$("#makebuy-get-text").html(ych.gui.format_amount(BigInt(i))),s+c<a)return $("#makebuy-button").prop("disabled",!0),void(s>0&&e.show_error_buy("total to be more "+Number(a)+"sat"));if(s+c>ych.data.profile.balances[n].free)return $("#makebuy-button").prop("disabled",!0),void e.show_error_buy("total is over available coins");$("#makebuy-button").prop("disabled",!1),e.clear_error_buy()},$("#makebuy-price-text").on("input",t.validate_buy_fields),$("#makebuy-quantity-text").on("input",t.validate_buy_fields),$("#makebuy-button").click((function(n){n.preventDefault(),ych.gui.call_with_pass1().then((n=>{n.ok?t.buy_call_chk():e.show_error_buy(n.msg)}))})),t.buy_call_chk=function(){const e=ych.data.markets[ych.gui.current_market].coina,n=ych.data.markets[ych.gui.current_market].coinb,o=ych.gui.get_input_amount("makebuy-price-text"),r=ych.gui.get_input_amount("makebuy-quantity-text"),a=r*o/BigInt(1e8),i=ych.data.coininfos[e],s=ych.data.coininfos[n],c=i.ext.priceext,l=s.ext.priceext;if(0==l)return void t.buy_call();const u=i.ext.nameext,d=i.ext.priceexttime,h=c/l,p=BigInt(Math.floor(.5+1e8*h)),f=r*p/BigInt(1e8),m=(Number(a-f)/Number(f)*100).toFixed(0);if(m<=0)return void t.buy_call();let g=m+"% more than "+u+" at "+ych.gui.format_date(d);if(m>=50){g=(Number(a)/Number(f)).toFixed(1)+" X more than "+u+" at "+ych.gui.format_date(d)}let y={text:"WARNING: you are buying high!",warn:g,coina:e,coinb:n,price:o,amounta:r,amountb:a,ext_fp:m,ext_text:"Over:",ext_name:u,ext_time:d,ext_price:p,ext_amounta:r,ext_amountb:f,ext_over:a-f};ych.gui.forms["order-chk"].exec(y).then((e=>{console.log("res:",e),e.ok&&t.buy_call()}))},t.buy_call=function(){const t=ych.data.markets[ych.gui.current_market].coina,n=ych.data.markets[ych.gui.current_market].coinb;if(""==ych.address[n])return void e.show_error_buy("not available the change address");const o=ych.data.coininfos[n],r=ych.buy_fee(t,n),a=ych.gui.get_input_amount("makebuy-price-text"),i=ych.gui.get_input_amount("makebuy-quantity-text"),s=i*a/BigInt(1e8),c=BigInt(Math.floor(.5+Number(s)*r)),l=s+c,u=ych.data.profile.balances[n];let d=0n,h=l;if(u.debit>0){let t=u.debit-u.ordersindebit;if(t<0)return void e.show_error_buy("error debt usage is negative");t>=l?(d=l,h=0):t>0&&(d=t,h=l-t)}let p=[];if(h>0){let t=JSON.parse(JSON.stringify(ych.data.profile.txouts[n],((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),jsonBNparse);ych.init_coinjs(n);const r=t.filter((e=>350==e.state||400==e.state||800==e.state));if(t=t.filter((e=>400==e.state)),t.sort((function(e,t){return Number(e.free-t.free)})),console.log("input txouts:",t),"txout_t1"==o.type){const[n,o,r,a]=ych.txout_select_inps(t,h);if(o<0||o<h)return void e.show_error_buy("not enough available coins in txouts to trade "+h);console.log("selected txouts:",n,o,r,a);for(let t=0;t<n.length;t++){const o=n[t],[r,a]=ych.sign_txout(o);if(null!=a)return void e.show_error(a);p.push(r)}}if("evm_t1"==o.type||"erc20_t1"==o.type){const e=o.cfg.unit,t=h;for(let o=0;o<r.length;o++){const a=r[o],i="0x"+a.txid,s=a.orders+a.filled+t,c=s*e,l=[ych.evm_sign1(ych.address[n],i,c,ych.evm_zeroaddr,a.nout+1)];let u={};u.txid=a.txid,u.nout=a.nout,u.amnt=a.amount,u.fill=a.filled,u.usea=t,u.sigf="",u.sigv=s,u.sigs=l,p.push(u)}}}let f="";p.forEach((function(e,t){f+=e.txid+":"+e.nout,f+=e.fill.toString(),f+=e.usea.toString()}));const m=t+n+a.toString()+i.toString()+s.toString()+"0"+c.toString()+d.toString()+f+ych.pubkey1;ych.apicall({uri:"/u/buy",digest:m,data:{coina:t,coinb:n,price:a,amounta:i,amountb:s,feea:0n,feeb:c,usedebit:d,usetxouts:p},on_success:function(){e.clear_error_buy()},on_error:function(t){e.show_error_buy(t)}})}})),$((function(){console.log("Init part market-sell");let e=ych.gui.pages.market,t=function(){};ych.gui.parts.market.sell=t,t.on_init=function(){$("#makesell-span-dotslide").dot_slide("#sell-value","0.00000000",(function(e){if(!ych.is_logged())return;if(parseFloat($("#makesell-price-text").val())<1e-8)return;const n=ych.data.markets[ych.gui.current_market].coina,o=ych.data.markets[ych.gui.current_market].coinb,r=ych.sell_fee(n,o),a=ych.data.profile.balances[n].free;let i=Math.floor(Number(a)/(1+r)*e/100);100==e&&(i=Math.floor(Number(a)/(1+r))),$("#makesell-quantity-text").val((i/1e8).toFixed(8)),t.validate_sell_fields()}))},t.on_show=function(){},$("#makesell-button").prop("disabled",!0),t.sellprice=function(e){let t='<span class="yamount">',n=(Number(e)/1e8).toFixed(8),o=n.match(/^0(\.)?0*/g);if(null!=o){t+='<span class="ycol888">'+o[0]+"</span>",t+='<span class="ycol800b">'+n.substr(o[0].length)+"</span>"}else t+='<span class="ycol800b">'+n+"</span>";return t+="</span>",t},t.fill_sellprice=function(e,n,o){let r="";if(null!=o){const e=ych.data.markets[ych.gui.current_market].coina,t=ych.data.markets[ych.gui.current_market].coinb;let o=(Number(n)/1e8).toFixed(8),a=0;if(e in ych.data.coininfos&&t in ych.data.coininfos){const n=ych.data.coininfos[e].ext.priceext,i=ych.data.coininfos[t].ext.priceext;0!=n&&0!=i&&(a=n/i,a>o&&(r='<span class="ytb">¯</span>'))}}let a=r+t.sellprice(n);$("#"+e).html("<a class='sellprice-a' id='"+e+"-a' href='"+window.location.hash+"'>"+a+"</a>"),$("#"+e+"-a").click((function(e){e.preventDefault(),ych.is_logged()&&($("#makebuy-price-text").val((Number(n)/1e8).toFixed(8)),$("#makesell-price-text").val((Number(n)/1e8).toFixed(8)),ych.gui.parts.market.buy.validate_buy_fields(),t.validate_sell_fields())}))},t.validate_sell_fields=function(){if(isNaN($("#makesell-price-text").val())||isNaN($("#makesell-quantity-text").val()))return $("#makesell-total-text").text("-"),void $("#makesell-button").prop("disabled",!0);const t=ych.data.markets[ych.gui.current_market].coina,n=ych.data.markets[ych.gui.current_market].coinb;let o=0;if(t in ych.data.coininfos){o=ych.data.coininfos[t].ext.priceext}const r=ych.sell_fee(t,n),a=ych.data.coininfos[t].fee.minorder,i=Math.floor(.5+1e8*parseFloat($("#makesell-quantity-text").val())),s=Math.floor(.5+parseFloat($("#makesell-quantity-text").val())*parseFloat($("#makesell-price-text").val())*1e8),c=Math.floor(.5+i*r),l=i+c;if($("#makesell-fee-text").html('<span class="ysemi">≈$'+(c/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(c))),$("#makesell-total-text").html('<span class="ysemi">≈$'+(l/1e8*o).toFixed(2)+"</span> "+ych.gui.format_amount(BigInt(l))),$("#makesell-get-text").html('<span class="ysemi ysmall yfstd">(no spread)</span>&nbsp;'+ych.gui.format_amount(BigInt(s))),i+c<a)return $("#makesell-button").prop("disabled",!0),void(i>0&&e.show_error_sell("total to be more "+Number(a)+"sat"));if(i+c>ych.data.profile.balances[t].free)return $("#makesell-button").prop("disabled",!0),void e.show_error_sell("quantity and fee over available coins");$("#makesell-button").prop("disabled",!1),e.clear_error_sell()},$("#makesell-price-text").on("input",t.validate_sell_fields),$("#makesell-quantity-text").on("input",t.validate_sell_fields),$("#makesell-button").click((function(n){n.preventDefault(),ych.gui.call_with_pass1().then((n=>{n.ok?t.sell_call_chk():e.show_error_sell(n.msg)}))})),t.sell_call_chk=function(){const e=ych.data.markets[ych.gui.current_market].coina,n=ych.data.markets[ych.gui.current_market].coinb,o=ych.gui.get_input_amount("makesell-price-text"),r=ych.gui.get_input_amount("makesell-quantity-text"),a=r*o/BigInt(1e8),i=ych.data.coininfos[e],s=ych.data.coininfos[n],c=i.ext.priceext,l=s.ext.priceext;if(0==l)return void t.sell_call();const u=i.ext.nameext,d=i.ext.priceexttime,h=c/l,p=BigInt(Math.floor(.5+1e8*h)),f=r*p/BigInt(1e8),m=(Number(f-a)/Number(f)*100).toFixed(0);if(m<=0)return void t.sell_call();let g=m+"% less than "+u+" at "+ych.gui.format_date(d);if(m>=50){g=(Number(f)/Number(a)).toFixed(1)+" X less than "+u+" at "+ych.gui.format_date(d)}let y={text:"WARNING: you are selling low!",warn:g,coina:e,coinb:n,price:o,amounta:r,amountb:a,ext_fp:m,ext_text:"Less:",ext_name:u,ext_time:d,ext_price:p,ext_amounta:r,ext_amountb:f,ext_over:f-a};ych.gui.forms["order-chk"].exec(y).then((e=>{console.log("res:",e),e.ok&&t.sell_call()}))},t.sell_call=function(){const t=ych.data.markets[ych.gui.current_market].coina,n=ych.data.markets[ych.gui.current_market].coinb;if(""==ych.address[t])return void e.show_error_sell("not available the change address");const o=ych.data.coininfos[t],r=ych.sell_fee(t,n),a=ych.gui.get_input_amount("makesell-price-text"),i=ych.gui.get_input_amount("makesell-quantity-text"),s=i*a/BigInt(1e8),c=BigInt(Math.floor(.5+Number(i)*r)),l=i+c,u=ych.data.profile.balances[t];let d=0n,h=l;if(u.debit>0){let t=u.debit-u.ordersindebit;if(t<0)return void e.show_error_sell("error debt usage is negative");t>=l?(d=l,h=0n):t>0&&(d=t,h=l-t)}let p=[];if(h>0){let n=JSON.parse(JSON.stringify(ych.data.profile.txouts[t],((e,t)=>"bigint"==typeof t?t.toString()+"n":t)),jsonBNparse);ych.init_coinjs(t);const r=n.filter((e=>350==e.state||400==e.state||800==e.state));if(n=n.filter((e=>400==e.state)),n.sort((function(e,t){return Number(e.free-t.free)})),console.log("input txouts:",n),"txout_t1"==o.type){const[t,o,r,a]=ych.txout_select_inps(n,h);if(o<0||o<h)return void e.show_error_sell("not enough available coins in txouts to trade "+h);console.log("selected txouts:",t,o,r,a);for(let n=0;n<t.length;n++){const o=t[n],[r,a]=ych.sign_txout(o);if(null!=a)return void e.show_error_sell(a);p.push(r)}}if("evm_t1"==o.type||"erc20_t1"==o.type){const e=o.cfg.unit,n=h;for(let o=0;o<r.length;o++){const a=r[o],i="0x"+a.txid,s=a.orders+a.filled+n,c=s*e,l=[ych.evm_sign1(ych.address[t],i,c,ych.evm_zeroaddr,a.nout+1)];let u={};u.txid=a.txid,u.nout=a.nout,u.amnt=a.amount,u.fill=a.filled,u.usea=n,u.sigf="",u.sigv=s,u.sigs=l,p.push(u)}}}let f="";p.forEach((function(e,t){f+=e.txid+":"+e.nout,f+=e.fill.toString(),f+=e.usea.toString()}));const m=t+n+a.toString()+i.toString()+s.toString()+c.toString()+"0"+d.toString()+f+ych.pubkey1;ych.apicall({uri:"/u/sell",digest:m,data:{coina:t,coinb:n,price:a,amounta:i,amountb:s,feea:c,feeb:0n,usedebit:d,usetxouts:p},on_success:function(){e.clear_error_sell()},on_error:function(t){e.show_error_sell(t)}})}})),$((function(){console.log("Init darklight");let e=function(){};ych.gui.is_light=!1,ych.gui.is_dark=!0,ych.gui.is_light?($("#topbar-button-light").hide(),$("#topbar-button-dark").show(),"market"in ych.gui.parts&&"chart"in ych.gui.parts.market&&ych.gui.parts.market.chart.chart_inited&&(ych.gui.parts.market.chart.candle_layer.wickColor="black",ych.gui.parts.market.chart.candle_layer._config.wickColor="black",ych.gui.parts.market.chart.update())):($("#topbar-button-light").show(),$("#topbar-button-dark").hide(),"market"in ych.gui.parts&&"chart"in ych.gui.parts.market&&ych.gui.parts.market.chart.chart_inited&&(ych.gui.parts.market.chart.candle_layer.wickColor="white",ych.gui.parts.market.chart.candle_layer._config.wickColor="white",ych.gui.parts.market.chart.update())),e.dark_onclick=function(e){e.preventDefault(),document.getElementById("page-main-check-dark").checked=!0,document.getElementById("page-main-check-light").checked=!1,ych.gui.is_light=!1,ych.gui.is_dark=!0,$("#topbar-button-light").show(),$("#topbar-button-dark").hide(),"market"in ych.gui.parts&&"chart"in ych.gui.parts.market&&ych.gui.parts.market.chart.chart_inited&&(ych.gui.parts.market.chart.candle_layer.wickColor="white",ych.gui.parts.market.chart.candle_layer._config.wickColor="white",ych.gui.parts.market.chart.update())},e.white_onclick=function(e){e.preventDefault(),document.getElementById("page-main-check-dark").checked=!1,document.getElementById("page-main-check-light").checked=!0,ych.gui.is_light=!0,ych.gui.is_dark=!1,$("#topbar-button-light").hide(),$("#topbar-button-dark").show(),"market"in ych.gui.parts&&"chart"in ych.gui.parts.market&&ych.gui.parts.market.chart.chart_inited&&(ych.gui.parts.market.chart.candle_layer.wickColor="black",ych.gui.parts.market.chart.candle_layer._config.wickColor="black",ych.gui.parts.market.chart.update())},$("#topbar-button-dark").click(e.dark_onclick),$("#topbar-button-light").click(e.white_onclick)})),$((function(){console.log("Init navigation");$("#topbar-button-list").click((function(e){e.preventDefault(),window.ych_navigate("#")})),window.onhashchange=function(){let e=window.location.hash;window.ych_onnavigate(e)},window.ych_navigate=function(e){window.ych_onnavigate(e)&&history.pushState({},e,e)},window.ych_onnavigate=function(e){console.log("navigate:",e),""!=e&&"#"!=e||(e="#main");let t=!1,n="",o="";for(let r in ych.gui.pages){let a="",i=!1;e=="#"+r?i=!0:e.startsWith("#"+r+"-")&&(i=!0,a=e.substring(("#"+r+"-").length)),i?(o=r,n=a,t=!0):$("#page-"+r).hide()}if(t){let e=n.split("-");if("confirm1"==o&&(e=[n]),o in ych.gui.parts){page_parts=ych.gui.parts[o];for(let e in page_parts){let t=page_parts[e];if("on_init"in t&&1!=t.inited){let n={};const r="part-"+o+"-"+e;r in ych.gui.guictx&&(n=ych.gui.guictx[r]),t.on_init(n),t.inited=!0}}}let t=ych.gui.pages[o];if("on_init"in t&&1!=t.inited){let e={};const n="page-"+o;n in ych.gui.guictx&&(e=ych.gui.guictx[n]),t.on_init(e),t.inited=!0}if($("#page-"+o).show(),o in ych.gui.parts){page_parts=ych.gui.parts[o];for(let t in page_parts){let n=page_parts[t];"on_show"in n&&n.on_show(...e)}}return"on_show"in t&&t.on_show(...e),!0}return $("#page-unknown").show(),!1},ych.gui.pages.unknown=function(){},$("#page-unknown-button-back").click((function(e){e.preventDefault(),window.ych_navigate("#")}))})),$((function(){console.log("Start1"),window.onconnecting();{let e="ws:";"https:"==window.location.protocol&&(e="wss:"),window.ych_ws=new ReconnectingWebSocket(e+"//"+window.location.hostname+":"+window.location.port+"/ws")}window.ych_ws_init=function(){if(window.ych_ws.readyState==WebSocket.OPEN){var e={type:"init",jwt:ych.get_cookie("jwt")};window.ych_ws.send(JSON.stringify(e)),clearTimeout(ych.timer_reauth),ych.timer_reauth=setTimeout(window.ych_reauth,3e5)}},window.ych_ws.onopen=function(e){ych.gui.connecting2=!1,window.onconnecting(),window.ych_ws_init()},window.ych_ws.onclose=function(e){ych.gui.connecting2=!0,window.onconnecting()},window.ych_ws.onmessage=function(e){if("message"==e.type){let t={};e.data.split("\n").forEach((function(e,n){try{t=JSON.parse(e,jsonBNparse)}catch(e){return}if(!("type"in t))return void console.log("Received unknown ws event, message: ",t);t.type in ych.ws_calls?ych.ws_calls[t.type](t):console.log("Received unknown ws event, message: ",t);let o="on_ws_"+t.type;for(let e in ych.gui.pages){let n=ych.gui.pages[e];o in n&&n[o](t)}for(let e in ych.gui.parts){let n=ych.gui.parts[e];for(let e in n){let r=n[e];o in r&&r[o](t)}}}))}else console.log("Received ws event, not message: ",e)},window.ych_gui_on_init=function(e){let t="",n="",o=ych.get_cookie("jwt").split(".");if(3==o.length){let e=o[1].replace("-","+").replace("_","/"),r=JSON.parse(window.atob(e));"uid"in r&&(t=r.uid,n=r.pub)}ych.data=e,ych.nnum=e.nnum,ych.gui.parts.wallet.balances.init_table();for(let e in ych.data.coininfos)ych.gui.update_coininfo(ych.data.coininfos[e]);ych.data_update("coininfos",e.coininfos);for(let t in ych.gui.pages){let n=ych.gui.pages[t];if("on_data_init"in n&&n.on_data_init(e),t in ych.gui.parts)for(let n in ych.gui.parts[t]){let o=ych.gui.parts[t][n];"on_data_init"in o&&o.on_data_init(e)}}null!=e.profile?(ych.user=e.profile.user,window.ych_uidx=e.profile.uidx,ych.pubkey1=e.profile.pubk1,ych.pubkey2=e.profile.pubk2,ych.pubkey3=e.profile.pubk3,window.ych_gui_on_login(t,e.profile)):window.ych_gui_on_logout(),window.ych_ws_init()}})),$((function(){console.log("Start2"),window.ych_data_init=function(){$.ajax({type:"GET",url:"/u/init",data:JSON.stringify({}),contentType:"application/json",dataType:"text",success:function(e){const t=JSON.parse(e,jsonBNparse);if(t.ok){console.log(t),ych.gui.connecting1=!1,window.onconnecting(),window.ych_gui_on_init(t);let e=window.location.hash;window.ych_onnavigate(e)}else console.log(t),console.log("logout"),ych.gui.connecting1=!0,window.onconnecting(),$("#connecting1").text(t)},error:function(e,t,n){console.log(e,t,n),console.log("logout"),ych.gui.connecting1=!0,window.onconnecting(),$("#connecting1").text("Status: "+t+", error: "+n)}})},window.ych_data_init(),window.ych_reauth=function(){let e=ych.get_cookie("jwt").split("."),t="";if(3==e.length){let n=e[1].replace("-","+").replace("_","/"),o=JSON.parse(window.atob(n));"uid"in o&&(t=o.uid)}""!=t&&$.ajax({type:"GET",url:"/u/reauth",data:JSON.stringify({}),dataType:"json",success:function(e){e.ok?(document.cookie="jwt="+e.access+";SameSite=Strict",window.ych_ws_init()):window.ych_gui_on_logout()},error:function(e,t,n){window.ych_gui_on_logout()}})}}));